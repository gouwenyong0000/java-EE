# å‰è¨€

**å¯†ç å­¦ï¼š** ä¸»è¦æ˜¯ç ”ç©¶ç¼–åˆ¶å¯†ç å’Œç ´è¯‘å¯†ç çš„å­¦ç§‘ã€‚

**å¯†ç å­¦çš„ä¸»è¦ç›®çš„ï¼š** ç”¨ä¸€å¥å¤§ç™½è¯æ¥è¯´ï¼Œå°±æ˜¯ç ”ç©¶ ==å¦‚ä½•éšè—ä¿¡æ¯å¹¶ä¸”æŠŠä¿¡æ¯ä¼ é€’å‡ºå»çš„ä¸€ä¸ªå­¦ç§‘==ã€‚



**å¤å…¸å¯†ç å­¦**

- **æ ¸å¿ƒåŸç†**ï¼šæ›¿æ¢æ³•ã€ç§»ä½æ³•
- **å‡¯æ’’åŠ å¯†**ï¼šè¿™æ˜¯ä¸€ç§å…·ä½“çš„åŠ å¯†æ–¹æ³•ï¼Œå±äºç§»ä½æ³•çš„ä¸€ç§ã€‚
- **é¢‘åº¦åˆ†ææ³•è¿›è¡Œç ´è¯‘å¯†ç **ï¼šåœ¨ä¸çŸ¥é“å¯†ç è§„åˆ™çš„å‰æä¸‹ï¼Œé€šè¿‡åˆ†æå­—æ¯å‡ºç°çš„é¢‘ç‡æ¥å°è¯•ç ´è§£å¯†ç ã€‚
- **å¦‚ä½•è®¾ç½®å¯†ç æ‰æ¯”è¾ƒå®‰å…¨**ï¼šè™½ç„¶è¿™é‡Œæ²¡æœ‰è¯¦ç»†è¯´æ˜ï¼Œä½†é€šå¸¸åŒ…æ‹¬ä½¿ç”¨å¤æ‚æ€§é«˜çš„å¯†ç ï¼Œé¿å…ä½¿ç”¨å¸¸è§çš„å•è¯æˆ–ä¸ªäººä¿¡æ¯ç­‰ã€‚



**è¿‘ä»£å¯†ç å­¦ï¼š**

- **æ ¸å¿ƒåŸç†**ï¼šåŒæ ·åŸºäºæ›¿æ¢æ³•å’Œç§»ä½æ³•ï¼Œä½†å¯èƒ½è¿˜åŒ…æ‹¬æ›´å¤æ‚çš„æ•°å­¦ç†è®ºå’Œç®—æ³•ã€‚



**ç°ä»£å¯†ç å­¦**

**â‘  æ•£åˆ—å‡½æ•°**

- **MD5, SHA-1, SHA-256, SHA-512**ï¼šè¿™äº›æ˜¯å¸¸è§çš„æ•£åˆ—å‡½æ•°ï¼Œç”¨äºå°†ä»»æ„é•¿åº¦çš„æ•°æ®è½¬æ¢ä¸ºå›ºå®šé•¿åº¦çš„å“ˆå¸Œå€¼ã€‚å®ƒä»¬åœ¨æ•°æ®å®Œæ•´æ€§éªŒè¯ã€å¯†ç å­˜å‚¨ç­‰æ–¹é¢æœ‰å¹¿æ³›åº”ç”¨ã€‚

**â‘¡ å¯¹ç§°åŠ å¯†**

- **DES åŠ å¯†å’Œè§£å¯†, AES åŠ å¯†å’Œè§£å¯†**ï¼šå¯¹ç§°åŠ å¯†ä½¿ç”¨ç›¸åŒçš„å¯†é’¥è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ã€‚DESï¼ˆæ•°æ®åŠ å¯†æ ‡å‡†ï¼‰æ˜¯ä¸€ç§è¾ƒæ—§çš„ç®—æ³•ï¼Œè€Œ AESï¼ˆé«˜çº§åŠ å¯†æ ‡å‡†ï¼‰æ˜¯ç›®å‰å¹¿æ³›ä½¿ç”¨çš„æ›´å®‰å…¨çš„æ›¿ä»£æ–¹æ¡ˆã€‚
- **å¯¹ç§°åŠ å¯†çš„æ ¸å¿ƒåŸç†**ï¼šåŒ…æ‹¬æµåŠ å¯†å’Œå—åŠ å¯†ä¸¤ç§æ–¹å¼ã€‚
- **toString() å’Œ new String() æ ¸å¿ƒåŸç†å’ŒåŒºåˆ«**ï¼šè¿™å¯èƒ½æ˜¯åœ¨ç¼–ç¨‹ä¸­å¤„ç†å­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œä¸å¯†ç å­¦ç›´æ¥å…³ç³»ä¸å¤§ï¼Œä½†å¯èƒ½æ¶‰åŠåˆ°åŠ å¯†åçš„æ•°æ®è¡¨ç¤ºå½¢å¼ã€‚
- **åŠ å¯†æ¨¡å¼**ï¼šECBï¼ˆç”µå­å¯†ç æœ¬æ¨¡å¼ï¼‰ã€CBCï¼ˆå¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼ï¼‰ç­‰ï¼Œä¸åŒçš„æ¨¡å¼ä¼šå½±å“åŠ å¯†çš„å®‰å…¨æ€§å’Œæ•ˆç‡ã€‚
- **å¡«å……æ¨¡å¼**ï¼šNoPaddingï¼ˆæ— å¡«å……ï¼‰ã€PKCS5paddingï¼ˆä¸€ç§å¸¸ç”¨çš„å¡«å……æ–¹å¼ï¼‰ï¼Œç”¨äºç¡®ä¿æ•°æ®é•¿åº¦ç¬¦åˆåŠ å¯†ç®—æ³•çš„è¦æ±‚ã€‚

**â‘¢ éå¯¹ç§°åŠ å¯†**

- **éå¯¹ç§°åŠ å¯†çš„ç‰¹ç‚¹**ï¼šä½¿ç”¨ä¸€å¯¹å¯†é’¥ï¼ˆå…¬é’¥å’Œç§é’¥ï¼‰ï¼Œå…¬é’¥ç”¨äºåŠ å¯†ï¼Œç§é’¥ç”¨äºè§£å¯†ï¼Œæˆ–åä¹‹äº¦ç„¶ï¼Œæé«˜äº†å®‰å…¨æ€§ã€‚
- **RSA ç®—æ³•å’Œ ECC ç®—æ³•**ï¼šRSAï¼ˆRivest-Shamir-Adlemanï¼‰å’Œ ECCï¼ˆæ¤­åœ†æ›²çº¿å¯†ç å­¦ï¼‰æ˜¯éå¯¹ç§°åŠ å¯†çš„ä¸¤ç§ä¸»è¦å®ç°æ–¹å¼ï¼Œå„æœ‰ä¼˜ç¼ºç‚¹ã€‚
- **æ•°å­—æ‘˜è¦**ï¼šbase64 æ ¸å¿ƒåŠ å¯†åŸåˆ™ï¼Œå’Œ base64 åŸç†ï¼Œè¿™é‡Œå¯èƒ½æœ‰äº›æ··æ·†ï¼Œbase64 æ˜¯ä¸€ç§ç¼–ç æ–¹å¼ï¼Œä¸æ˜¯åŠ å¯†ç®—æ³•ï¼Œä½†å®ƒå¸¸ç”¨äºåŠ å¯†æ•°æ®çš„ä¼ è¾“ã€‚
- **æ•°å­—ç­¾åå’Œæ•°å­—è¯ä¹¦**ï¼šç”¨äºéªŒè¯æ•°æ®çš„å®Œæ•´æ€§å’Œæ¥æºçš„çœŸå®æ€§ï¼Œæ˜¯ç½‘ç»œå®‰å…¨çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚

**keytool å·¥å…·çš„ä½¿ç”¨**

- è¿™æ˜¯ä¸€ä¸ª Java æä¾›çš„å·¥å…·ï¼Œç”¨äºç®¡ç†å¯†é’¥å’Œè¯ä¹¦ï¼Œå¯¹äºå®æ–½åŠ å¯†å’Œå®‰å…¨é€šä¿¡éå¸¸é‡è¦ã€‚



# ç¬¬ä¸€ç«  å¯†ç å­¦

## 1.1 å¯†ç å­¦åŸºæœ¬æ¦‚å¿µ

å¯†ç åœ¨æˆ‘ä»¬çš„ç”Ÿæ´»ä¸­æœ‰ç€é‡è¦çš„ä½œç”¨ï¼Œé‚£ä¹ˆå¯†ç ç©¶ç«Ÿæ¥è‡ªä½•æ–¹ï¼Œä¸ºä½•ä¼šäº§ç”Ÿå‘¢ï¼Ÿ

å¯†ç å­¦æ˜¯ç½‘ç»œå®‰å…¨ã€ä¿¡æ¯å®‰å…¨ã€åŒºå—é“¾ç­‰äº§å“çš„åŸºç¡€ï¼Œå¸¸è§çš„éå¯¹ç§°åŠ å¯†ã€å¯¹ç§°åŠ å¯†ã€æ•£åˆ—å‡½æ•°ç­‰ï¼Œéƒ½å±äºå¯†ç å­¦èŒƒç•´ã€‚

å¯†ç å­¦æœ‰æ•°åƒå¹´çš„å†å²ï¼Œä»æœ€å¼€å§‹çš„æ›¿æ¢æ³•åˆ°å¦‚ä»Šçš„éå¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œç»å†äº†å¤å…¸å¯†ç å­¦ï¼Œè¿‘ä»£å¯†ç å­¦å’Œç°ä»£å¯†ç å­¦ä¸‰ä¸ªé˜¶æ®µã€‚å¯†ç å­¦ä¸ä»…ä»…æ˜¯æ•°å­¦å®¶ä»¬çš„æ™ºæ…§ï¼Œæ›´æ˜¯å¦‚ä»Šç½‘ç»œç©ºé—´å®‰å…¨çš„é‡è¦åŸºç¡€ã€‚

### 1.1.1 å¤å…¸å¯†ç å­¦

åœ¨å¤ä»£çš„æˆ˜äº‰ä¸­ï¼Œå¤šè§ä½¿ç”¨éšè—ä¿¡æ¯çš„æ–¹å¼ä¿æŠ¤é‡è¦çš„é€šä¿¡èµ„æ–™ã€‚æ¯”å¦‚å…ˆæŠŠéœ€è¦ä¿æŠ¤çš„ä¿¡æ¯ç”¨åŒ–å­¦è¯æ°´å†™åˆ°çº¸ä¸Šï¼Œè¯æ°´å¹²åï¼Œçº¸ä¸Šçœ‹ä¸å‡ºä»»ä½•çš„ä¿¡æ¯ï¼Œéœ€è¦ä½¿ç”¨å¦å¤–çš„åŒ–å­¦è¯æ°´æ¶‚æŠ¹åæ‰å¯ä»¥é˜…è¯»çº¸ä¸Šçš„ä¿¡æ¯ã€‚

`https://www.iqiyi.com/v_19rt6ab1hg.html`Â 1 åˆ† 05 ç§’

è¿™äº›æ–¹æ³•éƒ½æ˜¯åœ¨ä¿æŠ¤é‡è¦çš„ä¿¡æ¯ä¸è¢«ä»–äººè·å–ï¼Œä½†è—ä¿¡æ¯çš„æ–¹å¼æ¯”è¾ƒå®¹æ˜“è¢«ä»–äººè¯†ç ´ï¼Œä¾‹å¦‚å¢åŠ å“¨å…µçš„æ’æŸ¥åŠ›åº¦ï¼Œå°±ä¼šå‘ç°å…¶ä¸­çš„çŒ«è…»ï¼Œå› è€Œéšåå‘å±•å‡ºäº†è¾ƒéš¾ç ´è§£çš„å¤å…¸å¯†ç å­¦ã€‚

#### â‘  æ›¿æ¢æ³•

æ›¿æ¢æ³•å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯ç”¨å›ºå®šçš„ä¿¡æ¯å°†åŸæ–‡æ›¿æ¢æˆæ— æ³•ç›´æ¥é˜…è¯»çš„å¯†æ–‡ä¿¡æ¯ã€‚ä¾‹å¦‚å°†Â `b`Â æ›¿æ¢æˆÂ `w`Â ï¼Œ`e`Â æ›¿æ¢æˆ `p`Â ï¼Œè¿™æ · `bee`Â å•è¯å°±å˜æ¢æˆäº† `wpp`ï¼Œä¸çŸ¥é“æ›¿æ¢è§„åˆ™çš„äººå°±æ— æ³•é˜…è¯»å‡ºåŸæ–‡çš„å«ä¹‰ã€‚



æ›¿æ¢æ³•æœ‰å•è¡¨æ›¿æ¢å’Œå¤šè¡¨æ›¿æ¢ä¸¤ç§å½¢å¼ã€‚

1. **å•è¡¨æ›¿æ¢** å³åªæœ‰ä¸€å¼ åŸæ–‡å¯†æ–‡å¯¹ç…§è¡¨å•ï¼Œå‘é€è€…å’Œæ¥æ”¶è€…ç”¨è¿™å¼ è¡¨å•æ¥åŠ å¯†è§£å¯†ã€‚åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼Œè¡¨å•å³ä¸ºï¼š`a b c d e - s w t r p`Â ã€‚

2. **å¤šè¡¨æ›¿æ¢** å³æœ‰å¤šå¼ åŸæ–‡å¯†æ–‡å¯¹ç…§è¡¨å•ï¼Œä¸åŒå­—æ¯å¯ä»¥ç”¨ä¸åŒè¡¨å•çš„å†…å®¹æ›¿æ¢ã€‚
   ä¾‹å¦‚çº¦å®šå¥½è¡¨å•ä¸ºï¼šè¡¨å•Â `1ï¼šabcde-swtrp`Â ã€è¡¨å• `2ï¼šabcde-chfhk`Â ã€è¡¨å•Â `3ï¼šabcde-jftou`ã€‚
   è§„å®šç¬¬ä¸€ä¸ªå­—æ¯ç”¨ç¬¬ä¸‰å¼ è¡¨å•ï¼Œç¬¬äºŒä¸ªå­—æ¯ç”¨ç¬¬ä¸€å¼ è¡¨å•ï¼Œç¬¬ä¸‰ä¸ªå­—æ¯ç”¨ç¬¬äºŒå¼ è¡¨å•ï¼Œè¿™æ—¶Â `bee` å•è¯å°±å˜æˆäº† `(312)fpk`Â ï¼Œç ´è§£éš¾åº¦æ›´é«˜ï¼Œå…¶ä¸­ 312 åˆå«åšå¯†é’¥ï¼Œå¯†é’¥å¯ä»¥äº‹å…ˆçº¦å®šå¥½ï¼Œä¹Ÿå¯ä»¥åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ ‡è®°å‡ºæ¥ã€‚

#### â‘¡ ç§»ä½æ³•

ç§»ä½æ³•å°±æ˜¯å°†åŸæ–‡ä¸­çš„æ‰€æœ‰å­—æ¯éƒ½åœ¨å­—æ¯è¡¨ä¸Šå‘åï¼ˆæˆ–å‘å‰ï¼‰æŒ‰ç…§ä¸€ä¸ªå›ºå®šæ•°ç›®è¿›è¡Œåç§»åå¾—å‡ºå¯†æ–‡ï¼Œ==å…¸å‹çš„ç§»ä½æ³•åº”ç”¨æœ‰ â€œæºæ’’å¯†ç â€==ã€‚

ä¾‹å¦‚çº¦å®šå¥½å‘åç§»åŠ¨ 2 ä½ `ï¼ˆabcde - cdefgï¼‰`ï¼Œè¿™æ ·Â `bee`Â å•è¯å°±å˜æ¢æˆäº† `dgg`Â ã€‚



åŒç†æ›¿æ¢æ³•ï¼Œç§»ä½æ³•ä¹Ÿå¯ä»¥é‡‡ç”¨å¤šè¡¨ç§»ä½çš„æ–¹å¼ï¼Œå…¸å‹çš„å¤šè¡¨æ¡ˆä¾‹æ˜¯ â€œç»´å°¼å‰äºšå¯†ç â€ï¼ˆåˆè¯‘ç»´çƒ­çº³å°”å¯†ç ï¼‰ï¼Œå±äºå¤šè¡¨å¯†ç çš„ä¸€ç§å½¢å¼ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080031096-1246614996-1747390927762-85.jpg)

#### â‘¢ å¤å…¸å¯†ç ç ´è§£æ–¹å¼

å¤å…¸å¯†ç è™½ç„¶å¾ˆç®€å•ï¼Œä½†æ˜¯åœ¨å¯†ç å²ä¸Šæ˜¯ä½¿ç”¨çš„æœ€ä¹…çš„åŠ å¯†æ–¹å¼ï¼Œç›´åˆ° â€œæ¦‚ç‡è®ºâ€ çš„æ•°å­¦æ–¹æ³•è¢«å‘ç°ï¼Œ==å¤å…¸å¯†ç å°±è¢«é¢‘ç‡åˆ†ææ³•ç ´è§£== äº†ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030717-493297273.jpg)

è‹±æ–‡å•è¯ä¸­å­—æ¯å‡ºç°çš„é¢‘ç‡æ˜¯ä¸åŒçš„ï¼Œe ä»¥ 12.702% çš„ç™¾åˆ†æ¯”å æ¯”æœ€é«˜ï¼Œz åªå åˆ° 0.074%ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å»ç™¾ç§‘æŸ¥å­—æ¯é¢‘ç‡è¯¦ç»†ç»Ÿè®¡æ•°æ®ã€‚å¦‚æœå¯†æ–‡æ•°é‡è¶³å¤Ÿå¤§ï¼Œä»…ä»…é‡‡ç”¨é¢‘åº¦åˆ†ææ³•å°±å¯ä»¥ç ´è§£å•è¡¨çš„æ›¿æ¢æ³•æˆ–ç§»ä½æ³•ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030817-175250354.jpg)

å¤šè¡¨çš„æ›¿æ¢æ³•æˆ–ç§»ä½æ³•è™½ç„¶éš¾åº¦é«˜ä¸€äº›ï¼Œä½†å¦‚æœæ•°æ®é‡è¶³å¤Ÿå¤§çš„è¯ï¼Œä¹Ÿæ˜¯å¯ä»¥ç ´è§£çš„ã€‚ä»¥ç»´å°¼å‰äºšå¯†ç ç®—æ³•ä¸ºä¾‹ï¼Œç ´è§£æ–¹æ³•å°±æ˜¯å…ˆæ‰¾å‡ºå¯†æ–‡ä¸­å®Œå…¨ç›¸åŒçš„å­—æ¯ä¸²ï¼ŒçŒœæµ‹å¯†é’¥é•¿åº¦ï¼Œå¾—åˆ°å¯†é’¥é•¿åº¦åå†æŠŠåŒç»„çš„å¯†æ–‡æ”¾åœ¨ä¸€èµ·ï¼Œä½¿ç”¨ ==é¢‘ç‡åˆ†ææ³•ç ´è§£==ã€‚

### 1.1.2 è¿‘ä»£å¯†ç å­¦

å¤å…¸å¯†ç çš„å®‰å…¨æ€§å—åˆ°äº†å¨èƒï¼Œå¤–åŠ ä½¿ç”¨ä¾¿åˆ©æ€§è¾ƒä½ï¼Œåˆ°äº†å·¥ä¸šåŒ–æ—¶ä»£ï¼Œè¿‘ç°ä»£å¯†ç è¢«å¹¿æ³›åº”ç”¨ã€‚

æ©å°¼æ ¼ç›æœº

æ©å°¼æ ¼ç›æœºæ˜¯äºŒæˆ˜æ—¶æœŸçº³ç²¹å¾·å›½ä½¿ç”¨çš„åŠ å¯†æœºå™¨ï¼Œåè¢«è‹±å›½ **ç ´è¯‘**ï¼Œå‚ä¸ç ´è¯‘çš„äººå‘˜æœ‰è¢«ç§°ä¸ºè®¡ç®—æœºç§‘å­¦ä¹‹çˆ¶ã€äººå·¥æ™ºèƒ½ä¹‹çˆ¶çš„ **å›¾çµ**ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030845-1215456334.jpg)

æ©å°¼æ ¼ç›æœº

**æ©å°¼æ ¼ç›æœºä½¿ç”¨çš„åŠ å¯†æ–¹å¼æœ¬è´¨ä¸Šè¿˜æ˜¯ç§»ä½å’Œæ›¿ä»£**ï¼Œåªä¸è¿‡å› ä¸ºå¯†ç è¡¨ç§ç±»æå¤šï¼Œç ´è§£éš¾åº¦é«˜ï¼ŒåŒæ—¶åŠ å¯†è§£å¯†æœºå™¨åŒ–ï¼Œä½¿ç”¨ä¾¿æ·ï¼Œå› è€Œåœ¨äºŒæˆ˜æ—¶æœŸå¾—ä»¥ä½¿ç”¨ã€‚

### 1.1.3 ç°ä»£å¯†ç å­¦

#### â‘  æ•£åˆ—å‡½æ•°

æ•£åˆ—å‡½æ•°ï¼Œä¹Ÿè§æ‚å‡‘å‡½æ•°ã€æ‘˜è¦å‡½æ•°æˆ–å“ˆå¸Œå‡½æ•°ï¼Œå¯ **å°†ä»»æ„é•¿åº¦çš„æ¶ˆæ¯ç»è¿‡è¿ç®—ï¼Œå˜æˆå›ºå®šé•¿åº¦æ•°å€¼**ï¼Œå¸¸è§çš„æœ‰ `MD5`ã€`SHA-1`ã€`SHA256`ï¼Œå¤šåº”ç”¨åœ¨æ–‡ä»¶æ ¡éªŒï¼Œæ•°å­—ç­¾åä¸­ã€‚

> + MD5ï¼šå°†ä»»æ„é•¿åº¦çš„åŸæ–‡ç”Ÿæˆä¸€ä¸ª 128 ä½ï¼ˆ16 å­—èŠ‚ï¼‰çš„å“ˆå¸Œå€¼ã€‚å°½ç®¡ MD5 æ›¾ç»è¢«å¹¿æ³›ä½¿ç”¨ï¼Œä½†ç”±äºå‘ç°äº†å…¶å­˜åœ¨å®‰å…¨æ¼æ´ï¼Œç°åœ¨å®ƒä¸»è¦ç”¨äºéªŒè¯æ•°æ®å®Œæ•´æ€§ï¼Œè€Œä¸æ¨èç”¨äºå®‰å…¨æ€§è‡³å…³é‡è¦çš„åœºåˆã€‚
>
>   
>
> + SHA-1ï¼šå¯ä»¥å°†ä»»æ„é•¿åº¦çš„åŸæ–‡ç”Ÿæˆä¸€ä¸ª 160 ä½ï¼ˆ20 å­—èŠ‚ï¼‰çš„å“ˆå¸Œå€¼ã€‚ä¸ MD5 ç±»ä¼¼ï¼Œå°½ç®¡ SHA-1 æ¯” MD5 æ›´å®‰å…¨ï¼Œä½†éšç€æ—¶é—´çš„æ¨ç§»ï¼Œä¹Ÿå‘ç°äº†å…¶å­˜åœ¨çš„å¼±ç‚¹ï¼Œå› æ­¤ä¹Ÿä¸å†è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„åŠ å¯†å“ˆå¸Œç®—æ³•ã€‚
>
>   
>
> + SHA-256ï¼šèƒ½å¤Ÿå°†ä»»æ„é•¿åº¦çš„åŸæ–‡ç”Ÿæˆä¸€ä¸ª 256 ä½ï¼ˆ32 å­—èŠ‚ï¼‰çš„å“ˆå¸Œå€¼ã€‚å®ƒæ˜¯ SHA ç³»åˆ—çš„ä¸€éƒ¨åˆ†ï¼Œå±äº SHA-2 å®¶æ—ä¸­çš„ä¸€ä¸ªæˆå‘˜ã€‚ç›¸æ¯” SHA-1 å’Œ MD5ï¼ŒSHA-256 æä¾›äº†æ›´é«˜çš„å®‰å…¨æ€§å’ŒæŠ—ç¢°æ’æ€§èƒ½ï¼Œæ„å‘³ç€æ‰¾åˆ°ä¸¤ä¸ªä¸åŒçš„è¾“å…¥äº§ç”Ÿç›¸åŒè¾“å‡ºï¼ˆå³ç¢°æ’ï¼‰çš„éš¾åº¦æ›´å¤§ã€‚æ­£å› ä¸ºå¦‚æ­¤ï¼ŒSHA-256 åœ¨æ•°å­—ç­¾åã€SSL è¯ä¹¦ä»¥åŠåŒºå—é“¾æŠ€æœ¯ï¼ˆå¦‚æ¯”ç‰¹å¸ï¼‰ç­‰é¢†åŸŸå¾—åˆ°äº†å¹¿æ³›åº”ç”¨ã€‚å®ƒçš„å¢å¼ºçš„å®‰å…¨æ€§ä½¿å¾—å®ƒæˆä¸ºå¤„ç†éœ€è¦é«˜å®‰å…¨æ€§åœºæ™¯ä¸‹çš„é¦–é€‰ç®—æ³•ä¹‹ä¸€ã€‚





#### â‘¡ å¯¹ç§°å¯†ç 

==å¯¹ç§°å¯†ç åº”ç”¨äº†ç›¸åŒçš„åŠ å¯†å¯†é’¥å’Œè§£å¯†å¯†é’¥==ã€‚å¯¹ç§°å¯†ç åˆ†ä¸ºï¼šåºåˆ—å¯†ç  (æµå¯†ç )ï¼Œåˆ†ç»„å¯†ç (å—å¯†ç ) ä¸¤ç§ã€‚**æµå¯†ç ** æ˜¯å¯¹ä¿¡æ¯æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼ˆä¸€ä¸ªå­—æ¯æˆ–ä¸€ä¸ªæ¯”ç‰¹ï¼‰ä½œä¸ºåŸºæœ¬çš„å¤„ç†å•å…ƒè¿›è¡ŒåŠ å¯†ï¼Œ**å—å¯†ç ** æ˜¯å…ˆå¯¹ä¿¡æ¯æµåˆ†å—ï¼Œå†å¯¹æ¯ä¸€å—åˆ†åˆ«åŠ å¯†ã€‚

ä¾‹å¦‚ï¼šåŸæ–‡ä¸º 1234567890ï¼ŒæµåŠ å¯†å³å…ˆå¯¹ 1 è¿›è¡ŒåŠ å¯†ï¼Œå†å¯¹ 2 è¿›è¡ŒåŠ å¯†ï¼Œå†å¯¹ 3 è¿›è¡ŒåŠ å¯†â€¦â€¦ æœ€åæ‹¼æ¥æˆå¯†æ–‡ï¼›å—åŠ å¯†å…ˆåˆ†æˆä¸åŒçš„å—ï¼Œå¦‚ 1234 æˆå—ï¼Œ5678 æˆå—ï¼Œ90XX(XX ä¸ºè¡¥ä½æ•°å­—) æˆå—ï¼Œå†åˆ†åˆ«å¯¹ä¸åŒå—è¿›è¡ŒåŠ å¯†ï¼Œæœ€åæ‹¼æ¥æˆå¯†æ–‡ã€‚å‰æ–‡æåˆ°çš„å¤å…¸å¯†ç å­¦åŠ å¯†æ–¹æ³•ï¼Œéƒ½å±äºæµåŠ å¯†ã€‚

#### â‘¢ éå¯¹ç§°å¯†ç 

å¯¹ç§°å¯†ç çš„å¯†é’¥å®‰å…¨æå…¶é‡è¦ï¼ŒåŠ å¯†è€…å’Œè§£å¯†è€…éœ€è¦æå‰åå•†å¯†é’¥ï¼Œå¹¶å„è‡ªç¡®ä¿å¯†é’¥çš„å®‰å…¨æ€§ï¼Œä¸€ä½†å¯†é’¥æ³„éœ²ï¼Œå³ä½¿ç®—æ³•æ˜¯å®‰å…¨çš„ä¹Ÿæ— æ³•ä¿éšœåŸæ–‡ä¿¡æ¯çš„ç§å¯†æ€§ã€‚

åœ¨å®é™…çš„ä½¿ç”¨ä¸­ï¼Œè¿œç¨‹çš„æå‰åå•†å¯†é’¥ä¸å®¹æ˜“å®ç°ï¼Œå³ä½¿åå•†å¥½ï¼Œåœ¨è¿œç¨‹ä¼ è¾“è¿‡ç¨‹ä¸­ä¹Ÿå®¹æ˜“è¢«ä»–äººè·å–ï¼Œå› æ­¤éå¯¹ç§°å¯†é’¥æ­¤æ—¶å°±å‡¸æ˜¾å‡ºäº†ä¼˜åŠ¿ã€‚



éå¯¹ç§°å¯†ç æœ‰ä¸¤æ”¯å¯†é’¥ï¼Œå…¬é’¥ï¼ˆpublickeyï¼‰å’Œç§é’¥ï¼ˆprivatekeyï¼‰ï¼ŒåŠ å¯†å’Œè§£å¯†è¿ç®—ä½¿ç”¨çš„å¯†é’¥ä¸åŒã€‚

**ç”¨å…¬é’¥å¯¹åŸæ–‡è¿›è¡ŒåŠ å¯†åï¼Œéœ€è¦ç”±ç§é’¥è¿›è¡Œè§£å¯†**ï¼š

- åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‘é€è€…ä½¿ç”¨æ¥æ”¶è€…çš„å…¬é’¥å¯¹æ¶ˆæ¯æˆ–æ•°æ®è¿›è¡ŒåŠ å¯†ã€‚ç”±äºå…¬é’¥æ˜¯å…¬å¼€çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥ä½¿ç”¨å®ƒæ¥åŠ å¯†ä¿¡æ¯ã€‚
- ä½†æ˜¯ï¼Œä¸€æ—¦ä¿¡æ¯è¢«åŠ å¯†ï¼Œåªæœ‰æ‹¥æœ‰ç›¸åº”ç§é’¥çš„æ¥æ”¶è€…æ‰èƒ½è§£å¯†è¯¥ä¿¡æ¯ã€‚è¿™ç§æ–¹å¼ç¡®ä¿äº†ä¿¡æ¯çš„ **ä¿å¯†æ€§**ï¼Œå› ä¸ºåªæœ‰æŒ‡å®šçš„æ¥æ”¶è€…èƒ½å¤Ÿè¯»å–åŠ å¯†çš„ä¿¡æ¯ã€‚

**ç”¨ç§é’¥å¯¹åŸæ–‡è¿›è¡ŒåŠ å¯†åï¼ˆæ­¤æ—¶ä¸€èˆ¬ç§°ä¸ºç­¾åï¼‰ï¼Œéœ€è¦ç”±å…¬é’¥è¿›è¡Œè§£å¯†ï¼ˆæ­¤æ—¶ä¸€èˆ¬ç§°ä¸ºéªŒç­¾ï¼‰**ï¼š

- å½“å‘é€è€…æƒ³è¦è¯æ˜æŸæ¡æ¶ˆæ¯ç¡®å®æ¥è‡ªäºè‡ªå·±ï¼Œå¹¶ä¸”åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æœªè¢«ä¿®æ”¹æ—¶ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç§é’¥å¯¹è¯¥æ¶ˆæ¯è¿›è¡ŒåŠ å¯†ï¼ˆæˆ–è€…æ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯å¯¹æ¶ˆæ¯çš„å“ˆå¸Œå€¼è¿›è¡ŒåŠ å¯†ï¼‰ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºâ€œæ•°å­—ç­¾åâ€ã€‚
- æ¥æ”¶è€…éšåå¯ä»¥ä½¿ç”¨å‘é€è€…çš„å…¬é’¥æ¥è§£å¯†è¯¥ç­¾åï¼Œå¹¶å°†è§£å¯†å¾—åˆ°çš„æ¶ˆæ¯æ‘˜è¦ä¸è‡ªå·±è®¡ç®—å‡ºçš„æ¶ˆæ¯æ‘˜è¦è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœä¸¤è€…åŒ¹é…ï¼Œåˆ™è¯´æ˜æ¶ˆæ¯ç¡®å®æ¥è‡ªè¯¥å‘é€è€…å¹¶ä¸”åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚è¿™ä¸€æ­¥éª¤è¢«ç§°ä¸ºâ€œéªŒç­¾â€ã€‚

å…¬é’¥å¯ä»¥å…¬å¼€çš„ï¼Œå¤§å®¶ä½¿ç”¨å…¬é’¥å¯¹ä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œå†å‘é€ç»™ç§é’¥çš„æŒæœ‰è€…ï¼Œç§é’¥æŒæœ‰è€…ä½¿ç”¨ç§é’¥å¯¹ä¿¡æ¯è¿›è¡Œè§£å¯†ï¼Œè·å¾—ä¿¡æ¯åŸæ–‡ã€‚å› ä¸ºç§é’¥åªæœ‰å•ä¸€äººæŒæœ‰ï¼Œå› æ­¤ä¸ç”¨æ‹…å¿ƒè¢«ä»–äººè§£å¯†è·å–ä¿¡æ¯åŸæ–‡ã€‚

### 1.1.4 å¦‚ä½•è®¾ç½®å¯†ç æ‰å®‰å…¨

*   å¯†ç ä¸è¦å¤ªå¸¸è§ï¼Œä¸è¦ä½¿ç”¨ç±»ä¼¼äº 123456 å¼çš„å¸¸ç”¨å¯†ç ã€‚
*   å„åº”ç”¨è½¯ä»¶å¯†ç å»ºè®®ä¸åŒï¼Œé¿å…å‡ºç°ä¸€ä¸ªåº”ç”¨æ•°æ®åº“è¢«è„±åº“ï¼Œå…¨éƒ¨åº”ç”¨å¯†ç å´©å¡Œï¼Œ  ==--æ’åº“==
*   å¯åœ¨è®¾ç½®å¯†ç æ—¶å¢åŠ æ³¨å†Œæ—¶é—´ã€æ³¨å†Œåœ°ç‚¹ã€åº”ç”¨ç‰¹æ€§ç­‰æ–¹æ³•ã€‚ä¾‹å¦‚ tianjin123456ï¼Œè¡¨ç¤ºåœ¨å¤©æ´¥æ³¨å†Œçš„è¯¥åº”ç”¨ã€‚

## 1.2 ASCII ç¼–ç 

ASCIIï¼ˆAmerican Standard Code for Information Interchangeï¼Œç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ï¼‰æ˜¯åŸºäºæ‹‰ä¸å­—æ¯çš„ä¸€å¥—ç”µè„‘ç¼–ç ç³»ç»Ÿï¼Œä¸»è¦ç”¨äºæ˜¾ç¤ºç°ä»£è‹±è¯­å’Œå…¶ä»–è¥¿æ¬§è¯­è¨€ã€‚å®ƒæ˜¯ç°ä»Šæœ€é€šç”¨çš„å•å­—èŠ‚ç¼–ç ç³»ç»Ÿï¼Œå¹¶ç­‰åŒäºå›½é™…æ ‡å‡† ISO/IEC 646ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030883-436248095.jpg)

ç¤ºä¾‹ä»£ç 

åˆ›å»º maven é¡¹ç›®Â `encrypt-decrypt`

æ·»åŠ  pom æ–‡ä»¶

```
<dependencies>
        <dependency>
            <groupId>commons-io</groupId>
            <artifactId>commons-io</artifactId>
            <version>2.6</version>
        </dependency>
    </dependencies>
```

åˆ›å»ºç±»Â `com.atguigu.ascii.AsciiDemo`

å­—ç¬¦è½¬æ¢æˆ ascii ç 

```java
package com.atguigu.ascii;

public class AsciiDemo {

    public static void main(String[] args) {
        char a = 'A';
        int b = a;
        // æ‰“å° ascii ç 
        System.out.println(b);
    }
}
```

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030521-223578601.jpg)

å­—ç¬¦ä¸²è½¬æ¢æˆ ascii ç 

```java
package com.atguigu.ascii;


public class AsciiDemo {

    public static void main(String[] args) {
//        char a = 'A';
//        int b = a;
//        System.out.println(b);
        String a = "AaZ";
        // è·å– ascii ç ï¼Œéœ€è¦æŠŠå­—ç¬¦ä¸²è½¬æˆå­—ç¬¦
        char[] chars = a.toCharArray();
        for (char c : chars) {

            int asciiCode = c;
            System.out.println(asciiCode);
        }
    }
}
```

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030707-1250014255.jpg)

## 1.3 æºæ’’åŠ å¯†

### 1.3.1 ä¸­å›½å¤ä»£åŠ å¯†

çœ‹ä¸€ä¸ªå°æ•…äº‹ ï¼Œ çœ‹çœ‹å¤äººå¦‚ä½•åŠ å¯†å’Œè§£å¯†ï¼š

å…¬å…ƒ 683 å¹´ï¼Œå”ä¸­å®—å³ä½ã€‚éšåï¼Œæ­¦åˆ™å¤©åºŸå”ä¸­å®—ï¼Œç«‹ç¬¬å››å­ææ—¦ä¸ºçš‡å¸ï¼Œä½†æœæ”¿å¤§äº‹å‡ç”±å¥¹è‡ªå·±ä¸“æ–­ã€‚ã€€ã€€

ã€€ã€€è£´ç‚ã€å¾æ•¬ä¸šå’Œéª†å®¾ç‹ç­‰äººå¯¹æ­¤éå¸¸ä¸æ»¡ã€‚å¾æ•¬ä¸šèšå…µåä¸‡ï¼Œåœ¨æ±Ÿè‹æ‰¬å·èµ·å…µã€‚è£´ç‚åšå†…åº”ï¼Œæ¬²ä»¥æ‹†å­—æ‰‹æ®µä¸ºå…¶ä¼ é€’ç§˜å¯†ä¿¡æ¯ã€‚åå› æœ‰äººå‘Šå¯†ï¼Œè£´ç‚è¢«æ•ï¼Œæœªå‘å‡ºçš„å¯†ä¿¡è½åˆ°æ­¦åˆ™å¤©æ‰‹ä¸­ã€‚è¿™å°å¯†ä¿¡ä¸Šåªæœ‰ â€œé’é¹…â€ äºŒå­—ï¼Œç¾¤è‡£å¯¹æ­¤å¤§æƒ‘ä¸è§£ã€‚ã€€ã€€

ã€€ã€€æ­¦åˆ™å¤©ç ´è§£äº† â€œé’é¹…â€ çš„ç§˜å¯†ï¼šâ€œé’â€å­—æ‹†å¼€æ¥å°±æ˜¯ â€œåäºŒæœˆâ€ï¼Œè€Œâ€œé¹…â€ å­—æ‹†å¼€æ¥å°±æ˜¯ â€œæˆ‘è‡ªä¸â€ã€‚å¯†ä¿¡çš„æ„æ€æ˜¯è®©å¾æ•¬ä¸šã€éª†å®¾ç‹ç­‰ç‡å…µäºåäºŒæœˆè¿›å‘ï¼Œè£´ç‚åœ¨å†…éƒ¨æ¥åº”ã€‚â€œé’é¹…â€ ç ´è¯‘åï¼Œè£´ç‚è¢«æ€ã€‚æ¥ç€ï¼Œæ­¦åˆ™å¤©æ´¾å…µå‡»è´¥äº†å¾æ•¬ä¸šå’Œéª†å®¾ç‹ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030827-1419660812.jpg)

### 1.3.2 å¤–å›½åŠ å¯†

åœ¨å¯†ç å­¦ä¸­ï¼Œæºæ’’å¯†ç æ˜¯ä¸€ç§æœ€ç®€å•ä¸”æœ€å¹¿ä¸ºäººçŸ¥çš„åŠ å¯†æŠ€æœ¯ã€‚

å‡¯æ’’å¯†ç æœ€æ—©ç”±å¤ç½—é©¬å†›äº‹ç»Ÿå¸…ç›–ä¹Œæ–¯ Â· å°¤åˆ©ä¹Œæ–¯ Â· å‡¯æ’’åœ¨å†›é˜Ÿä¸­ç”¨æ¥ä¼ é€’åŠ å¯†ä¿¡æ¯ï¼Œæ•…ç§°å‡¯æ’’å¯†ç ã€‚è¿™æ˜¯ä¸€ç§ä½ç§»åŠ å¯†æ–¹å¼ï¼Œåªå¯¹ 26 ä¸ªå­—æ¯è¿›è¡Œä½ç§»æ›¿æ¢åŠ å¯†ï¼Œè§„åˆ™ç®€å•ï¼Œå®¹æ˜“ç ´è§£ã€‚ä¸‹é¢æ˜¯ä½ç§» 1 æ¬¡çš„å¯¹æ¯”ï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030762-261160747.jpg)

å°†æ˜æ–‡å­—æ¯è¡¨å‘åç§»åŠ¨ 1 ä½ï¼ŒA å˜æˆäº† Bï¼ŒB å˜æˆäº† Câ€¦â€¦ï¼ŒZ å˜æˆäº† Aã€‚åŒç†ï¼Œè‹¥å°†æ˜æ–‡å­—æ¯è¡¨å‘åç§»åŠ¨ 3 ä½ï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030617-545821994.jpg)

åˆ™ A å˜æˆäº† Dï¼ŒB å˜æˆäº† Eâ€¦â€¦ï¼ŒZ å˜æˆäº† Cã€‚

å­—æ¯è¡¨æœ€å¤šå¯ä»¥ç§»åŠ¨ 25 ä½ã€‚å‡¯æ’’å¯†ç çš„æ˜æ–‡å­—æ¯è¡¨å‘åæˆ–å‘å‰ç§»åŠ¨éƒ½æ˜¯å¯ä»¥çš„ï¼Œé€šå¸¸è¡¨è¿°ä¸ºå‘åç§»åŠ¨ï¼Œå¦‚æœè¦å‘å‰ç§»åŠ¨ 1 ä½ï¼Œåˆ™ç­‰åŒäºå‘åç§»åŠ¨ 25 ä½ï¼Œä½ç§»é€‰æ‹©ä¸º 25 å³å¯ã€‚

å®ƒæ˜¯ä¸€ç§æ›¿æ¢åŠ å¯†çš„æŠ€æœ¯ï¼Œæ˜æ–‡ä¸­çš„æ‰€æœ‰å­—æ¯éƒ½åœ¨å­—æ¯è¡¨ä¸Šå‘åï¼ˆæˆ–å‘å‰ï¼‰æŒ‰ç…§ä¸€ä¸ªå›ºå®šæ•°ç›®è¿›è¡Œåç§»åè¢«æ›¿æ¢æˆå¯†æ–‡ã€‚

ä¾‹å¦‚ï¼Œå½“åç§»é‡æ˜¯ 3 çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„å­—æ¯ A å°†è¢«æ›¿æ¢æˆ Dï¼ŒB å˜æˆ Eï¼Œä»¥æ­¤ç±»æ¨ã€‚

è¿™ä¸ªåŠ å¯†æ–¹æ³•æ˜¯ä»¥æºæ’’çš„åå­—å‘½åçš„ï¼Œå½“å¹´æºæ’’æ›¾ç”¨æ­¤æ–¹æ³•ä¸å…¶å°†å†›ä»¬è¿›è¡Œè”ç³»ã€‚

æºæ’’å¯†ç é€šå¸¸è¢«ä½œä¸ºå…¶ä»–æ›´å¤æ‚çš„åŠ å¯†æ–¹æ³•ä¸­çš„ä¸€ä¸ªæ­¥éª¤ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030717-60576484.jpg)

ç®€å•æ¥è¯´å°±æ˜¯å½“ç§˜é’¥ä¸º nï¼Œå…¶ä¸­ä¸€ä¸ªå¾…åŠ å¯†å­—ç¬¦ chï¼ŒåŠ å¯†ä¹‹åçš„å­—ç¬¦ä¸º ch+nï¼Œå½“ ch+n è¶…è¿‡â€™zâ€™æ—¶ï¼Œå›åˆ°â€™aâ€™è®¡æ•°ã€‚

### 1.3.3 å‡¯æ’’ä½ç§»åŠ å¯†

åˆ›å»ºç±»Â `KaiserDemo`ï¼ŒæŠŠÂ `hello world`Â å¾€å³è¾¹ç§»åŠ¨ 3 ä½

```java
package com.atguigu.kaiser;

public class KaiserDemo {
    public static void main(String[] args) {
        String input = "Hello world";
        // å¾€å³è¾¹ç§»åŠ¨ 3 ä½
        int key = 3;
        // ç”¨æ¥æ‹¼æ¥
        StringBuilder sb = new StringBuilder();
        // å­—ç¬¦ä¸²è½¬æ¢æˆå­—èŠ‚æ•°ç»„
        char[] chars = input.toCharArray();
        for (char c : chars) {
            int asciiCode = c;
            // ç§»åŠ¨ 3 ä½
            asciiCode = asciiCode + key;
            char newChar = (char) asciiCode;
            sb.append(newChar);
        }

        System.out.println(sb.toString());
    }
}
```

è¿è¡Œ

![](./images/å¯†ç å­¦/2957590-20230131080030599-2039356250.jpg)

### 1.3.4 å‡¯æ’’åŠ å¯†å’Œè§£å¯†

#### ç®€æ˜“ç‰ˆ

```java
package com.atguigu.kaiser;

public class KaiserDemo {
    public static void main(String[] args) {
        String orignal = "Hello world";
        // å¾€å³è¾¹åç§»ä¸‰ä½
        int key = 3;
        // é€‰ä¸­æˆ‘å³å°†æŠ½å–çš„ä»£ç ï¼ŒæŒ‰å¿«æ·é”®Ctrl + Alt + M 
        String encryptKaiser =  encryptKaiser(orignal,key);
        System.out.println("åŠ å¯†ï¼š" + encryptKaiser);
        String decryptKaiser =  decryptKaiser(encryptKaiser,key);
        System.out.println("è§£å¯†ï¼š" + decryptKaiser);
    }
    /**
     * ä½¿ç”¨å‡¯æ’’åŠ å¯†æ–¹å¼è§£å¯†æ•°æ®
     *
     * @param encryptedData :å¯†æ–‡
     * @param key           :å¯†é’¥
     * @return : æºæ•°æ®
     */
    public static String decryptKaiser(String encryptedData, int key) {
        // å°†å­—ç¬¦ä¸²è½¬ä¸ºå­—ç¬¦æ•°ç»„
        char[] chars = encryptedData.toCharArray();
        StringBuilder sb = new StringBuilder();
        for (char aChar : chars) {
            // è·å–å­—ç¬¦çš„ASCIIç¼–ç 
            int asciiCode = aChar;
            // åç§»æ•°æ®
            asciiCode -= key;
            // å°†åç§»åçš„æ•°æ®è½¬ä¸ºå­—ç¬¦
            char result = (char) asciiCode;
            // æ‹¼æ¥æ•°æ®
            sb.append(result);
        }
        return sb.toString();
    }
    /**
     * ä½¿ç”¨å‡¯æ’’åŠ å¯†æ–¹å¼åŠ å¯†æ•°æ®
     *
     * @param orignal :åŸæ–‡
     * @param key     :å¯†é’¥
     * @return :åŠ å¯†åçš„æ•°æ®
     */
    public static String encryptKaiser(String orignal, int key) {
        // å°†å­—ç¬¦ä¸²è½¬ä¸ºå­—ç¬¦æ•°ç»„
        char[] chars = orignal.toCharArray();
        StringBuilder sb = new StringBuilder();
        for (char aChar : chars) {
            // è·å–å­—ç¬¦çš„asciiç¼–ç 
            int asciiCode = aChar;
            // åç§»æ•°æ®
            asciiCode += key;
            // å°†åç§»åçš„æ•°æ®è½¬ä¸ºå­—ç¬¦
            char result = (char) asciiCode;
            // æ‹¼æ¥æ•°æ®
            sb.append(result);
        }
        return sb.toString();
    }
}
```



#### ä¼˜åŒ–å¤„ç†æº¢å‡ºé—®é¢˜ï¼š

```java
package encrypt_decrypt;

/**
 * KaiserDemo ç±»å®ç°äº†å‡¯æ’’åŠ å¯†å’Œè§£å¯†çš„åŠŸèƒ½ã€‚
 * å‡¯æ’’åŠ å¯†æ˜¯ä¸€ç§ç®€å•çš„æ›¿æ¢åŠ å¯†æŠ€æœ¯ï¼Œé€šè¿‡å°†æ¯ä¸ªå­—æ¯æ›¿æ¢ä¸ºå­—æ¯è¡¨ä¸­å›ºå®šä½ç½®çš„å¦ä¸€ä¸ªå­—æ¯æ¥å®ç°ã€‚
 * è¯¥ç±»æä¾›äº†ä¸¤ä¸ªä¸»è¦æ–¹æ³•ï¼šencryptKaiser å’Œ decryptKaiserï¼Œåˆ†åˆ«ç”¨äºåŠ å¯†å’Œè§£å¯†å­—ç¬¦ä¸²ã€‚
 */
public class KaiserDemo {

    private static final char UPPER_A = 'A';
    private static final char LOWER_A = 'a';
    private static final int ALPHABET_SIZE = 26;

    public static void main(String[] args) {
        // æµ‹è¯•æ•°æ®ï¼šè¾“å…¥ä¸€ä¸ªåŒ…å«æ‰€æœ‰å°å†™å­—æ¯çš„å­—ç¬¦ä¸²
        String input = "abcdefghijklmnopqrstuvwxyz";

        // è°ƒç”¨åŠ å¯†æ–¹æ³•ï¼Œå¯†é’¥ä¸º3
        String s = encryptKaiser(input, 3);
        System.out.println("åŠ å¯†ï¼š" + s);

        // è°ƒç”¨è§£å¯†æ–¹æ³•ï¼Œå¯†é’¥ä¸º3
        String s1 = decryptKaiser(s, 3);
        System.out.println("è§£å¯†ï¼š" + s1);
    }

    /**
     * ä½¿ç”¨å‡¯æ’’åŠ å¯†æ–¹å¼è§£å¯†æ•°æ®
     *
     * @param encryptedData : å¯†æ–‡
     * @param key           : å¯†é’¥
     * @return : æºæ•°æ®
     */
    public static String decryptKaiser(String encryptedData, int key) {
        return transform(encryptedData, -key);
    }

    /**
     * å‡¯æ’’å¯†ç åŠ å¯†å‡½æ•°ï¼Œä»…å¯¹è‹±æ–‡å­—æ¯è¿›è¡Œåç§»ï¼Œä¿ç•™å¤§å°å†™
     *
     * @param original : åŸæ–‡
     * @param key      : å¯†é’¥
     * @return : åŠ å¯†åçš„æ•°æ®
     */
    public static String encryptKaiser(String original, int key) {
        return transform(original, key);
    }

    /**
     * æ ¸å¿ƒè½¬æ¢æ–¹æ³•ï¼Œç”¨äºåŠ å¯†æˆ–è§£å¯†
     *
     * @param text åŸæ–‡æˆ–å¯†æ–‡
     * @param shift åç§»é‡ï¼ˆæ­£ä¸ºåŠ å¯†ï¼Œè´Ÿä¸ºè§£å¯†ï¼‰
     * @return è½¬æ¢åçš„æ–‡æœ¬
     */
    private static String transform(String text, int shift) {
        if (text == null || text.isEmpty()) {
            return text;
        }

        int normalizedShift = Math.floorMod(shift, ALPHABET_SIZE);// ç¡®ä¿åç§»é‡åœ¨æœ‰æ•ˆèŒƒå›´å†… 3 --> 3   -3-->23
        char[] chars = text.toCharArray();
        StringBuilder sb = new StringBuilder(chars.length);

        for (char c : chars) {
            if (Character.isLetter(c)) {
                char base = Character.isUpperCase(c) ? UPPER_A : LOWER_A;
                int offset = (c - base + normalizedShift) % ALPHABET_SIZE;
                sb.append((char) (base + offset));
            } else {
                sb.append(c); // éå­—æ¯å­—ç¬¦ä¿æŒä¸å˜
            }
        }

        return sb.toString();
    }
}

```



## 1.4 é¢‘åº¦åˆ†ææ³•ç ´è§£æºæ’’åŠ å¯†

### å¯†ç æ£’

å…¬å…ƒå‰ 5 ä¸–çºªçš„æ—¶å€™ï¼Œæ–¯å·´è¾¾äººåˆ©ç”¨ä¸€æ ¹æœ¨æ£’ï¼Œç¼ ç»•ä¸Šçš®é©æˆ–è€…ç¾Šçš®çº¸ï¼Œåœ¨ä¸Šé¢æ¨ªå‘å†™ä¸‹ä¿¡æ¯ï¼Œè§£ä¸‹è¿™æ¡çš®å¸¦ã€‚å±•å¼€æ¥çœ‹ï¼Œè¿™é•¿ä¸²å­—æ¯æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚

æ¯”å¦‚è¿™æ ·ï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030811-223312957.jpg)

ä¿¡å·®å¯ä»¥å°†è¿™æ¡çš®å¸¦å½“æˆè…°å¸¦ï¼Œç³»åœ¨è…°ä¸Šã€‚

æ¯”å¦‚è¿™æ ·ï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030815-540257237.jpg)

ç„¶åæ”¶ä»¶äººå°†è¿™æ¡çš®å¸¦ç¼ ç»•åœ¨ç›¸åŒçš„æœ¨æ£’ä¸Šï¼Œå°±èƒ½æ¢å¤ä¿¡æ¯äº†ã€‚

å‰ 404 å¹´ï¼Œä¸€ä½éä½“é³ä¼¤çš„ä¿¡å·®æ¥åˆ°æ–¯å·´è¾¾å°†é¢†åˆ©æ¡‘å¾·é¢å‰ï¼Œè¿™è¶Ÿæ³¢æ–¯ä¹‹æ—…åªæœ‰ä»–å’Œå››ä½åŒä¼´å¹¸å­˜ï¼Œåˆ©æ¡‘å¾·æ¥ä¸‹è…°å¸¦ï¼Œç¼ ç»•åˆ°ä»–çš„å¯†ç æ£’ä¸Šï¼Œå¾—çŸ¥æ³¢æ–¯çš„å‘é‚£å·´ç¥–æ–¯å‡†å¤‡ä¾µè¢­ä»–ï¼Œå¤šäºå¯†ç æ£’åˆ©æ¡‘å¾·æ‰èƒ½å¤Ÿé¢„å…ˆé˜²èŒƒï¼Œå‡»é€€æ•Œå†›ã€‚

### é¢‘ç‡åˆ†æè§£å¯†æ³•

å¯†ç æ£’æ˜¯ä¸æ˜¯å¤ªç®€å•äº†äº›ï¼Ÿ

åŠ å¯†è€…é€‰æ‹©å°†ç»„æˆä¿¡æ¯çš„å­—æ¯æ›¿ä»£æˆåˆ«çš„å­—æ¯ï¼Œæ¯”å¦‚è¯´å°† a å†™æˆ 1ï¼Œè¿™æ ·å°±ä¸èƒ½è¢«è§£å¯†è€…ç›´æ¥æ‹¿åˆ°ä¿¡æ¯äº†ã€‚

è¿™éš¾ä¸å€’è§£å¯†è€…ï¼Œä»¥è‹±æ–‡å­—æ¯ä¸ºä¾‹ï¼Œä¸ºäº†ç¡®å®šæ¯ä¸ªè‹±æ–‡å­—æ¯çš„å‡ºç°é¢‘ç‡ï¼Œåˆ†æä¸€ç¯‡æˆ–è€…æ•°ç¯‡æ™®é€šçš„è‹±æ–‡æ–‡ç« ï¼Œè‹±æ–‡å­—æ¯å‡ºç°é¢‘ç‡æœ€é«˜çš„æ˜¯ eï¼Œæ¥ä¸‹æ¥æ˜¯ tï¼Œç„¶åæ˜¯ aâ€¦â€¦ï¼Œç„¶åæ£€æŸ¥è¦ç ´è§£çš„å¯†æ–‡ï¼Œä¹Ÿå°†æ¯ä¸ªå­—æ¯å‡ºç°çš„é¢‘ç‡æ•´ç†å‡ºæ¥ï¼Œå‡è®¾å¯†æ–‡ä¸­å‡ºç°é¢‘ç‡æœ€é«˜çš„å­—æ¯æ˜¯ jï¼Œé‚£ä¹ˆå°±å¯èƒ½æ˜¯ e çš„æ›¿èº«ï¼Œå¦‚æœå¯†ç æ–‡ä¸­å‡ºç°é¢‘ç‡æ¬¡é«˜çš„ä½†æ˜¯ Pï¼Œé‚£ä¹ˆå¯èƒ½æ˜¯ t çš„æ›¿èº«ï¼Œä»¥æ­¤ç±»æ¨ä¾¿å°±èƒ½è§£å¼€åŠ å¯†ä¿¡æ¯çš„å†…å®¹ã€‚è¿™å°±æ˜¯é¢‘ç‡åˆ†ææ³•ã€‚

*   å°†æ˜æ–‡å­—æ¯çš„å‡ºç°é¢‘ç‡ä¸å¯†æ–‡å­—æ¯çš„é¢‘ç‡ç›¸æ¯”è¾ƒçš„è¿‡ç¨‹
*   é€šè¿‡åˆ†ææ¯ä¸ªç¬¦å·å‡ºç°çš„é¢‘ç‡è€Œè½»æ˜“åœ°ç ´è¯‘ä»£æ¢å¼å¯†ç 
*   åœ¨æ¯ç§è¯­è¨€ä¸­ï¼Œå†—é•¿çš„æ–‡ç« ä¸­çš„å­—æ¯è¡¨ç°å‡ºä¸€ç§å¯å¯¹ä¹‹è¿›è¡Œåˆ†è¾¨çš„é¢‘ç‡ã€‚
*   **e æ˜¯è‹±è¯­ä¸­æœ€å¸¸ç”¨çš„å­—æ¯**ï¼Œå…¶å‡ºç°é¢‘ç‡ä¸ºå…«åˆ†ä¹‹ä¸€

æ‹·è´èµ„æ–™é‡Œé¢çš„Â `Util.java`Â å’ŒÂ `FrequencyAnalysis.java`Â åˆ°é¡¹ç›®çš„Â `com.atguigu.kaiser` åŒ…ä¸‹é¢ ,Â `article.txt`Â æ‹·è´åˆ°é¡¹ç›®æ–‡ä»¶å¤¹çš„æ ¹ç›®å½•

è¿è¡ŒÂ `FrequencyAnalysis.java`Â ç”¨æ¥ç»Ÿè®¡æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°

![](./images/å¯†ç å­¦/2957590-20230131080030768-1247189082.jpg)

è¿è¡ŒÂ `FrequencyAnalysis.java`Â é‡Œé¢ main å‡½æ•°é‡Œé¢çš„Â `encryptFile`Â æ–¹æ³• å¯¹ç¨‹åºè¿›è¡ŒåŠ å¯†

```java
public static void main(String[] args) throws Exception {
		//æµ‹è¯•1ï¼Œç»Ÿè®¡å­—ç¬¦ä¸ªæ•°
		//printCharCount("article.txt");
		
		//åŠ å¯†æ–‡ä»¶
		int key = 3;
		encryptFile("article.txt", "article_en.txt", key);
		
		//è¯»å–åŠ å¯†åçš„æ–‡ä»¶
	   // String artile = Util.file2String("article_en.txt");
	    //è§£å¯†ï¼ˆä¼šç”Ÿæˆå¤šä¸ªå¤‡é€‰æ–‡ä»¶ï¼‰
	   // decryptCaesarCode(artile, "article_de.txt");
	}
```

åœ¨æ ¹ç›®å½•ä¼šç”Ÿæˆä¸€ä¸ªÂ `article_en.txt`Â æ–‡ä»¶ï¼Œç„¶åæˆ‘ä»¬ç»Ÿè®¡è¿™ä¸ªæ–‡ä»¶å½“ä¸­æ¯ä¸ªå­—ç¬¦å‡ºç°çš„æ¬¡æ•°

```java
public static void main(String[] args) throws Exception {
		//æµ‹è¯•1ï¼Œç»Ÿè®¡å­—ç¬¦ä¸ªæ•°
		printCharCount("article_en.txt");
		
		//åŠ å¯†æ–‡ä»¶
		int key = 3;
		//encryptFile("article.txt", "article_en.txt", key);
		
		//è¯»å–åŠ å¯†åçš„æ–‡ä»¶
	   // String artile = Util.file2String("article_en.txt");
	    //è§£å¯†ï¼ˆä¼šç”Ÿæˆå¤šä¸ªå¤‡é€‰æ–‡ä»¶ï¼‰
	   // decryptCaesarCode(artile, "article_de.txt");
	}
```

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030696-1527731967.jpg)

æˆ‘ä»¬æ¥çœ‹çœ‹ é¢‘åº¦åˆ†ææ³•å¦‚ä½•å·¥ä½œçš„

```java
public static void main(String[] args) throws Exception {
		//æµ‹è¯•1ï¼Œç»Ÿè®¡å­—ç¬¦ä¸ªæ•°
		//printCharCount("article_en.txt");
		
		//åŠ å¯†æ–‡ä»¶
		int key = 3;
		//encryptFile("article.txt", "article_en.txt", key);
		
		//è¯»å–åŠ å¯†åçš„æ–‡ä»¶
	   String artile = Util.file2String("article_en.txt");
	    //è§£å¯†ï¼ˆä¼šç”Ÿæˆå¤šä¸ªå¤‡é€‰æ–‡ä»¶ï¼‰
	   decryptCaesarCode(artile, "article_de.txt");
	}
```

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030674-1443678180.jpg)

è¿è¡Œç»“æœ # å‡ºç°æ¬¡æ•°æœ€å¤šï¼Œ æˆ‘ä»¬çŸ¥é“åœ¨è‹±æ–‡å½“ä¸­ e å‡ºç°çš„é¢‘ç‡æ˜¯æœ€é«˜çš„ï¼Œæˆ‘ä»¬å‡è®¾ç°åœ¨ # å·ï¼Œå°±æ˜¯ e ï¼Œå˜å½¢è€Œæ¥çš„ ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ç…§ ascii ç¼–ç è¡¨ ï¼Œæˆ‘ä»¬çš„å‡¯æ’’åŠ å¯†å½“ä¸­ä½ç§»æ˜¯åŠ äº†ä¸€ä¸ª key ï¼Œæ‰€ä»¥æˆ‘ä»¬ çŒœæµ‹ ä¸¤ä¸ªå€¼ç›´æ¥ç›¸å·® -66 ï¼Œæˆ‘ä»¬ç°åœ¨å°±ä»¥ -66 è¿›è¡Œè§£å¯† ç”Ÿæˆä¸€ä¸ªæ–‡ä»¶ï¼Œæˆ‘ä»¬æŸ¥çœ‹ç¬¬ä¸€ä¸ªæ–‡ä»¶å‘ç°ï¼Œæ ¹æœ¬è¯»ä¸æ‡‚ï¼Œæ‰€ä»¥è§£å¯†å¤±è´¥ï¼Œæˆ‘ä»¬åœ¨çŒœæµ‹ h æ˜¯ e ï¼Œh å’Œ e ä¹‹é—´ç›¸å·® 3 ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨å»çœ‹ç¬¬äºŒä¸ªè§£å¯†æ–‡ä»¶ï¼Œå‘ç°æˆ‘ä»¬å¯ä»¥è¯»æ‡‚ï¼Œè§£å¯†æˆåŠŸ

![](./images/å¯†ç å­¦/2957590-20230131080031169-1132754898.jpg)



### ä»£ç 

#### å·¥å…·ç±»Util

```java
package com.atguigu.kaiser;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;
import java.io.InputStream;

public class Util {

	/**
	 * æ‰“å°å­—èŠ‚æ•°ç»„
	 * @param bytes
	 */
	public static void print(byte[] bytes) {
		StringBuffer sb = new StringBuffer();
		for (int i = 0; i < bytes.length; i++) {
			sb.append(bytes[i]).append(" ");
		}
		System.out.println(sb);
	}

	/**
	 *  æ–‡ä»¶è½¬å­—ç¬¦ä¸²
	 * @param path
	 * @return
	 * @throws IOException
	 */
	public static String file2String(String path) throws IOException {
		FileReader reader = new FileReader(new File(path));
		char[] buffer = new char[1024];
		int len = -1;
		StringBuffer sb = new StringBuffer();
		while ((len = reader.read(buffer)) != -1) {
			sb.append(buffer, 0, len);
		}
		return sb.toString();
	}

	/**
	 *  å­—ç¬¦ä¸²è½¬æ–‡ä»¶
	 * @param data
	 * @param path
	 */
	public static void string2File(String data, String path){
		FileWriter writer = null;
		try {
			writer = new FileWriter(new File(path));
			writer.write(data);
		} catch (Exception e) {
			e.printStackTrace();
		}finally {
			if (writer != null) {
				try {
					writer.close();
				} catch (IOException e) {
					e.printStackTrace();
				}
			}
		}

	}

	/**
	 * è¾“å…¥æµè½¬å­—ç¬¦ä¸²
	 * @param in
	 * @return
	 * @throws IOException
	 */
	public static String inputStream2String(InputStream in) throws IOException {
		int len = -1;
		byte[] buffer = new byte[1024];
		ByteArrayOutputStream baos = new ByteArrayOutputStream();
		while((len = in.read(buffer)) != -1) {
			baos.write(buffer, 0, len);
		}
		baos.close();
		
		return baos.toString("UTF-8");
	}
	
	
}

```





#### é¢‘ç‡åˆ†ææ³•FrequencyAnalysis

```java
package com.atguigu.kaiser;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;

/**
 * é¢‘ç‡åˆ†ææ³•ç ´è§£å‡¯æ’’å¯†ç 
 */
public class FrequencyAnalysis {
	//è‹±æ–‡é‡Œå‡ºç°æ¬¡æ•°æœ€å¤šçš„å­—ç¬¦
	private static final char MAGIC_CHAR = 'e';
	//ç ´è§£ç”Ÿæˆçš„æœ€å¤§æ–‡ä»¶æ•°
	private static final int DE_MAX_FILE = 4;
	
	public static void main(String[] args) throws Exception {
		//æµ‹è¯•1ï¼Œç»Ÿè®¡å­—ç¬¦ä¸ªæ•°
		printCharCount("article_en.txt");
		
		//åŠ å¯†æ–‡ä»¶
//		int key = 3;
//		encryptFile("article.txt", "article_en.txt", key);
		
		//è¯»å–åŠ å¯†åçš„æ–‡ä»¶
	    String artile = Util.file2String("article_en.txt");
	    //è§£å¯†ï¼ˆä¼šç”Ÿæˆå¤šä¸ªå¤‡é€‰æ–‡ä»¶ï¼‰
	    decryptCaesarCode(artile, "article_de.txt");
	}
	
	public static void printCharCount(String path) throws IOException{
		// è¯»å–æ–‡ä»¶å†…å®¹
		String data = Util.file2String(path);
		List<Entry<Character, Integer>> mapList = getMaxCountChar(data);
		for (Entry<Character, Integer> entry : mapList) {
			//è¾“å‡ºå‰å‡ ä½çš„ç»Ÿè®¡ä¿¡æ¯
			System.out.println("å­—ç¬¦'" + entry.getKey() + "'å‡ºç°" + entry.getValue() + "æ¬¡");
		}
	}
	
	public static void encryptFile(String srcFile, String destFile, int key) throws IOException {
		String artile = Util.file2String(srcFile);
		//åŠ å¯†æ–‡ä»¶
		String encryptData = KaiserDemo.encrypt(artile, key);
		//ä¿å­˜åŠ å¯†åçš„æ–‡ä»¶
		Util.string2File(encryptData, destFile);
	}
	
	/**
	 * ç ´è§£å‡¯æ’’å¯†ç 
	 * @param input æ•°æ®æº
	 * @return è¿”å›è§£å¯†åçš„æ•°æ®
	 */
	public static void decryptCaesarCode(String input, String destPath) {
		int deCount = 0;//å½“å‰è§£å¯†ç”Ÿæˆçš„å¤‡é€‰æ–‡ä»¶æ•°
		//è·å–å‡ºç°é¢‘ç‡æœ€é«˜çš„å­—ç¬¦ä¿¡æ¯ï¼ˆå‡ºç°æ¬¡æ•°è¶Šå¤šè¶Šé å‰ï¼‰
		List<Entry<Character, Integer>> mapList = getMaxCountChar(input);
		for (Entry<Character, Integer> entry : mapList) {
			//é™åˆ¶è§£å¯†æ–‡ä»¶å¤‡é€‰æ•°
			if (deCount >= DE_MAX_FILE) {
				break;
			}
			
			//è¾“å‡ºå‰å‡ ä½çš„ç»Ÿè®¡ä¿¡æ¯
			System.out.println("å­—ç¬¦'" + entry.getKey() + "'å‡ºç°" + entry.getValue() + "æ¬¡");
			
			++deCount;
			//å‡ºç°æ¬¡æ•°æœ€é«˜çš„å­—ç¬¦è·ŸMAGIC_CHARçš„åç§»é‡å³ä¸ºç§˜é’¥
			int key = entry.getKey() - MAGIC_CHAR;
			System.out.println("çŒœæµ‹key = " + key + "ï¼Œ è§£å¯†ç”Ÿæˆç¬¬" + deCount + "ä¸ªå¤‡é€‰æ–‡ä»¶" + "\n");
			String decrypt = KaiserDemo.decrypt(input, key);
			
			String fileName = "de_" + deCount + destPath;
			Util.string2File(decrypt, fileName);
		}
	}
	
	//ç»Ÿè®¡Stringé‡Œå‡ºç°æœ€å¤šçš„å­—ç¬¦
	public static List<Entry<Character, Integer>> getMaxCountChar(String data) {
		Map<Character, Integer> map = new HashMap<Character, Integer>();
		char[] array = data.toCharArray();
		for (char c : array) {
			if(!map.containsKey(c)) {
				map.put(c, 1);
			}else{
				Integer count = map.get(c);
				map.put(c, count + 1);
			}
		}
		
		//è¾“å‡ºç»Ÿè®¡ä¿¡æ¯
		/*for (Entry<Character, Integer> entry : map.entrySet()) {
			System.out.println(entry.getKey() + "å‡ºç°" + entry.getValue() +  "æ¬¡");
		}*/
		
		//è·å–è·å–æœ€å¤§å€¼
		int maxCount = 0;
		for (Entry<Character, Integer> entry : map.entrySet()) {
			//ä¸ç»Ÿè®¡ç©ºæ ¼
			if (/*entry.getKey() != ' ' && */entry.getValue() > maxCount) { 
				maxCount = entry.getValue();
			}
		}
		
		//mapè½¬æ¢æˆlistä¾¿äºæ’åº
		List<Entry<Character, Integer>> mapList = new ArrayList<Entry<Character,Integer>>(map.entrySet());
		//æ ¹æ®å­—ç¬¦å‡ºç°æ¬¡æ•°æ’åº
		Collections.sort(mapList, new Comparator<Entry<Character, Integer>>(){

			public int compare(Entry<Character, Integer> o1,
					Entry<Character, Integer> o2) {
				return o2.getValue().compareTo(o1.getValue());
			}
		});
		return mapList;
	}
}

```

#### å‡¯æ’’åŠ è§£å¯†KaiserDemo

```java
package com.atguigu.kaiser;

/**
 *       å‡¯æ’’åŠ å¯†
 */
public class KaiserDemo {
    public static void main(String[] args) {
        // å®šä¹‰åŸæ–‡
        String input = "Hello World";
        // æŠŠåŸæ–‡å³è¾¹ç§»åŠ¨3ä½
        int key = 3;
        // å‡¯æ’’åŠ å¯†
        String s = encrypt(input,key);
        System.out.println("åŠ å¯†==" + s);
        String s1 = decrypt(s,key);
        System.out.println("æ˜æ–‡=="+s1);
    }

    /**
     * è§£å¯†
     * @param s å¯†æ–‡
     * @param key å¯†é’¥
     * @return
     */
    public static String decrypt(String s, int key) {
        char[] chars = s.toCharArray();
        StringBuilder sb = new StringBuilder();
        for (char aChar : chars) {
            int b = aChar;
            // åç§»æ•°æ®
            b -= key;
            char newb = (char) b;
            sb.append(newb);
        }
        return sb.toString();
    }

    /**
     * åŠ å¯†
     * @param input åŸæ–‡
     * @return
     */
    public static String encrypt(String input,int key) {
        // æŠ½å–å¿«æ·é”® ctrl + alt + m
        // æŠŠå­—ç¬¦ä¸²å˜æˆå­—èŠ‚æ•°ç»„
        char[] chars = input.toCharArray();
        StringBuilder sb = new StringBuilder();
        for (char aChar : chars) {
            int b = aChar;
            // å¾€å³è¾¹ç§»åŠ¨3ä½
            b = b + key;
            char newb = (char) b;
            sb.append(newb);
        }
//        System.out.println("å¯†æ–‡==="+sb.toString());
        return sb.toString();
    }
}
```



## 1.5 Byte å’Œ bit

Byte : å­—èŠ‚. æ•°æ®å­˜å‚¨çš„åŸºæœ¬å•ä½ï¼Œæ¯”å¦‚ç§»åŠ¨ç¡¬ç›˜ 1T ï¼Œ å•ä½æ˜¯ byte

bit : æ¯”ç‰¹, åˆå«ä½. ä¸€ä¸ªä½è¦ä¹ˆæ˜¯ 0 è¦ä¹ˆæ˜¯ 1. æ•°æ®ä¼ è¾“çš„å•ä½ , æ¯”å¦‚å®¶é‡Œçš„å®½å¸¦ 100MBï¼Œä¸‹è½½é€Ÿåº¦å¹¶æ²¡æœ‰è¾¾åˆ° 100MBï¼Œä¸€èˆ¬éƒ½æ˜¯ 12-13MBï¼Œé‚£ä¹ˆæ˜¯å› ä¸ºéœ€è¦ä½¿ç”¨ 100 / 8

å…³ç³»: 1Byte = 8bit

#### 1.5.1 è·å–å­—ç¬¦ä¸² byte

```java
package com.atguigu.bytebit;

/**
 * ByteBit
 */
public class ByteBit {
    public static void main(String[] args) {
        String a = "a";
        byte[] bytes = a.getBytes();
        for (byte b : bytes) {
            int c=b;
            // æ‰“å°å‘ç°byteå®é™…ä¸Šå°±æ˜¯asciiç 
            System.out.println(c);
        }
    }
}
```

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030558-648265198.jpg)

#### 1.5.2 byte å¯¹åº” bit

```java
package com.atguigu.bytebit;

/**
 * ByteBit
 */
public class ByteBit {
    public static void main(String[] args) {
        String a = "a";
        byte[] bytes = a.getBytes();
        for (byte b : bytes) {
            int c=b;
            // æ‰“å°å‘ç°byteå®é™…ä¸Šå°±æ˜¯asciiç 
            System.out.println(c);
            // æˆ‘ä»¬åœ¨æ¥çœ‹çœ‹æ¯ä¸ªbyteå¯¹åº”çš„bitï¼Œbyteè·å–å¯¹åº”çš„bit
            String s = Integer.toBinaryString(c);
            System.out.println(s);
        }
    }
}
```

è¿è¡Œç¨‹åº

æ‰“å°å‡ºæ¥åº”è¯¥æ˜¯ 8 ä¸ª bitï¼Œä½†å‰é¢æ˜¯ 0ï¼Œæ²¡æœ‰æ‰“å° ï¼Œä»æ‰“å°ç»“æœå¯ä»¥çœ‹å‡ºæ¥ï¼Œä¸€ä¸ªè‹±æ–‡å­—ç¬¦ ï¼Œå ä¸€ä¸ªå­—èŠ‚

![](./images/å¯†ç å­¦/2957590-20230131080030722-1712102678.jpg)

#### 1.5.3 ä¸­æ–‡å¯¹åº”çš„å­—èŠ‚

```java
// ä¸­æ–‡åœ¨GBKç¼–ç ä¸‹, å æ®2ä¸ªå­—èŠ‚
// ä¸­æ–‡åœ¨UTF-8ç¼–ç ä¸‹, å æ®3ä¸ªå­—èŠ‚
package com.atguigu;

public class ByteBitDemo {
    public static void main(String[] args) throws Exception{

        String a = "å°š";
        byte[] bytes = a.getBytes();
        for (byte b : bytes) {
            System.out.print(b + "   ");
            String s = Integer.toBinaryString(b);
            System.out.println(s);
        }
    }
}
```

è¿è¡Œç¨‹åºï¼šæˆ‘ä»¬å‘ç°ä¸€ä¸ªä¸­æ–‡æ˜¯æœ‰ 3 ä¸ªå­—èŠ‚ç»„æˆ

![](./images/å¯†ç å­¦/2957590-20230131080030721-513693392.jpg)

æˆ‘ä»¬ä¿®æ”¹ ç¼–ç æ ¼å¼ , ç¼–ç æ ¼å¼æ”¹æˆ GBK ï¼Œæˆ‘ä»¬åœ¨è¿è¡Œå‘ç°å˜æˆäº† 2 ä¸ªå­—èŠ‚

```java
public static void main(String[] args) throws Exception{

        String a = "å°š";

        // åœ¨ä¸­æ–‡æƒ…å†µä¸‹ï¼Œä¸åŒçš„ç¼–ç æ ¼å¼ï¼Œå¯¹åº”ä¸åŒçš„å­—èŠ‚
       //GBK :ç¼–ç æ ¼å¼å 2ä¸ªå­—èŠ‚
       // UTF-8ï¼šç¼–ç æ ¼å¼å 3ä¸ªå­—èŠ‚
        byte[] bytes = a.getBytes("GBK");
       // byte[] bytes = a.getBytes("UTF-8");
        for (byte b : bytes) {
            System.out.print(b + "   ");
            String s = Integer.toBinaryString(b);
            System.out.println(s);
        }
    }
```

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030708-423378363.jpg)

#### 1.5.4 è‹±æ–‡å¯¹åº”çš„å­—èŠ‚

æˆ‘ä»¬åœ¨çœ‹çœ‹è‹±æ–‡ï¼Œåœ¨ä¸åŒçš„ç¼–ç æ ¼å¼éƒ½æ˜¯å¯¹åº”1ä¸ªå­—èŠ‚

```java
package com.atguigu.bytebit;

public class ByteBit {
    public static void main(String[] args) throws Exception{

        String a = "A";
        byte[] bytes = a.getBytes();
        // åœ¨ä¸­æ–‡æƒ…å†µä¸‹ï¼Œä¸åŒçš„ç¼–ç æ ¼å¼ï¼Œå¯¹åº”ä¸åŒçš„å­—èŠ‚
//        byte[] bytes = a.getBytes("GBK");
        for (byte b : bytes) {
            System.out.print(b + "   ");
            String s = Integer.toBinaryString(b);
            System.out.println(s);
        }
    }
}
```

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030694-703294930.jpg)

## 1.6 å¸¸è§åŠ å¯†æ–¹å¼

![](./images/å¯†ç å­¦/2957590-20230131080030724-1793684630.jpg)

#### 1.6.1 å¯¹ç§°åŠ å¯†

* é‡‡ç”¨å•é’¥å¯†ç ç³»ç»Ÿçš„åŠ å¯†æ–¹æ³•ï¼Œ**åŒä¸€ä¸ªå¯†é’¥å¯ä»¥åŒæ—¶ç”¨ä½œä¿¡æ¯çš„åŠ å¯†å’Œè§£å¯†**ï¼Œè¿™ç§åŠ å¯†æ–¹æ³•ç§°ä¸ºå¯¹ç§°åŠ å¯†ï¼Œä¹Ÿç§°ä¸ºå•å¯†é’¥åŠ å¯†ã€‚

  

**ç¤ºä¾‹**

> *   æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªåŸæ–‡ 3 è¦å‘é€ç»™ B
> *   è®¾ç½®å¯†é’¥ä¸º 108, 3 * 108 = 324, å°† 324 ä½œä¸ºå¯†æ–‡å‘é€ç»™ B
> *   B æ‹¿åˆ°å¯†æ–‡ 324 å, ä½¿ç”¨ 324/108 = 3 å¾—åˆ°åŸæ–‡



**ä¸¤ç§å¸¸è§çš„åŠ å¯†æ–¹å¼ï¼š**

1. **æµåŠ å¯†ï¼ˆStream Cipherï¼‰**
   æµåŠ å¯†çš„åŸºæœ¬æ€æƒ³æ˜¯å°†æ˜æ–‡ä¸­çš„æ¯ä¸ªæ¯”ç‰¹æˆ–å­—èŠ‚ä½œä¸ºå•ç‹¬çš„å•ä½è¿›è¡ŒåŠ å¯†ã€‚å®ƒé€šå¸¸ä½¿ç”¨ä¸€ä¸ªä¼ªéšæœºç”Ÿæˆå™¨æ¥ç”Ÿæˆå¯†é’¥æµï¼Œç„¶åå°†å¯†é’¥æµä¸æ˜æ–‡æŒ‰ä½ï¼ˆæˆ–å­—èŠ‚ï¼‰è¿›è¡Œå¼‚æˆ–æ“ä½œã€‚æµåŠ å¯†çš„ä¼˜ç‚¹æ˜¯åŠ å¯†é€Ÿåº¦è¾ƒå¿«ï¼Œé€‚åˆäºå®æ—¶æ•°æ®æµçš„åŠ å¯†ï¼Œå¦‚è§†é¢‘æµã€éŸ³é¢‘æµç­‰ã€‚
   æµåŠ å¯†çš„å…¸å‹ä¾‹å­æ˜¯**RC4**ã€‚

2. **å—åŠ å¯†ï¼ˆBlock Cipherï¼‰**
   å—åŠ å¯†åˆ™å°†æ˜æ–‡æŒ‰å›ºå®šå¤§å°çš„å—è¿›è¡Œåˆ†å‰²ï¼Œç„¶åå¯¹æ¯ä¸ªå—è¿›è¡ŒåŠ å¯†ã€‚å¸¸è§çš„å—åŠ å¯†ç®—æ³•åŒ…æ‹¬**AES**ã€**DES**ç­‰ã€‚å—åŠ å¯†çš„ç‰¹ç‚¹æ˜¯åŠ å¯†å’Œè§£å¯†çš„è¿‡ç¨‹ç›¸å¯¹å¤æ‚ï¼Œä½†å®‰å…¨æ€§é€šå¸¸è¾ƒé«˜ã€‚å®ƒé€šè¿‡å¤šè½®çš„åŠ å¯†æ“ä½œï¼Œç¡®ä¿æ¯ä¸ªå—éƒ½èƒ½è¢«æœ‰æ•ˆåœ°åŠ å¯†ã€‚
   å—åŠ å¯†åœ¨æ•°æ®ä¼ è¾“æˆ–å­˜å‚¨ä¸­éå¸¸å¸¸è§ï¼Œç‰¹åˆ«æ˜¯åœ¨æ–‡ä»¶åŠ å¯†å’Œç£ç›˜åŠ å¯†ä¸­ã€‚

è¿™ä¸¤è€…çš„é€‰æ‹©é€šå¸¸å–å†³äºåº”ç”¨åœºæ™¯ï¼šæµåŠ å¯†é€‚åˆé«˜é€Ÿæ•°æ®æµçš„åŠ å¯†ï¼Œè€Œå—åŠ å¯†åˆ™åœ¨æ›´å¤æ‚çš„åº”ç”¨ä¸­ä½¿ç”¨ã€‚



* **å¸¸è§åŠ å¯†ç®—æ³•**

  *   DES : Data Encryption Standardï¼Œå³æ•°æ®åŠ å¯†æ ‡å‡†ï¼Œæ˜¯ä¸€ç§ä½¿ç”¨å¯†é’¥åŠ å¯†çš„å—ç®—æ³•ï¼Œ1977 å¹´è¢«ç¾å›½è”é‚¦æ”¿åºœçš„å›½å®¶æ ‡å‡†å±€ç¡®å®šä¸ºè”é‚¦èµ„æ–™å¤„ç†æ ‡å‡†ï¼ˆFIPSï¼‰ï¼Œå¹¶æˆæƒåœ¨éå¯†çº§æ”¿åºœé€šä¿¡ä¸­ä½¿ç”¨ï¼Œéšåè¯¥ç®—æ³•åœ¨å›½é™…ä¸Šå¹¿æ³›æµä¼ å¼€æ¥ã€‚
  *   AES : Advanced Encryption Standard, é«˜çº§åŠ å¯†æ ‡å‡† . åœ¨å¯†ç å­¦ä¸­åˆç§° Rijndael åŠ å¯†æ³•ï¼Œæ˜¯ç¾å›½è”é‚¦æ”¿åºœé‡‡ç”¨çš„ä¸€ç§åŒºå—åŠ å¯†æ ‡å‡†ã€‚è¿™ä¸ªæ ‡å‡†ç”¨æ¥æ›¿ä»£åŸå…ˆçš„ DESï¼Œå·²ç»è¢«å¤šæ–¹åˆ†æä¸”å¹¿ä¸ºå…¨ä¸–ç•Œæ‰€ä½¿ç”¨ã€‚

* **ç‰¹ç‚¹**

  * åŠ å¯†é€Ÿåº¦å¿«, å¯ä»¥åŠ å¯†å¤§æ–‡ä»¶

  * å¯†æ–‡å¯é€†, ä¸€æ—¦å¯†é’¥æ–‡ä»¶æ³„æ¼, å°±ä¼šå¯¼è‡´æ•°æ®æš´éœ²

  * åŠ å¯†åç¼–ç è¡¨æ‰¾ä¸åˆ°å¯¹åº”å­—ç¬¦, å‡ºç°ä¹±ç ï¼Œä¸€èˆ¬ç»“åˆ Base64 ä½¿ç”¨

    

#### 1.6.2 DES åŠ å¯†

ç¤ºä¾‹ä»£ç  des åŠ å¯†ç®—æ³•

Cipher ï¼šæ–‡æ¡£Â `https://docs.oracle.com/javase/8/docs/api/javax/crypto/Cipher.html#getInstance-java.lang.String-`

```java
package com.atguigu.desaes;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;


public class DesAesDemo {
    public static void main(String[] args) throws Exception{
        // åŸæ–‡
        String input = "ç¡…è°·";
        // desåŠ å¯†å¿…é¡»æ˜¯8ä½
        String key = "123456";
        // ç®—æ³•
        String algorithm = "DES";

      
        // æŒ‡å®šè·å–Cipherçš„ç®—æ³•,å¦‚æœæ²¡æœ‰æŒ‡å®šåŠ å¯†æ¨¡å¼å’Œå¡«å……æ¨¡å¼,å°±æ˜¯é»˜è®¤å€¼ECB/PKCS5Paddingï¼Œå³DES/ECB/PKCS5Padding
        String transformation = "DES";
          
        // 1ã€Cipherï¼šå¯†ç ï¼Œè·å–åŠ å¯†å¯¹è±¡ 
        Cipher cipher = Cipher.getInstance(transformation);
        // 2ã€æŒ‡å®šç§˜é’¥è§„åˆ™
        // ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºï¼šå¯†é’¥ï¼Œkeyçš„å­—èŠ‚æ•°ç»„
        // ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºï¼šç®—æ³•
        SecretKeySpec sks = new SecretKeySpec(key.getBytes(), algorithm);
        // 3ã€å¯¹åŠ å¯†è¿›è¡Œåˆå§‹åŒ–
        // ç¬¬ä¸€ä¸ªå‚æ•°ï¼šè¡¨ç¤ºæ¨¡å¼ï¼Œæœ‰åŠ å¯†æ¨¡å¼å’Œè§£å¯†æ¨¡å¼
        // ç¬¬äºŒä¸ªå‚æ•°ï¼šè¡¨ç¤ºç§˜é’¥è§„åˆ™
        cipher.init(Cipher.ENCRYPT_MODE,sks);
        // 4ã€è¿›è¡ŒåŠ å¯†
        byte[] bytes = cipher.doFinal(input.getBytes());
        // æ‰“å°å­—èŠ‚ï¼Œå› ä¸ºasciiç æœ‰è´Ÿæ•°ï¼Œè§£æä¸å‡ºæ¥ï¼Œæ‰€ä»¥ä¹±ç 
//        for (byte b : bytes) {
//            System.out.println(b);
//        }
        // 5ã€æ‰“å°å¯†æ–‡
        System.out.println(new String(bytes));
    }
}
```

è¿è¡Œï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030778-2040320242.jpg)

ä¿®æ”¹ å¯†é’¥ key = â€œ12345678â€ ï¼Œå†æ¬¡è¿è¡Œ ï¼Œå‡ºç°ä¹±ç æ˜¯å› ä¸ºå¯¹åº”çš„å­—èŠ‚å‡ºç°è´Ÿæ•°ï¼Œä½†è´Ÿæ•°ï¼Œæ²¡æœ‰å‡ºç°åœ¨ ascii ç è¡¨é‡Œé¢ï¼Œæ‰€ä»¥å‡ºç°ä¹±ç ï¼Œéœ€è¦é…åˆ base64 è¿›è¡Œè½¬ç 

![](./images/å¯†ç å­¦/2957590-20230131080030736-576141369.jpg)

ä½¿ç”¨Â `base64`Â è¿›è¡Œç¼–ç 

`base64`Â å¯¼åŒ…çš„æ—¶å€™ï¼Œéœ€è¦æ³¨æ„ ï¼Œåˆ«å¯¼é”™äº†ï¼Œéœ€è¦å¯¼å…¥Â `apache`Â åŒ…

![](./images/å¯†ç å­¦/2957590-20230131080030850-1988244711.jpg)

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030739-172961038.jpg)

#### 1.6.4 DES è§£å¯†

ä½¿ç”¨Â `ctrl + alt + m`Â å¿«æ·é”®æŠ½å–ä»£ç 

```java
package com.atguigu.desaes;

import com.sun.org.apache.xml.internal.security.utils.Base64;

import javax.crypto.Cipher;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

public class DesDemo {
    // DESåŠ å¯†ç®—æ³•,keyçš„å¤§å°å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚

    public static void main(String[] args) throws Exception {
        String input ="ç¡…è°·";
        // DESåŠ å¯†ç®—æ³•ï¼Œkeyçš„å¤§å°å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚
        String key = "12345678";

        String transformation = "DES"; // 9PQXVUIhaaQ=
        // æŒ‡å®šè·å–å¯†é’¥çš„ç®—æ³•
        String algorithm = "DES";
        String encryptDES = encryptDES(input, key, transformation, algorithm);
        System.out.println("åŠ å¯†:" + encryptDES);
        String s = decryptDES(encryptDES, key, transformation, algorithm);
        System.out.println("è§£å¯†:" + s);

    }

    /**
     * ä½¿ç”¨DESåŠ å¯†æ•°æ®
     *
     * @param input          : åŸæ–‡
     * @param key            : å¯†é’¥(DES,å¯†é’¥çš„é•¿åº¦å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚)
     * @param transformation : è·å–Cipherå¯¹è±¡çš„ç®—æ³•
     * @param algorithm      : è·å–å¯†é’¥çš„ç®—æ³•
     * @return : å¯†æ–‡
      * @throws Exception
      */
    private static String encryptDES(String input, String key, String transformation, String algorithm) throws Exception {
        // è·å–åŠ å¯†å¯¹è±¡
        Cipher cipher = Cipher.getInstance(transformation);
        // åˆ›å»ºåŠ å¯†è§„åˆ™
        // ç¬¬ä¸€ä¸ªå‚æ•°keyçš„å­—èŠ‚
        // ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        SecretKeySpec sks = new SecretKeySpec(key.getBytes(), algorithm);
        // ENCRYPT_MODEï¼šåŠ å¯†æ¨¡å¼
        // DECRYPT_MODE: è§£å¯†æ¨¡å¼
        // åˆå§‹åŒ–åŠ å¯†æ¨¡å¼å’Œç®—æ³•
        cipher.init(Cipher.ENCRYPT_MODE,sks);
        // åŠ å¯†
        byte[] bytes = cipher.doFinal(input.getBytes());

        // base64è¾“å‡ºåŠ å¯†åçš„æ•°æ®
        String encode = Base64.encode(bytes);

         return encode;
     }

    /**
     * ä½¿ç”¨DESè§£å¯†
     *
     * @param input          : å¯†æ–‡
     * @param key            : å¯†é’¥
     * @param transformation : è·å–Cipherå¯¹è±¡çš„ç®—æ³•
     * @param algorithm      : è·å–å¯†é’¥çš„ç®—æ³•
     * @throws Exception
     * @return: åŸæ–‡
     */
    private static String decryptDES(String input, String key, String transformation, String algorithm) throws Exception {
        // 1,è·å–Cipherå¯¹è±¡
        Cipher cipher = Cipher.getInstance(transformation);
        // æŒ‡å®šå¯†é’¥è§„åˆ™
        SecretKeySpec sks = new SecretKeySpec(key.getBytes(), algorithm);
        cipher.init(Cipher.DECRYPT_MODE, sks);
        // 3. è§£å¯†ï¼Œä¸Šé¢ä½¿ç”¨çš„base64ç¼–ç ï¼Œä¸‹é¢ç›´æ¥ç”¨å¯†æ–‡
        byte[] bytes = cipher.doFinal(Base64.decode(input));
        //  å› ä¸ºæ˜¯æ˜æ–‡ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›
        return new String(bytes);
    }
}
```

è¿è¡Œç¨‹åºï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030736-932562726.jpg)

#### 1.6.4  Base64  å¯è¯»æ€§ç¼–ç ç®—æ³•

##### Base64 ç®—æ³•ç®€ä»‹

Base64æ˜¯ç½‘ç»œä¸Šæœ€å¸¸è§çš„ç”¨äºä¼ è¾“8Bitå­—èŠ‚ç çš„**å¯è¯»æ€§ç¼–ç ç®—æ³•**ä¹‹ä¸€ï¼Œä¸æ˜¯åŠ å¯†ç®—æ³•
**å¯è¯»æ€§ç¼–ç ç®—æ³•ä¸æ˜¯ä¸ºäº†ä¿æŠ¤æ•°æ®çš„å®‰å…¨æ€§ï¼Œè€Œæ˜¯ä¸ºäº†å¯è¯»æ€§**
å¯è¯»æ€§ç¼–ç ä¸æ”¹å˜ä¿¡æ¯å†…å®¹ï¼Œåªæ”¹å˜ä¿¡æ¯å†…å®¹çš„è¡¨ç°å½¢å¼



æ‰€è°“Base64ï¼Œå³æ˜¯è¯´åœ¨ç¼–ç è¿‡ç¨‹ä¸­ä½¿ç”¨äº†64ç§å­—ç¬¦ï¼šå¤§å†™Aåˆ°Zã€å°å†™aåˆ°zã€æ•°å­—0åˆ°9ã€â€œ+â€å’Œâ€œ/â€
Base58æ˜¯Bitcoin(æ¯”ç‰¹å¸)ä¸­ä½¿ç”¨çš„ä¸€ç§ç¼–ç æ–¹å¼ï¼Œä¸»è¦ç”¨äºäº§ç”ŸBitcoinçš„é’±åŒ…åœ°å€
ç›¸æ¯”Base64ï¼ŒBase58ä¸ä½¿ç”¨æ•°å­—"0"ï¼Œå­—æ¯å¤§å†™"O"ï¼Œå­—æ¯å¤§å†™"I"ï¼Œå’Œå­—æ¯å°å†™"i"ï¼Œä»¥åŠ"+"å’Œ"/"ç¬¦å·



##### Base64 ç®—æ³•åŸç†

base64 æ˜¯ 3 ä¸ªå­—èŠ‚ä¸ºä¸€ç»„ï¼Œä¸€ä¸ªå­—èŠ‚ 8 ä½ï¼Œä¸€å…± å°±æ˜¯ 24 ä½ ï¼Œç„¶åï¼ŒæŠŠ 3 ä¸ªå­—èŠ‚è½¬æˆ 4 ç»„ï¼Œæ¯ç»„ 6 ä½ï¼Œ

3 * 8 = 4 * 6 = 24 ï¼Œæ¯ç»„ 6 ä½ï¼Œç¼ºå°‘çš„ 2 ä½ï¼Œä¼šåœ¨é«˜ä½è¿›è¡Œè¡¥ 0 ï¼Œè¿™æ ·åšçš„å¥½å¤„åœ¨äº ï¼Œbase å–çš„æ˜¯åé¢ 6 ä½ï¼Œå»æ‰é«˜ 2 ä½ ï¼Œé‚£ä¹ˆ base64 çš„å–å€¼å°±å¯ä»¥æ§åˆ¶åœ¨ 0-63ä¹‹é—´ ï¼Œæ‰€ä»¥å°±å« base64ï¼Œ11 1111 = 32 + 16 + 8 + 4 + 2 + 1 =63

![](./images/å¯†ç å­¦/2957590-20230131080030820-792251852.jpg)

##### base64 æ„æˆåŸåˆ™

â‘  å°å†™ a - z = 26 ä¸ªå­—æ¯

â‘¡ å¤§å†™ A - Z = 26 ä¸ªå­—æ¯

â‘¢ æ•°å­— 0 - 9 = 10 ä¸ªæ•°å­—

â‘£ + / = 2 ä¸ªç¬¦å·

å¤§å®¶å¯èƒ½å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå’±ä»¬çš„ base64 æœ‰ä¸ª = å·ï¼Œä½†æ˜¯åœ¨æ˜ å°„è¡¨é‡Œé¢æ²¡æœ‰å‘ç° = å· ï¼Œ è¿™ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ï¼Œç­‰å·éå¸¸ç‰¹æ®Šï¼Œå› ä¸º base64 æ˜¯ä¸‰ä¸ªå­—èŠ‚ä¸€ç»„ ï¼Œå¦‚æœå½“æˆ‘ä»¬çš„ä½æ•°ä¸å¤Ÿçš„æ—¶å€™ï¼Œä¼šä½¿ç”¨ç­‰å·æ¥è¡¥é½



##### base64 è¡¥ç­‰å·æµ‹è¯•

åœ¨ Base64 ç¼–ç ä¸­ï¼Œæœ«å°¾çš„ç­‰å· `=` æ˜¯ç”¨äº**å¡«å……ï¼ˆpaddingï¼‰**çš„ï¼Œå®ƒçš„ä½œç”¨æ˜¯è®©æœ€ç»ˆçš„ Base64 å­—ç¬¦ä¸²é•¿åº¦ä¿æŒä¸º 4 çš„å€æ•°ã€‚ä¸‹é¢æ˜¯å…³äº Base64 è¡¥ç­‰å·çš„æµ‹è¯•è¯´æ˜ä¸ç¤ºä¾‹ã€‚

ğŸ“˜ è¡¥ç­‰å·è§„åˆ™

Base64 æ¯ 3 å­—èŠ‚ç¼–ç ä¸º 4 ä¸ªå­—ç¬¦ï¼š

| åŸå§‹å­—èŠ‚æ•°  | ç¼–ç åå­—ç¬¦æ•° | è¡¥ `=` çš„æ•°é‡ |
| ----------- | ------------ | ------------- |
| 3 çš„å€æ•°    | 4 çš„å€æ•°     | 0             |
| ä½™ 1 ä¸ªå­—èŠ‚ | 4 ä¸ªå­—ç¬¦     | 2 ä¸ª `=`      |
| ä½™ 2 ä¸ªå­—èŠ‚ | 4 ä¸ªå­—ç¬¦     | 1 ä¸ª `=`      |

```java
package com.atguigu;

import com.sun.org.apache.xml.internal.security.utils.Base64;


public class TestBase64 {
    public static void main(String[] args) {
       //  1ï¼šMQ== è¡¨ç¤ºä¸€ä¸ªå­—èŠ‚ï¼Œä¸å¤Ÿä¸‰ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥éœ€è¦åé¢é€šè¿‡ == å·è¡¥é½
       System.out.println(Base64.encode("1".getBytes())); // MQ==
       System.out.println(Base64.encode("12".getBytes())); //MTI=
       System.out.println(Base64.encode("123".getBytes())); // MTIz
        
       // ç¡…è°·:ä¸­æ–‡å 6ä¸ªå­—èŠ‚ï¼Œ6 * 8 = 48 ï¼Œåˆšåˆšå¥½è¢«æ•´é™¤ï¼Œæ‰€ä»¥æ²¡æœ‰ç­‰å·
       System.out.println(Base64.encode("ç¡…è°·".getBytes()));//56GF6LC3
    }
}
```

è¿è¡Œï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030591-464295381.jpg)

#### 1.6.5 AES åŠ å¯†è§£å¯†

`AES`Â åŠ å¯†è§£å¯†å’ŒÂ `DES`Â åŠ å¯†è§£å¯†ä»£ç ä¸€æ ·ï¼Œåªéœ€è¦ä¿®æ”¹åŠ å¯†ç®—æ³•å°±è¡Œï¼Œæ‹·è´Â `ESC`Â ä»£ç 

```java
package com.atguigu.desaes;
import com.sun.org.apache.xml.internal.security.utils.Base64;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;

public class AesDemo {
    // DESåŠ å¯†ç®—æ³•,keyçš„å¤§å°å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚

    public static void main(String[] args) throws Exception {
        String input ="ç¡…è°·";
        // AESåŠ å¯†ç®—æ³•ï¼Œæ¯”è¾ƒé«˜çº§ï¼Œæ‰€ä»¥keyçš„å¤§å°å¿…é¡»æ˜¯16ä¸ªå­—èŠ‚
        String key = "1234567812345678";

        String transformation = "AES"; // 9PQXVUIhaaQ=
        // æŒ‡å®šè·å–å¯†é’¥çš„ç®—æ³•
        String algorithm = "AES";
        // å…ˆæµ‹è¯•åŠ å¯†ï¼Œç„¶ååœ¨æµ‹è¯•è§£å¯†
        String encryptDES = encryptDES(input, key, transformation, algorithm);
        System.out.println("åŠ å¯†:" + encryptDES);
        String s = dncryptDES(encryptDES, key, transformation, algorithm);
        System.out.println("è§£å¯†:" + s);

    }

    /**
     * ä½¿ç”¨DESåŠ å¯†æ•°æ®
     *
     * @param input          : åŸæ–‡
     * @param key            : å¯†é’¥(DES,å¯†é’¥çš„é•¿åº¦å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚)
     * @param transformation : è·å–Cipherå¯¹è±¡çš„ç®—æ³•
     * @param algorithm      : è·å–å¯†é’¥çš„ç®—æ³•
     * @return : å¯†æ–‡
     * @throws Exception
     */
    private static String encryptDES(String input, String key, String transformation, String algorithm) throws Exception {
        // è·å–åŠ å¯†å¯¹è±¡
        Cipher cipher = Cipher.getInstance(transformation);
        // åˆ›å»ºåŠ å¯†è§„åˆ™
        // ç¬¬ä¸€ä¸ªå‚æ•°keyçš„å­—èŠ‚
        // ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        SecretKeySpec sks = new SecretKeySpec(key.getBytes(), algorithm);
        // ENCRYPT_MODEï¼šåŠ å¯†æ¨¡å¼
        // DECRYPT_MODE: è§£å¯†æ¨¡å¼
        // åˆå§‹åŒ–åŠ å¯†æ¨¡å¼å’Œç®—æ³•
        cipher.init(Cipher.ENCRYPT_MODE,sks);
        // åŠ å¯†
        byte[] bytes = cipher.doFinal(input.getBytes());

        // è¾“å‡ºåŠ å¯†åçš„æ•°æ®
        String encode = Base64.encode(bytes);

        return encode;
    }

    /**
     * ä½¿ç”¨DESè§£å¯†
     *
     * @param input          : å¯†æ–‡
     * @param key            : å¯†é’¥
     * @param transformation : è·å–Cipherå¯¹è±¡çš„ç®—æ³•
     * @param algorithm      : è·å–å¯†é’¥çš„ç®—æ³•
     * @throws Exception
     * @return: åŸæ–‡
     */
    private static String dncryptDES(String input, String key, String transformation, String algorithm) throws Exception {
        // 1,è·å–Cipherå¯¹è±¡
        Cipher cipher = Cipher.getInstance(transformation);
        // æŒ‡å®šå¯†é’¥è§„åˆ™
        SecretKeySpec sks = new SecretKeySpec(key.getBytes(), algorithm);
        cipher.init(Cipher.DECRYPT_MODE, sks);
        // 3. è§£å¯†
        byte[] bytes = cipher.doFinal(Base64.decode(input));

        return new String(bytes);
    }
}
```

è¿è¡Œç¨‹åºï¼šAES åŠ å¯†çš„å¯†é’¥ key ï¼Œ éœ€è¦ä¼ å…¥ 16 ä¸ªå­—èŠ‚

![](./images/å¯†ç å­¦/2957590-20230131080030785-289090258.jpg)

åœ¨è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030748-912311872.jpg)

#### 1.6.6 toString() ä¸ new String () ç”¨æ³•åŒºåˆ«

ä¸¾ä¾‹å­

```java
package com.atguigu;


import com.sun.org.apache.xerces.internal.impl.dv.util.Base64;


public class TestBase64 {
    public static void main(String[] args) {
        // baseç¼–ç å­—ç¬¦ä¸²
        String str="TU0jV0xBTiNVYys5bEdiUjZlNU45aHJ0bTdDQStBPT0jNjQ2NDY1Njk4IzM5OTkwMDAwMzAwMA==";

		// base64è§£ç åbyte[] 
        String rlt1=new String(Base64.decode(str));

        String rlt2=Base64.decode(str).toString();

        System.out.println(rlt1);

        System.out.println(rlt2);
    }
}
```

ç»“æœæ˜¯ï¼š

```
MM#WLAN#Uc+9lGbR6e5N9hrtm7CA+A==#646465698#399900003000

[B@1540e19d
```

> å“ªä¸€ä¸ªæ˜¯æ­£ç¡®çš„ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ

è¿™é‡Œåº”è¯¥ç”¨ new String() çš„æ–¹æ³•ï¼Œå› ä¸º Base64 åŠ è§£å¯†æ˜¯ä¸€ç§è½¬æ¢ç¼–ç æ ¼å¼çš„åŸç†

> toString() ä¸ new String () ç”¨æ³•åŒºåˆ«

`str.toString` æ˜¯è°ƒç”¨äº†è¿™ä¸ª object å¯¹è±¡çš„ç±»çš„ toString æ–¹æ³•ã€‚ä¸€èˆ¬æ˜¯è¿”å›è¿™ä¹ˆä¸€ä¸ª `Stringï¼š[class name]@[hashCode]`

`new String(str)` æ˜¯æ ¹æ® parameter æ˜¯ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œä½¿ç”¨ java è™šæ‹Ÿæœºé»˜è®¤çš„ç¼–ç æ ¼å¼ï¼Œå°†è¿™ä¸ªå­—èŠ‚æ•°ç»„ decode ä¸ºå¯¹åº”çš„å­—ç¬¦ã€‚è‹¥è™šæ‹Ÿæœºé»˜è®¤çš„ç¼–ç æ ¼å¼æ˜¯ ISO-8859-1ï¼ŒæŒ‰ç…§ ascii ç¼–ç è¡¨å³å¯å¾—åˆ°å­—èŠ‚å¯¹åº”çš„å­—ç¬¦ã€‚

> ä»€ä¹ˆæ—¶å€™ç”¨ä»€ä¹ˆæ–¹æ³•å‘¢ï¼Ÿ

`new Stringï¼ˆï¼‰`ä¸€èˆ¬ä½¿ç”¨å­—ç¬¦è½¬ç çš„æ—¶å€™, byte [] æ•°ç»„çš„æ—¶å€™

`toStringï¼ˆï¼‰`å¯¹è±¡æ‰“å°çš„æ—¶å€™ä½¿ç”¨

## 1.7 åŠ å¯†æ¨¡å¼

```
  Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
  AES/CBC/PKCS5Padding
  ç®—æ³•/æ¨¡å¼/å¡«å……
```



åŠ å¯†æ¨¡å¼ï¼š`https://docs.oracle.com/javase/8/docs/api/javax/crypto/Cipher.html`

#### ECB

ECB : Electronic codebook, ç”µå­å¯†ç æœ¬. éœ€è¦åŠ å¯†çš„æ¶ˆæ¯æŒ‰ç…§å—å¯†ç çš„å—å¤§å°è¢«åˆ†ä¸ºæ•°ä¸ªå—ï¼Œå¹¶å¯¹æ¯ä¸ªå—è¿›è¡Œç‹¬ç«‹åŠ å¯†

![](./images/å¯†ç å­¦/2957590-20230131080030729-603572319.jpg)

*   ä¼˜ç‚¹ : å¯ä»¥å¹¶è¡Œå¤„ç†æ•°æ®
*   ç¼ºç‚¹ : åŒæ ·çš„åŸæ–‡ç”ŸæˆåŒæ ·çš„å¯†æ–‡, ä¸èƒ½å¾ˆå¥½çš„ä¿æŠ¤æ•°æ®
*   åŒæ—¶åŠ å¯†ï¼ŒåŸæ–‡æ˜¯ä¸€æ ·çš„ï¼ŒåŠ å¯†å‡ºæ¥çš„å¯†æ–‡ä¹Ÿæ˜¯ä¸€æ ·çš„

#### CBC

CBC : Cipher-block chaining, å¯†ç å—é“¾æ¥. æ¯ä¸ªæ˜æ–‡å—å…ˆä¸å‰ä¸€ä¸ªå¯†æ–‡å—è¿›è¡Œå¼‚æˆ–åï¼Œå†è¿›è¡ŒåŠ å¯†ã€‚åœ¨è¿™ç§æ–¹æ³•ä¸­ï¼Œæ¯ä¸ªå¯†æ–‡å—éƒ½ä¾èµ–äºå®ƒå‰é¢çš„æ‰€æœ‰æ˜æ–‡å—

![](./images/å¯†ç å­¦/2957590-20230131080030656-1110789758.jpg)

*   ä¼˜ç‚¹ : åŒæ ·çš„åŸæ–‡ç”Ÿæˆçš„å¯†æ–‡ä¸ä¸€æ ·
*   ç¼ºç‚¹ : ä¸²è¡Œå¤„ç†æ•°æ®.

## 1.8 å¡«å……æ¨¡å¼

*   å½“éœ€è¦æŒ‰å—å¤„ç†çš„æ•°æ®, æ•°æ®é•¿åº¦ä¸ç¬¦åˆå—å¤„ç†éœ€æ±‚æ—¶, æŒ‰ç…§ä¸€å®šçš„æ–¹æ³•å¡«å……æ»¡å—é•¿çš„è§„åˆ™

#### NoPadding

*   ä¸å¡«å…….
*   åœ¨ DES åŠ å¯†ç®—æ³•ä¸‹, è¦æ±‚åŸæ–‡é•¿åº¦å¿…é¡»æ˜¯ 8byte çš„æ•´æ•°å€
*   åœ¨ AES åŠ å¯†ç®—æ³•ä¸‹, è¦æ±‚åŸæ–‡é•¿åº¦å¿…é¡»æ˜¯ 16byte çš„æ•´æ•°å€

#### PKCS5Padding

æ•°æ®å—çš„å¤§å°ä¸º 8 ä½, ä¸å¤Ÿå°±è¡¥è¶³

#### Tips

*   é»˜è®¤æƒ…å†µä¸‹, åŠ å¯†æ¨¡å¼å’Œå¡«å……æ¨¡å¼ä¸º : `ECB/PKCS5Padding`
*   å¦‚æœä½¿ç”¨ CBC æ¨¡å¼, åœ¨åˆå§‹åŒ– Cipher å¯¹è±¡æ—¶, éœ€è¦å¢åŠ å‚æ•°, åˆå§‹åŒ–å‘é‡ IV : `IvParameterSpec iv = new IvParameterSpec(key.getBytes());`

åŠ å¯†æ¨¡å¼å’Œå¡«å……æ¨¡å¼

```
AES/CBC/NoPadding (128)
AES/CBC/PKCS5Padding (128)
AES/ECB/NoPadding (128)
AES/ECB/PKCS5Padding (128)
DES/CBC/NoPadding (56)
DES/CBC/PKCS5Padding (56)
DES/ECB/NoPadding (56)
DES/ECB/PKCS5Padding (56)
DESede/CBC/NoPadding (168)
DESede/CBC/PKCS5Padding (168)
DESede/ECB/NoPadding (168)
DESede/ECB/PKCS5Padding (168)
RSA/ECB/PKCS1Padding (1024, 2048)
RSA/ECB/OAEPWithSHA-1AndMGF1Padding (1024, 2048)
RSA/ECB/OAEPWithSHA-256AndMGF1Padding (1024, 2048)
```

#### åŠ å¯†æ¨¡å¼å’Œå¡«å……æ¨¡å¼ä¾‹å­

```java
package com.atguigu.desaes;

import com.sun.org.apache.xml.internal.security.utils.Base64;

import javax.crypto.Cipher;
import javax.crypto.spec.IvParameterSpec;
import javax.crypto.spec.SecretKeySpec;

public class DesDemo {
    // DESåŠ å¯†ç®—æ³•,keyçš„å¤§å°å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚

    public static void main(String[] args) throws Exception {
        String input ="ç¡…è°·";
        // DESåŠ å¯†ç®—æ³•ï¼Œkeyçš„å¤§å°å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚
        String key = "12345678";
        
        // æŒ‡å®šè·å–Cipherçš„ç®—æ³•,å¦‚æœæ²¡æœ‰æŒ‡å®šåŠ å¯†æ¨¡å¼å’Œå¡«å……æ¨¡å¼,ECB/PKCS5Paddingå°±æ˜¯é»˜è®¤å€¼
        //     String transformation = "DES"; // 9PQXVUIhaaQ=
        //String transformation = "DES/ECB/PKCS5Padding"; // 9PQXVUIhaaQ=
        // CBCæ¨¡å¼,å¿…é¡»æŒ‡å®šåˆå§‹å‘é‡,åˆå§‹å‘é‡ä¸­å¯†é’¥çš„é•¿åº¦å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚
        //String transformation = "DES/CBC/PKCS5Padding"; // 9PQXVUIhaaQ=
        // NoPaddingæ¨¡å¼,åŸæ–‡çš„é•¿åº¦å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚çš„æ•´å€æ•° ï¼Œæ‰€ä»¥å¿…é¡»æŠŠ ç¡…è°·æ”¹æˆç¡…è°·12
        String transformation = "DES/CBC/NoPadding"; // 9PQXVUIhaaQ=
        // æŒ‡å®šè·å–å¯†é’¥çš„ç®—æ³•
        String algorithm = "DES";
        String encryptDES = encryptDES(input, key, transformation, algorithm);
        System.out.println("åŠ å¯†:" + encryptDES);
//        String s = dncryptDES(encryptDES, key, transformation, algorithm);
//        System.out.println("è§£å¯†:" + s);

    }

    /**
     * ä½¿ç”¨DESåŠ å¯†æ•°æ®
     *
     * @param input          : åŸæ–‡
     * @param key            : å¯†é’¥(DES,å¯†é’¥çš„é•¿åº¦å¿…é¡»æ˜¯8ä¸ªå­—èŠ‚)
     * @param transformation : è·å–Cipherå¯¹è±¡çš„ç®—æ³•
     * @param algorithm      : è·å–å¯†é’¥çš„ç®—æ³•
     * @return : å¯†æ–‡
     * @throws Exception
     */
    private static String encryptDES(String input, String key, String transformation, String algorithm) throws Exception {
        // è·å–åŠ å¯†å¯¹è±¡
        Cipher cipher = Cipher.getInstance(transformation);
        // åˆ›å»ºåŠ å¯†è§„åˆ™
        // ç¬¬ä¸€ä¸ªå‚æ•°keyçš„å­—èŠ‚
        // ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        SecretKeySpec sks = new SecretKeySpec(key.getBytes(), algorithm);
        // ENCRYPT_MODEï¼šåŠ å¯†æ¨¡å¼
        // DECRYPT_MODE: è§£å¯†æ¨¡å¼
         // åˆå§‹å‘é‡ï¼Œå‚æ•°è¡¨ç¤ºè·Ÿè°è¿›è¡Œå¼‚æˆ–ï¼Œåˆå§‹å‘é‡çš„é•¿åº¦å¿…é¡»æ˜¯8ä½
//        IvParameterSpec iv = new IvParameterSpec(key.getBytes());
        //cipher.init(Cipher.ENCRYPT_MODE,sks,iv);
         // åˆå§‹åŒ–åŠ å¯†æ¨¡å¼å’Œç®—æ³•
        cipher.init(Cipher.ENCRYPT_MODE,sks);
        // åŠ å¯†
        byte[] bytes = cipher.doFinal(input.getBytes());

        // è¾“å‡ºåŠ å¯†åçš„æ•°æ®
        String encode = Base64.encode(bytes);

        return encode;
    }

    /**
     * ä½¿ç”¨DESè§£å¯†
     *
     * @param input          : å¯†æ–‡
     * @param key            : å¯†é’¥
     * @param transformation : è·å–Cipherå¯¹è±¡çš„ç®—æ³•
     * @param algorithm      : è·å–å¯†é’¥çš„ç®—æ³•
     * @throws Exception
     * @return: åŸæ–‡
     */
    private static String dncryptDES(String input, String key, String transformation, String algorithm) throws Exception {
        // 1,è·å–Cipherå¯¹è±¡
        Cipher cipher = Cipher.getInstance(transformation);
        // æŒ‡å®šå¯†é’¥è§„åˆ™
        SecretKeySpec sks = new SecretKeySpec(key.getBytes(), algorithm);
//        IvParameterSpec iv = new IvParameterSpec(key.getBytes());
        //cipher.init(Cipher.ENCRYPT_MODE,sks,iv);
        cipher.init(Cipher.DECRYPT_MODE, sks);
        // 3. è§£å¯†
        byte[] bytes = cipher.doFinal(Base64.decode(input));

        return new String(bytes);
    }
}
```

è¿è¡Œç¨‹åºï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030452-242760424.jpg)

ä¿®æ”¹æˆÂ `CBC`Â åŠ å¯† æ¨¡å¼

```
String transformation = "DES/CBC/PKCS5Padding";
```

è¿è¡Œ ï¼ŒæŠ¥é”™ï¼Œéœ€è¦æ·»åŠ ä¸€ä¸ªå‚æ•°

![](./images/å¯†ç å­¦/2957590-20230131080030750-1165412139.jpg)

ä¿®æ”¹åŠ å¯†ä»£ç ï¼š

![](./images/å¯†ç å­¦/2957590-20230131080031079-598315641.jpg)

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030580-314911177.jpg)

ä¿®æ”¹å¡«å……æ¨¡å¼

```
String transformation = "DES/CBC/NoPadding";
```

è¿è¡ŒæŠ¥é”™Â `NoPadding`Â è¿™ç§å¡«å……æ¨¡å¼ åŸæ–‡å¿…é¡»æ˜¯ 8 ä¸ªå­—èŠ‚çš„æ•´å€æ•°

![](./images/å¯†ç å­¦/2957590-20230131080030767-1523384666.jpg)

ä¿®æ”¹è¿è¡Œ

![](./images/å¯†ç å­¦/2957590-20230131080030842-410009006.jpg)

åœ¨æµ‹è¯•Â `AES`Â çš„æ—¶å€™éœ€è¦æ³¨æ„ï¼Œkey éœ€è¦ 16 ä¸ªå­—èŠ‚ï¼ŒåŠ å¯†å‘é‡ä¹Ÿéœ€è¦ 16 ä¸ªå­—èŠ‚ ï¼Œå…¶ä»–æ–¹å¼è·ŸÂ `DES`Â ä¸€æ ·

## 1.9 æ¶ˆæ¯æ‘˜è¦

*   æ¶ˆæ¯æ‘˜è¦ï¼ˆMessage Digestï¼‰åˆç§°ä¸ºæ•°å­—æ‘˜è¦ (Digital Digest)
*   å®ƒæ˜¯ä¸€ä¸ªå”¯ä¸€å¯¹åº”ä¸€ä¸ªæ¶ˆæ¯æˆ–æ–‡æœ¬çš„å›ºå®šé•¿åº¦çš„å€¼ï¼Œå®ƒç”±ä¸€ä¸ªå•å‘ Hash åŠ å¯†å‡½æ•°å¯¹æ¶ˆæ¯è¿›è¡Œä½œç”¨è€Œäº§ç”Ÿ
*   ä½¿ç”¨æ•°å­—æ‘˜è¦ç”Ÿæˆçš„å€¼æ˜¯ä¸å¯ä»¥ç¯¡æ”¹çš„ï¼Œä¸ºäº†ä¿è¯æ–‡ä»¶æˆ–è€…å€¼çš„å®‰å…¨

#### 1.9.1 ç‰¹ç‚¹

æ— è®ºè¾“å…¥çš„æ¶ˆæ¯æœ‰å¤šé•¿ï¼Œè®¡ç®—å‡ºæ¥çš„æ¶ˆæ¯æ‘˜è¦çš„é•¿åº¦æ€»æ˜¯å›ºå®šçš„ã€‚ä¾‹å¦‚åº”ç”¨ MD5 ç®—æ³•æ‘˜è¦çš„æ¶ˆæ¯æœ‰ 128 ä¸ªæ¯”ç‰¹ä½ï¼Œç”¨ SHA-1 ç®—æ³•æ‘˜è¦çš„æ¶ˆæ¯æœ€ç»ˆæœ‰ 160 æ¯”ç‰¹ä½çš„è¾“å‡º

åªè¦è¾“å…¥çš„æ¶ˆæ¯ä¸åŒï¼Œå¯¹å…¶è¿›è¡Œæ‘˜è¦ä»¥åäº§ç”Ÿçš„æ‘˜è¦æ¶ˆæ¯ä¹Ÿå¿…ä¸ç›¸åŒï¼›ä½†ç›¸åŒçš„è¾“å…¥å¿…ä¼šäº§ç”Ÿç›¸åŒçš„è¾“å‡º

æ¶ˆæ¯æ‘˜è¦æ˜¯å•å‘ã€ä¸å¯é€†çš„

å¸¸è§ç®—æ³• :

| ç®—æ³•        | è¾“å‡ºé•¿åº¦ï¼ˆä½ï¼‰ | è¾“å‡ºé•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ | å®‰å…¨æ€§ç°çŠ¶       | é€Ÿåº¦ï¼ˆç›¸å¯¹ï¼‰                   | åº”ç”¨åœºæ™¯                         |
| ----------- | -------------- | ---------------- | ---------------- | ------------------------------ | -------------------------------- |
| **MD5**     | 128 ä½         | 16 å­—èŠ‚          | å·²è¢«ç ´è§£ï¼Œä¸å®‰å…¨ | éå¸¸å¿«                         | è€æ—§åº”ç”¨ã€æ–‡ä»¶æ ¡éªŒï¼ˆéå®‰å…¨åœºæ™¯ï¼‰ |
| **SHA-1**   | 160 ä½         | 20 å­—èŠ‚          | å·²è¢«ç ´è§£ï¼Œä¸æ¨è | å¿«                             | è€æ—§ç³»ç»Ÿå…¼å®¹æ€§ä½¿ç”¨               |
| **SHA-256** | 256 ä½         | 32 å­—èŠ‚          | å®‰å…¨             | ä¸­ç­‰                           | æ•°å­—ç­¾åã€åŠ å¯†åè®®ï¼ˆå¦‚ TLSï¼‰     |
| **SHA-512** | 512 ä½         | 64 å­—èŠ‚          | å®‰å…¨             | è¾ƒæ…¢ï¼ˆä½†åœ¨ 64 ä½ç³»ç»Ÿä¸Šæ•ˆç‡é«˜ï¼‰ | é«˜å®‰å…¨æ€§è¦æ±‚åœºæ™¯                 |



[åœ¨çº¿è·å–æ¶ˆæ¯æ‘˜è¦](http://tool.oschina.net/encrypt?type=2)

ç™¾åº¦æœç´¢Â `tomcat`Â ï¼Œè¿›å…¥å®˜ç½‘ä¸‹è½½ ï¼Œä¼šç»å¸¸å‘ç°æœ‰Â `sha1`ï¼Œ`sha512`Â , è¿™äº›éƒ½æ˜¯æ•°å­—æ‘˜è¦

![](./images/å¯†ç å­¦/2957590-20230131080030813-275759391.jpg)

æ•°å­—æ‘˜è¦

![](./images/å¯†ç å­¦/2957590-20230131080030780-227598377.jpg)

#### 1.9.2 è·å–å­—ç¬¦ä¸²æ¶ˆæ¯æ‘˜è¦

```java
package com.atguigu.digest;

import javax.sound.midi.Soundbank;
import java.security.MessageDigest;

/**
 * DigestDemo1
 */
public class DigestDemo1 {

    public static void main(String[] args) throws Exception{
        // åŸæ–‡
        String input = "aa";
        // ç®—æ³•
        String algorithm = "MD5";
        // è·å–æ•°å­—æ‘˜è¦å¯¹è±¡
        MessageDigest messageDigest = MessageDigest.getInstance(algorithm);
        // è·å–æ¶ˆæ¯æ•°å­—æ‘˜è¦çš„å­—èŠ‚æ•°ç»„
        byte[] digest = messageDigest.digest(input.getBytes());
        System.out.println(new String(digest));
    }
}
```

è¿è¡Œ

![](./images/å¯†ç å­¦/2957590-20230131080030427-745590913.jpg)

#### 1.9.3 base64 ç¼–ç 

```java
package com.atguigu.digest;

import com.sun.org.apache.xml.internal.security.utils.Base64;

import javax.sound.midi.Soundbank;
import java.security.MessageDigest;

/**
 * DigestDemo1
 */
public class DigestDemo1 {

    public static void main(String[] args) throws Exception{
        // åŸæ–‡
        String input = "aa";
        // ç®—æ³•
        String algorithm = "MD5";
        // è·å–æ•°å­—æ‘˜è¦å¯¹è±¡
        MessageDigest messageDigest = MessageDigest.getInstance(algorithm);
        // æ¶ˆæ¯æ•°å­—æ‘˜è¦
        byte[] digest = messageDigest.digest(input.getBytes());
//        System.out.println(new String(digest));
        // base64ç¼–ç 
        System.out.println(Base64.encode(digest));
    }
}
```

è¿è¡Œ

![](./images/å¯†ç å­¦/2957590-20230131080030748-2147478552.jpg)

ä½¿ç”¨åœ¨çº¿ md5 åŠ å¯† ï¼Œå‘ç°æˆ‘ä»¬ç”Ÿæˆçš„å€¼å’Œä»£ç ç”Ÿæˆçš„å€¼ä¸ä¸€æ ·ï¼Œé‚£æ˜¯å› ä¸ºæ¶ˆæ¯æ‘˜è¦ä¸æ˜¯ä½¿ç”¨ base64 è¿›è¡Œç¼–ç çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠå€¼è½¬æˆ 16 è¿›åˆ¶

![](./images/å¯†ç å­¦/2957590-20230131080030749-1712048478.jpg)

#### æ•°å­—æ‘˜è¦è½¬æ¢æˆ 16 è¿›åˆ¶

```
// 4124bc0a9335c27f086f24ba207a4912     md5 åœ¨çº¿æ ¡éªŒ
// QSS8CpM1wn8IbyS6IHpJEg==             æ¶ˆæ¯æ‘˜è¦ä½¿ç”¨çš„æ˜¯16è¿›åˆ¶
```

ä»£ç è½¬æˆ 16 è¿›åˆ¶

```java
package com.atguigu.digest;

import com.sun.org.apache.xml.internal.security.utils.Base64;

import javax.sound.midi.Soundbank;
import java.security.MessageDigest;


public class DigestDemo1 {

    public static void main(String[] args) throws Exception{
        // 4124bc0a9335c27f086f24ba207a4912     md5 åœ¨çº¿æ ¡éªŒ
        // QSS8CpM1wn8IbyS6IHpJEg==             æ¶ˆæ¯æ‘˜è¦ä½¿ç”¨çš„æ˜¯16è¿›åˆ¶
        // åŸæ–‡
        String input = "aa";
        // ç®—æ³•
        String algorithm = "MD5";
        // è·å–æ•°å­—æ‘˜è¦å¯¹è±¡
        MessageDigest messageDigest = MessageDigest.getInstance(algorithm);
        // æ¶ˆæ¯æ•°å­—æ‘˜è¦
        byte[] digest = messageDigest.digest(input.getBytes());
//        System.out.println(new String(digest));
        // base64ç¼–ç 
//        System.out.println(Base64.encode(digest));
        // åˆ›å»ºå¯¹è±¡ç”¨æ¥æ‹¼æ¥
        StringBuilder sb = new StringBuilder();

        for (byte b : digest) {
            // è½¬æˆ 16è¿›åˆ¶
            String s = Integer.toHexString(b & 0xff);
            //System.out.println(s);
            if (s.length() == 1){
                // å¦‚æœç”Ÿæˆçš„å­—ç¬¦åªæœ‰ä¸€ä¸ªï¼Œå‰é¢è¡¥0
                s = "0"+s;
            }
            sb.append(s);
        }
        System.out.println(sb.toString());
        
    }
}
```

è¿è¡Œ

![](./images/å¯†ç å­¦/2957590-20230131080030482-467282625.jpg)

#### 1.9.4 å…¶ä»–æ•°å­—æ‘˜è¦ç®—æ³•

```java
package com.atguigu.digest;

import com.sun.org.apache.xml.internal.security.utils.Base64;

import javax.sound.midi.Soundbank;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;


public class DigestDemo1 {

    public static void main(String[] args) throws Exception{
        // 4124bc0a9335c27f086f24ba207a4912     md5 åœ¨çº¿æ ¡éªŒ
        // QSS8CpM1wn8IbyS6IHpJEg==             æ¶ˆæ¯æ‘˜è¦ä½¿ç”¨çš„æ˜¯16è¿›åˆ¶
        // åŸæ–‡
        String input = "aa";
        // ç®—æ³•
        String algorithm = "MD5";
        // è·å–æ•°å­—æ‘˜è¦å¯¹è±¡
        String md5 = getDigest(input, "MD5");
        System.out.println(md5);

        String sha1 = getDigest(input, "SHA-1");
        System.out.println(sha1);

        String sha256 = getDigest(input, "SHA-256");
        System.out.println(sha256);

        String sha512 = getDigest(input, "SHA-512");
        System.out.println(sha512);


    }


    private static String getDigest(String input, String algorithm) throws Exception {
        MessageDigest messageDigest = MessageDigest.getInstance(algorithm);
        // æ¶ˆæ¯æ•°å­—æ‘˜è¦
        byte[] digest = messageDigest.digest(input.getBytes());
        System.out.println("å¯†æ–‡çš„å­—èŠ‚é•¿åº¦:" + digest.length);

        return toHex(digest);
    }
    
    private static String toHex(byte[] digest) throws Exception {

//        System.out.println(new String(digest));
        // base64ç¼–ç 
//        System.out.println(Base64.encode(digest));
        // åˆ›å»ºå¯¹è±¡ç”¨æ¥æ‹¼æ¥
        StringBuilder sb = new StringBuilder();

        for (byte b : digest) {
            // è½¬æˆ 16è¿›åˆ¶
            String s = Integer.toHexString(b & 0xff);
            if (s.length() == 1){
                // å¦‚æœç”Ÿæˆçš„å­—ç¬¦åªæœ‰ä¸€ä¸ªï¼Œå‰é¢è¡¥0
                s = "0"+s;
            }
            sb.append(s);
        }
        System.out.println("16è¿›åˆ¶æ•°æ®çš„é•¿åº¦ï¼š" + sb.toString().getBytes().length);
        return sb.toString();
    }
}
```

è¿è¡Œ

![](./images/å¯†ç å­¦/2957590-20230131080030750-1543691662.jpg)

#### 1.9.5 è·å–æ–‡ä»¶æ¶ˆæ¯æ‘˜è¦

```java
package com.atguigu.digest;

import com.sun.org.apache.xml.internal.security.utils.Base64;
import com.sun.scenario.effect.impl.sw.sse.SSEBlend_SRC_OUTPeer;
import sun.misc.BASE64Decoder;

import java.io.ByteArrayOutputStream;
import java.io.FileInputStream;
import java.security.MessageDigest;


public class DigestDemo {

    public static void main(String[] args) throws Exception{
        String input = "aa";
        String algorithm = "MD5";

        // sha1 å¯ä»¥å®ç°ç§’ä¼ åŠŸèƒ½

        String sha1 = getDigestFile("apache-tomcat-9.0.10-windows-x64.zip", "SHA-1");
        System.out.println(sha1);

        String sha512 = getDigestFile("apache-tomcat-9.0.10-windows-x64.zip", "SHA-512");
        System.out.println(sha512);

        String md5 = getDigest("aa", "MD5");
        System.out.println(md5);

        String md51 = getDigest("aa ", "MD5");
        System.out.println(md51);
    }

    private static String getDigestFile(String filePath, String algorithm) throws Exception{
        FileInputStream fis = new FileInputStream(filePath);
        int len;
        byte[] buffer = new byte[1024];
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        while ( (len =  fis.read(buffer))!=-1){
            baos.write(buffer,0,len);
        }
        // è·å–æ¶ˆæ¯æ‘˜è¦å¯¹è±¡
        MessageDigest messageDigest = MessageDigest.getInstance(algorithm);
        // è·å–æ¶ˆæ¯æ‘˜è¦
        byte[] digest = messageDigest.digest(baos.toByteArray());
        System.out.println("å¯†æ–‡çš„å­—èŠ‚é•¿åº¦ï¼š"+digest.length);
        return toHex(digest);
    }

    private static String getDigest(String input, String algorithm) throws Exception{
        MessageDigest messageDigest = MessageDigest.getInstance(algorithm);
        byte[] digest = messageDigest.digest(input.getBytes());
        System.out.println("å¯†æ–‡çš„å­—èŠ‚é•¿åº¦ï¼š"+digest.length);
        return toHex(digest);
    }

    private static String toHex(byte[] digest) {
        //        System.out.println(new String(digest));
        // æ¶ˆæ¯æ‘˜è¦è¿›è¡Œè¡¨ç¤ºçš„æ—¶å€™ï¼Œæ˜¯ç”¨16è¿›åˆ¶è¿›è¡Œè¡¨ç¤º
        StringBuilder sb = new StringBuilder();
        for (byte b : digest) {
            // è½¬æˆ16è¿›åˆ¶

            String s = Integer.toHexString(b & 0xff);
            // ä¿æŒæ•°æ®çš„å®Œæ•´æ€§ï¼Œå‰é¢ä¸å¤Ÿçš„ç”¨0è¡¥é½
            if (s.length()==1){
                s="0"+s;
            }
            sb.append(s);
        }
        System.out.println("16è¿›åˆ¶æ•°æ®çš„é•¿åº¦:"+ sb.toString().getBytes().length);
        return sb.toString();
    }
}
```

è¿è¡Œç¨‹åº ï¼Œè·å–Â `sha-1`Â å’ŒÂ `sha-512`Â çš„å€¼

![](./images/å¯†ç å­¦/2957590-20230131080030655-1728054815.jpg)

æŸ¥çœ‹ tomcat å®˜ç½‘ä¸Šé¢Â `sha-1`Â å’ŒÂ `sha-512`Â çš„å€¼

![](./images/å¯†ç å­¦/2957590-20230131080030830-492245025.jpg)

ä½¿ç”¨ sha-1 ç®—æ³•ï¼Œå¯ä»¥å®ç°ç§’ä¼ åŠŸèƒ½ï¼Œä¸ç®¡å’±ä»¬å¦‚ä½•ä¿®æ”¹æ–‡ä»¶çš„åå­—ï¼Œæœ€åå¾—åˆ°çš„å€¼æ˜¯ä¸€æ ·çš„

![](./images/å¯†ç å­¦/2957590-20230131080030697-1804135879.jpg)

è¿è¡Œç¨‹åº ï¼Œè·å–Â `sha-1`Â å’ŒÂ `sha-512`Â çš„å€¼

![](./images/å¯†ç å­¦/2957590-20230131080030655-1728054815.jpg)

å¦‚æœåŸæ–‡ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆ sha-1 å€¼ å°±ä¼šä¸ä¸€æ ·

![](./images/å¯†ç å­¦/2957590-20230131080030779-261341962.jpg)

è¿è¡Œç»“æœï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030749-1089555761.jpg)

æ€»ç»“

*   MD5 ç®—æ³• : æ‘˜è¦ç»“æœ 16 ä¸ªå­—èŠ‚, è½¬ 16 è¿›åˆ¶å 32 ä¸ªå­—èŠ‚
*   SHA1 ç®—æ³• : æ‘˜è¦ç»“æœ 20 ä¸ªå­—èŠ‚, è½¬ 16 è¿›åˆ¶å 40 ä¸ªå­—èŠ‚
*   SHA256 ç®—æ³• : æ‘˜è¦ç»“æœ 32 ä¸ªå­—èŠ‚, è½¬ 16 è¿›åˆ¶å 64 ä¸ªå­—èŠ‚
*   SHA512 ç®—æ³• : æ‘˜è¦ç»“æœ 64 ä¸ªå­—èŠ‚, è½¬ 16 è¿›åˆ¶å 128 ä¸ªå­—èŠ‚

## 1.10 éå¯¹ç§°åŠ å¯†

ç®€ä»‹ï¼š

â‘  éå¯¹ç§°åŠ å¯†ç®—æ³•åˆç§° `ç°ä»£åŠ å¯†ç®—æ³•`ã€‚

â‘¡ éå¯¹ç§°åŠ å¯†æ˜¯è®¡ç®—æœºé€šä¿¡å®‰å…¨çš„åŸºçŸ³ï¼Œä¿è¯äº†åŠ å¯†æ•°æ® `ä¸ä¼šè¢«ç ´è§£`ã€‚

â‘¢ ä¸å¯¹ç§°åŠ å¯†ç®—æ³•ä¸åŒï¼Œéå¯¹ç§°åŠ å¯†ç®—æ³•éœ€è¦ä¸¤ä¸ªå¯†é’¥ï¼š`å…¬å¼€å¯†é’¥(publickey)`Â å’Œ `ç§æœ‰å¯†(privatekey)`

â‘£ å…¬å¼€å¯†é’¥å’Œç§æœ‰å¯†é’¥æ˜¯ `ä¸€å¯¹`

â‘¤ å¦‚æœç”¨ `å…¬å¼€å¯†é’¥` å¯¹æ•°æ®è¿›è¡Œ `åŠ å¯†`ï¼Œåªæœ‰ç”¨ `å¯¹åº”çš„ç§æœ‰å¯†é’¥` æ‰èƒ½ `è§£å¯†`ã€‚åŠ å¯†ä¼ é€’

â‘¥ å¦‚æœç”¨ `ç§æœ‰å¯†é’¥` å¯¹æ•°æ®è¿›è¡Œ `åŠ å¯†`ï¼Œåªæœ‰ç”¨ `å¯¹åº”çš„å…¬å¼€å¯†é’¥` æ‰èƒ½ `è§£å¯†`ã€‚ éªŒè¯èº«ä»½

â‘¦ å› ä¸ºåŠ å¯†å’Œè§£å¯†ä½¿ç”¨çš„æ˜¯ä¸¤ä¸ª `ä¸åŒ` çš„å¯†é’¥ï¼Œæ‰€ä»¥è¿™ç§ç®—æ³•å«ä½œ `éå¯¹ç§°åŠ å¯†ç®—æ³•`ã€‚



*   ç¤ºä¾‹
    *   é¦–å…ˆç”Ÿæˆå¯†é’¥å¯¹, å…¬é’¥ä¸º (5,14), ç§é’¥ä¸º (11,14)
    *   ç°åœ¨ A å¸Œæœ›å°†åŸæ–‡ 2 å‘é€ç»™ B
    *   A ä½¿ç”¨å…¬é’¥åŠ å¯†æ•°æ®. 2 çš„ 5 æ¬¡æ–¹ mod 14 = 4 , å°†å¯†æ–‡ 4 å‘é€ç»™ B
    *   B ä½¿ç”¨ç§é’¥è§£å¯†æ•°æ®. 4 çš„ 11 æ¬¡æ–¹ mod14 = 2, å¾—åˆ°åŸæ–‡ 2
*   ç‰¹ç‚¹
    *   åŠ å¯†å’Œè§£å¯†ä½¿ç”¨ä¸åŒçš„å¯†é’¥
    *   å¦‚æœä½¿ç”¨ç§é’¥åŠ å¯†, åªèƒ½ä½¿ç”¨å…¬é’¥è§£å¯†
    *   å¦‚æœä½¿ç”¨å…¬é’¥åŠ å¯†, åªèƒ½ä½¿ç”¨ç§é’¥è§£å¯†
    *   å¤„ç†æ•°æ®çš„é€Ÿåº¦è¾ƒæ…¢, å› ä¸ºå®‰å…¨çº§åˆ«é«˜
*   å¸¸è§ç®—æ³•
    *   RSA
    *   ECC

#### 1.10.1 ç”Ÿæˆå…¬é’¥å’Œç§é’¥

```java
package com.atguigu.rsa;
import com.sun.org.apache.xml.internal.security.utils.Base64;
import org.apache.commons.io.FileUtils;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;
import java.io.File;
import java.nio.charset.Charset;
import java.security.*;
import java.security.spec.PKCS8EncodedKeySpec;

public class RSAdemo {
    public static void main(String[] args) throws Exception {
      
        // åŠ å¯†ç®—æ³•
        String algorithm = "RSA";
        //  åˆ›å»ºå¯†é’¥å¯¹ç”Ÿæˆå™¨å¯¹è±¡
        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);
        // ç”Ÿæˆå¯†é’¥å¯¹
        KeyPair keyPair = keyPairGenerator.generateKeyPair();
        // ç”Ÿæˆç§é’¥
        PrivateKey privateKey = keyPair.getPrivate();
        // ç”Ÿæˆå…¬é’¥
        PublicKey publicKey = keyPair.getPublic();
        // è·å–ç§é’¥å­—èŠ‚æ•°ç»„
        byte[] privateKeyEncoded = privateKey.getEncoded();
        // è·å–å…¬é’¥å­—èŠ‚æ•°ç»„
        byte[] publicKeyEncoded = publicKey.getEncoded();
        // å¯¹å…¬ç§é’¥è¿›è¡Œbase64ç¼–ç 
        String privateKeyString = Base64.encode(privateKeyEncoded);
        String publicKeyString = Base64.encode(publicKeyEncoded);
        // æ‰“å°ç§é’¥
        System.out.println(privateKeyString);
        // æ‰“å°å…¬é’¥
        System.out.println(publicKeyString);
    }
}
```

è¿è¡Œç¨‹åºï¼šå…ˆæ‰“å°çš„æ˜¯ç§é’¥ ï¼Œ åé¢æ‰“å°çš„æ˜¯å…¬é’¥

![](./images/å¯†ç å­¦/2957590-20230131080030784-485411063.jpg)

#### 1.10.2 ç§é’¥åŠ å¯†

```java
package com.atguigu.rsa;
import com.sun.org.apache.xml.internal.security.utils.Base64;
import org.apache.commons.io.FileUtils;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;
import java.io.File;
import java.nio.charset.Charset;
import java.security.*;
import java.security.spec.PKCS8EncodedKeySpec;

public class RSAdemo {
    public static void main(String[] args) throws Exception {
        String input = "ç¡…è°·";
        // åŠ å¯†ç®—æ³•
        String algorithm = "RSA";
        //  åˆ›å»ºå¯†é’¥å¯¹ç”Ÿæˆå™¨å¯¹è±¡
        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);
        // ç”Ÿæˆå¯†é’¥å¯¹
        KeyPair keyPair = keyPairGenerator.generateKeyPair();
        // ç”Ÿæˆç§é’¥
        PrivateKey privateKey = keyPair.getPrivate();
        // ç”Ÿæˆå…¬é’¥
        PublicKey publicKey = keyPair.getPublic();
        // è·å–ç§é’¥å­—èŠ‚æ•°ç»„
        byte[] privateKeyEncoded = privateKey.getEncoded();
        // è·å–å…¬é’¥å­—èŠ‚æ•°ç»„
        byte[] publicKeyEncoded = publicKey.getEncoded();
        // å¯¹å…¬ç§é’¥è¿›è¡Œbase64ç¼–ç 
        String privateKeyString = Base64.encode(privateKeyEncoded);
        String publicKeyString = Base64.encode(publicKeyEncoded);


        // åˆ›å»ºåŠ å¯†å¯¹è±¡
        // å‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        Cipher cipher = Cipher.getInstance(algorithm);
        // åˆå§‹åŒ–åŠ å¯†
        // ç¬¬ä¸€ä¸ªå‚æ•°:åŠ å¯†çš„æ¨¡å¼
        // ç¬¬äºŒä¸ªå‚æ•°ï¼šä½¿ç”¨ç§é’¥è¿›è¡ŒåŠ å¯†
        cipher.init(Cipher.ENCRYPT_MODE,privateKey);
        // ç§é’¥åŠ å¯†
        byte[] bytes = cipher.doFinal(input.getBytes());
        System.out.println(Base64.encode(bytes));
       
    }
}
```

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030761-439290803.jpg)

#### 1.10.3 ç§é’¥åŠ å¯†ç§é’¥è§£å¯†

```java
package com.atguigu.rsa;
import com.sun.org.apache.xml.internal.security.utils.Base64;
import org.apache.commons.io.FileUtils;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;
import java.io.File;
import java.nio.charset.Charset;
import java.security.*;
import java.security.spec.PKCS8EncodedKeySpec;

public class RSAdemo {
    public static void main(String[] args) throws Exception {
        String input = "ç¡…è°·";
        // åŠ å¯†ç®—æ³•
        String algorithm = "RSA";
        //  åˆ›å»ºå¯†é’¥å¯¹ç”Ÿæˆå™¨å¯¹è±¡
        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);
        // ç”Ÿæˆå¯†é’¥å¯¹
        KeyPair keyPair = keyPairGenerator.generateKeyPair();
        // ç”Ÿæˆç§é’¥
        PrivateKey privateKey = keyPair.getPrivate();
        // ç”Ÿæˆå…¬é’¥
        PublicKey publicKey = keyPair.getPublic();
        // è·å–ç§é’¥å­—èŠ‚æ•°ç»„
        byte[] privateKeyEncoded = privateKey.getEncoded();
        // è·å–å…¬é’¥å­—èŠ‚æ•°ç»„
        byte[] publicKeyEncoded = publicKey.getEncoded();
        // å¯¹å…¬ç§é’¥è¿›è¡Œbase64ç¼–ç 
        String privateKeyString = Base64.encode(privateKeyEncoded);
        String publicKeyString = Base64.encode(publicKeyEncoded);


        // åˆ›å»ºåŠ å¯†å¯¹è±¡
        // å‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        Cipher cipher = Cipher.getInstance(algorithm);
        // åˆå§‹åŒ–åŠ å¯†
        // ç¬¬ä¸€ä¸ªå‚æ•°:åŠ å¯†çš„æ¨¡å¼
        // ç¬¬äºŒä¸ªå‚æ•°ï¼šä½¿ç”¨ç§é’¥è¿›è¡ŒåŠ å¯†
        cipher.init(Cipher.ENCRYPT_MODE,privateKey);
        // ç§é’¥åŠ å¯†
        byte[] bytes = cipher.doFinal(input.getBytes());
        System.out.println(Base64.encode(bytes));
        // ç§é’¥è¿›è¡Œè§£å¯†
        cipher.init(Cipher.DECRYPT_MODE,privateKey);
        // å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œä¸éœ€è¦ä½¿ç”¨base64ï¼Œå› ä¸ºåŸæ–‡ä¸ä¼šä¹±ç 
        byte[] bytes1 = cipher.doFinal(bytes);
        System.out.println(new String(bytes1));

    }
}
```

è¿è¡Œç¨‹åº ï¼Œ**å› ä¸ºç§é’¥åŠ å¯†ï¼Œåªèƒ½å…¬é’¥è§£å¯†**

![](./images/å¯†ç å­¦/2957590-20230131080030750-1420504439.jpg)

#### 1.10.4 ç§é’¥åŠ å¯†å…¬é’¥è§£å¯†

```java
package com.atguigu.rsa;
import com.sun.org.apache.xml.internal.security.utils.Base64;
import org.apache.commons.io.FileUtils;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;
import java.io.File;
import java.nio.charset.Charset;
import java.security.*;
import java.security.spec.PKCS8EncodedKeySpec;

public class RSAdemo {
    public static void main(String[] args) throws Exception {
        String input = "ç¡…è°·";
        // åŠ å¯†ç®—æ³•
        String algorithm = "RSA";
        //  åˆ›å»ºå¯†é’¥å¯¹ç”Ÿæˆå™¨å¯¹è±¡
        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);
        // ç”Ÿæˆå¯†é’¥å¯¹
        KeyPair keyPair = keyPairGenerator.generateKeyPair();
        // ç”Ÿæˆç§é’¥
        PrivateKey privateKey = keyPair.getPrivate();
        // ç”Ÿæˆå…¬é’¥
        PublicKey publicKey = keyPair.getPublic();
        // è·å–ç§é’¥å­—èŠ‚æ•°ç»„
        byte[] privateKeyEncoded = privateKey.getEncoded();
        // è·å–å…¬é’¥å­—èŠ‚æ•°ç»„
        byte[] publicKeyEncoded = publicKey.getEncoded();
        // å¯¹å…¬ç§é’¥è¿›è¡Œbase64ç¼–ç 
        String privateKeyString = Base64.encode(privateKeyEncoded);
        String publicKeyString = Base64.encode(publicKeyEncoded);


        // åˆ›å»ºåŠ å¯†å¯¹è±¡
        // å‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        Cipher cipher = Cipher.getInstance(algorithm);
        // åˆå§‹åŒ–åŠ å¯†
        // ç¬¬ä¸€ä¸ªå‚æ•°:åŠ å¯†çš„æ¨¡å¼
        // ç¬¬äºŒä¸ªå‚æ•°ï¼šä½¿ç”¨ç§é’¥è¿›è¡ŒåŠ å¯†
        cipher.init(Cipher.ENCRYPT_MODE,privateKey);
        // ç§é’¥åŠ å¯†
        byte[] bytes = cipher.doFinal(input.getBytes());
        System.out.println(Base64.encode(bytes));
        // ç§é’¥è¿›è¡Œè§£å¯†
        cipher.init(Cipher.DECRYPT_MODE,publicKey);
        // å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œä¸éœ€è¦ä½¿ç”¨base64ï¼Œå› ä¸ºåŸæ–‡ä¸ä¼šä¹±ç 
        byte[] bytes1 = cipher.doFinal(bytes);
        System.out.println(new String(bytes1));

    }
}
```

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030751-652375305.jpg)

#### 1.10.5 å…¬é’¥åŠ å¯†å’Œå…¬é’¥è§£å¯†

ä¸€æ ·ä¼šæŠ¥é”™

#### 1.10.6 ä¿å­˜å…¬é’¥å’Œç§é’¥

å‰é¢ä»£ç æ¯æ¬¡éƒ½ä¼šç”Ÿæˆ åŠ å¯†å’Œè§£å¯† ï¼Œå’±ä»¬éœ€è¦æŠŠåŠ å¯†å’Œè§£å¯†çš„æ–¹æ³•å…¨éƒ¨åˆ°æœ¬åœ°çš„æ ¹ç›®å½•ä¸‹é¢ã€‚

```java
package com.atguigu.rsa;
import com.sun.org.apache.xml.internal.security.utils.Base64;
import org.apache.commons.io.FileUtils;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;
import java.io.File;
import java.nio.charset.Charset;
import java.security.*;
import java.security.spec.PKCS8EncodedKeySpec;

public class RSAdemo {
    public static void main(String[] args) throws Exception {
        String input = "ç¡…è°·";
        // åŠ å¯†ç®—æ³•
        String algorithm = "RSA";

        //ç”Ÿæˆå¯†é’¥å¯¹å¹¶ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶ä¸­
        generateKeyToFile(algorithm, "a.pub", "a.pri");

          //åŠ å¯†
//        String s = encryptRSA(algorithm, privateKey, input);
        // è§£å¯†
//        String s1 = decryptRSA(algorithm, publicKey, s);
//        System.out.println(s1);


    }

    /**
     * ç”Ÿæˆå¯†é’¥å¯¹å¹¶ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶ä¸­
     *
     * @param algorithm : ç®—æ³•
     * @param pubPath   : å…¬é’¥ä¿å­˜è·¯å¾„
     * @param priPath   : ç§é’¥ä¿å­˜è·¯å¾„
     * @throws Exception
     */
    private static void generateKeyToFile(String algorithm, String pubPath, String priPath) throws Exception {
        // è·å–å¯†é’¥å¯¹ç”Ÿæˆå™¨
        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);
        // è·å–å¯†é’¥å¯¹
        KeyPair keyPair = keyPairGenerator.generateKeyPair();
        // è·å–å…¬é’¥
        PublicKey publicKey = keyPair.getPublic();
        // è·å–ç§é’¥
        PrivateKey privateKey = keyPair.getPrivate();
        // è·å–byteæ•°ç»„
        byte[] publicKeyEncoded = publicKey.getEncoded();
        byte[] privateKeyEncoded = privateKey.getEncoded();
        // è¿›è¡ŒBase64ç¼–ç 
        String publicKeyString = Base64.encode(publicKeyEncoded);
        String privateKeyString = Base64.encode(privateKeyEncoded);
        // ä¿å­˜æ–‡ä»¶
        FileUtils.writeStringToFile(new File(pubPath), publicKeyString, Charset.forName("UTF-8"));
        FileUtils.writeStringToFile(new File(priPath), privateKeyString, Charset.forName("UTF-8"));

    }

    /**
     * è§£å¯†æ•°æ®
     *
     * @param algorithm      : ç®—æ³•
     * @param encrypted      : å¯†æ–‡
     * @param key            : å¯†é’¥
     * @return : åŸæ–‡
     * @throws Exception
     */
    public static String decryptRSA(String algorithm,Key key,String encrypted) throws Exception{
         // åˆ›å»ºåŠ å¯†å¯¹è±¡
        // å‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        Cipher cipher = Cipher.getInstance(algorithm);
        // ç§é’¥è¿›è¡Œè§£å¯†
        cipher.init(Cipher.DECRYPT_MODE,key);
        // ç”±äºå¯†æ–‡è¿›è¡Œäº†Base64ç¼–ç , åœ¨è¿™é‡Œéœ€è¦è¿›è¡Œè§£ç 
        byte[] decode = Base64.decode(encrypted);
        // å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œä¸éœ€è¦ä½¿ç”¨base64ï¼Œå› ä¸ºåŸæ–‡ä¸ä¼šä¹±ç 
        byte[] bytes1 = cipher.doFinal(decode);
        System.out.println(new String(bytes1));
        return new String(bytes1);

    }
    /**
     * ä½¿ç”¨å¯†é’¥åŠ å¯†æ•°æ®
     *
     * @param algorithm      : ç®—æ³•
     * @param input          : åŸæ–‡
     * @param key            : å¯†é’¥
     * @return : å¯†æ–‡
     * @throws Exception
     */
    public static String encryptRSA(String algorithm,Key key,String input) throws Exception{
        // åˆ›å»ºåŠ å¯†å¯¹è±¡
        // å‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        Cipher cipher = Cipher.getInstance(algorithm);
        // åˆå§‹åŒ–åŠ å¯†
        // ç¬¬ä¸€ä¸ªå‚æ•°:åŠ å¯†çš„æ¨¡å¼
        // ç¬¬äºŒä¸ªå‚æ•°ï¼šä½¿ç”¨ç§é’¥è¿›è¡ŒåŠ å¯†
        cipher.init(Cipher.ENCRYPT_MODE,key);
        // ç§é’¥åŠ å¯†
        byte[] bytes = cipher.doFinal(input.getBytes());
        // å¯¹å¯†æ–‡è¿›è¡ŒBase64ç¼–ç 
        System.out.println(Base64.encode(bytes));
        return Base64.encode(bytes);
    }
}
```

è¿è¡Œåœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆç§é’¥

![](./images/å¯†ç å­¦/2957590-20230131080030827-1852431103.jpg)

è¿è¡Œåœ¨é¡¹ç›®æ ¹ç›®å½•ç”Ÿæˆå…¬é’¥

![](./images/å¯†ç å­¦/2957590-20230131080030516-1830316550.jpg)

#### 1.10.7 è¯»å–ç§é’¥

```java
package com.atguigu.rsa;
import com.sun.org.apache.xml.internal.security.utils.Base64;
import org.apache.commons.io.FileUtils;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;
import java.io.File;
import java.nio.charset.Charset;
import java.security.*;
import java.security.spec.PKCS8EncodedKeySpec;

public class RSAdemo {
    public static void main(String[] args) throws Exception {
        String input = "ç¡…è°·";
        // åŠ å¯†ç®—æ³•
        String algorithm = "RSA";
        PrivateKey privateKey = getPrivateKey("a.pri", algorithm);



    }

    public static PrivateKey getPrivateKey(String priPath,String algorithm) throws Exception{
        // å°†æ–‡ä»¶å†…å®¹è½¬ä¸ºå­—ç¬¦ä¸²
        String privateKeyString = FileUtils.readFileToString(new File(priPath), Charset.defaultCharset());
        // è·å–å¯†é’¥å·¥å‚
        KeyFactory keyFactory = KeyFactory.getInstance(algorithm);
        // æ„å»ºå¯†é’¥è§„èŒƒ è¿›è¡ŒBase64è§£ç 
        PKCS8EncodedKeySpec spec = new PKCS8EncodedKeySpec(Base64.decode(privateKeyString));
        // ç”Ÿæˆç§é’¥
        return keyFactory.generatePrivate(spec);
    }

    /**
     * ç”Ÿæˆå¯†é’¥å¯¹å¹¶ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶ä¸­
     *
     * @param algorithm : ç®—æ³•
     * @param pubPath   : å…¬é’¥ä¿å­˜è·¯å¾„
     * @param priPath   : ç§é’¥ä¿å­˜è·¯å¾„
     * @throws Exception
     */
    private static void generateKeyToFile(String algorithm, String pubPath, String priPath) throws Exception {
        // è·å–å¯†é’¥å¯¹ç”Ÿæˆå™¨
        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);
        // è·å–å¯†é’¥å¯¹
        KeyPair keyPair = keyPairGenerator.generateKeyPair();
        // è·å–å…¬é’¥
        PublicKey publicKey = keyPair.getPublic();
        // è·å–ç§é’¥
        PrivateKey privateKey = keyPair.getPrivate();
        // è·å–byteæ•°ç»„
        byte[] publicKeyEncoded = publicKey.getEncoded();
        byte[] privateKeyEncoded = privateKey.getEncoded();
        // è¿›è¡ŒBase64ç¼–ç 
        String publicKeyString = Base64.encode(publicKeyEncoded);
        String privateKeyString = Base64.encode(privateKeyEncoded);
        // ä¿å­˜æ–‡ä»¶
        FileUtils.writeStringToFile(new File(pubPath), publicKeyString, Charset.forName("UTF-8"));
        FileUtils.writeStringToFile(new File(priPath), privateKeyString, Charset.forName("UTF-8"));

    }

    /**
     * è§£å¯†æ•°æ®
     *
     * @param algorithm      : ç®—æ³•
     * @param encrypted      : å¯†æ–‡
     * @param key            : å¯†é’¥
     * @return : åŸæ–‡
     * @throws Exception
     */
    public static String decryptRSA(String algorithm,Key key,String encrypted) throws Exception{
         // åˆ›å»ºåŠ å¯†å¯¹è±¡
        // å‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        Cipher cipher = Cipher.getInstance(algorithm);
        // ç§é’¥è¿›è¡Œè§£å¯†
        cipher.init(Cipher.DECRYPT_MODE,key);
        // ç”±äºå¯†æ–‡è¿›è¡Œäº†Base64ç¼–ç , åœ¨è¿™é‡Œéœ€è¦è¿›è¡Œè§£ç 
        byte[] decode = Base64.decode(encrypted);
        // å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œä¸éœ€è¦ä½¿ç”¨base64ï¼Œå› ä¸ºåŸæ–‡ä¸ä¼šä¹±ç 
        byte[] bytes1 = cipher.doFinal(decode);
        System.out.println(new String(bytes1));
        return new String(bytes1);

    }
    /**
     * ä½¿ç”¨å¯†é’¥åŠ å¯†æ•°æ®
     *
     * @param algorithm      : ç®—æ³•
     * @param input          : åŸæ–‡
     * @param key            : å¯†é’¥
     * @return : å¯†æ–‡
     * @throws Exception
     */
    public static String encryptRSA(String algorithm,Key key,String input) throws Exception{
        // åˆ›å»ºåŠ å¯†å¯¹è±¡
        // å‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        Cipher cipher = Cipher.getInstance(algorithm);
        // åˆå§‹åŒ–åŠ å¯†
        // ç¬¬ä¸€ä¸ªå‚æ•°:åŠ å¯†çš„æ¨¡å¼
        // ç¬¬äºŒä¸ªå‚æ•°ï¼šä½¿ç”¨ç§é’¥è¿›è¡ŒåŠ å¯†
        cipher.init(Cipher.ENCRYPT_MODE,key);
        // ç§é’¥åŠ å¯†
        byte[] bytes = cipher.doFinal(input.getBytes());
        // å¯¹å¯†æ–‡è¿›è¡ŒBase64ç¼–ç 
        System.out.println(Base64.encode(bytes));
        return Base64.encode(bytes);
    }
}
```

#### 1.10.8 è¯»å–å…¬é’¥

```java
package com.atguigu.rsa;
import com.sun.org.apache.xml.internal.security.utils.Base64;
import org.apache.commons.io.FileUtils;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;
import java.io.File;
import java.nio.charset.Charset;
import java.security.*;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;


public class RSAdemo {
    public static void main(String[] args) throws Exception {
        String input = "ç¡…è°·";
        // åŠ å¯†ç®—æ³•
        String algorithm = "RSA";
        PrivateKey privateKey = getPrivateKey("a.pri", algorithm);
        PublicKey publicKey = getPublicKey("a.pub", algorithm);

        String s = encryptRSA(algorithm, privateKey, input);
        String s1 = decryptRSA(algorithm, publicKey, s);
        System.out.println(s1);


    }

    public static PublicKey getPublicKey(String pulickPath,String algorithm) throws Exception{
        // å°†æ–‡ä»¶å†…å®¹è½¬ä¸ºå­—ç¬¦ä¸²
        String publicKeyString = FileUtils.readFileToString(new File(pulickPath), Charset.defaultCharset());
        // è·å–å¯†é’¥å·¥å‚
        KeyFactory keyFactory = KeyFactory.getInstance(algorithm);
        // æ„å»ºå¯†é’¥è§„èŒƒ è¿›è¡ŒBase64è§£ç 
        X509EncodedKeySpec spec = new X509EncodedKeySpec(Base64.decode(publicKeyString));
        // ç”Ÿæˆå…¬é’¥
        return keyFactory.generatePublic(spec);
    }

    public static PrivateKey getPrivateKey(String priPath,String algorithm) throws Exception{
        // å°†æ–‡ä»¶å†…å®¹è½¬ä¸ºå­—ç¬¦ä¸²
        String privateKeyString = FileUtils.readFileToString(new File(priPath), Charset.defaultCharset());
        // è·å–å¯†é’¥å·¥å‚
        KeyFactory keyFactory = KeyFactory.getInstance(algorithm);
        // æ„å»ºå¯†é’¥è§„èŒƒ è¿›è¡ŒBase64è§£ç 
        PKCS8EncodedKeySpec spec = new PKCS8EncodedKeySpec(Base64.decode(privateKeyString));
        // ç”Ÿæˆç§é’¥
        return keyFactory.generatePrivate(spec);
    }

    /**
     * ç”Ÿæˆå¯†é’¥å¯¹å¹¶ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶ä¸­
     *
     * @param algorithm : ç®—æ³•
     * @param pubPath   : å…¬é’¥ä¿å­˜è·¯å¾„
     * @param priPath   : ç§é’¥ä¿å­˜è·¯å¾„
     * @throws Exception
     */
    public static void generateKeyToFile(String algorithm, String pubPath, String priPath) throws Exception {
        // è·å–å¯†é’¥å¯¹ç”Ÿæˆå™¨
        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);
        // è·å–å¯†é’¥å¯¹
        KeyPair keyPair = keyPairGenerator.generateKeyPair();
        // è·å–å…¬é’¥
        PublicKey publicKey = keyPair.getPublic();
        // è·å–ç§é’¥
        PrivateKey privateKey = keyPair.getPrivate();
        // è·å–byteæ•°ç»„
        byte[] publicKeyEncoded = publicKey.getEncoded();
        byte[] privateKeyEncoded = privateKey.getEncoded();
        // è¿›è¡ŒBase64ç¼–ç 
        String publicKeyString = Base64.encode(publicKeyEncoded);
        String privateKeyString = Base64.encode(privateKeyEncoded);
        // ä¿å­˜æ–‡ä»¶
        FileUtils.writeStringToFile(new File(pubPath), publicKeyString, Charset.forName("UTF-8"));
        FileUtils.writeStringToFile(new File(priPath), privateKeyString, Charset.forName("UTF-8"));

    }

    /**
     * è§£å¯†æ•°æ®
     *
     * @param algorithm      : ç®—æ³•
     * @param encrypted      : å¯†æ–‡
     * @param key            : å¯†é’¥
     * @return : åŸæ–‡
     * @throws Exception
     */
    public static String decryptRSA(String algorithm,Key key,String encrypted) throws Exception{
         // åˆ›å»ºåŠ å¯†å¯¹è±¡
        // å‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        Cipher cipher = Cipher.getInstance(algorithm);
        // ç§é’¥è¿›è¡Œè§£å¯†
        cipher.init(Cipher.DECRYPT_MODE,key);
        // ç”±äºå¯†æ–‡è¿›è¡Œäº†Base64ç¼–ç , åœ¨è¿™é‡Œéœ€è¦è¿›è¡Œè§£ç 
        byte[] decode = Base64.decode(encrypted);
        // å¯¹å¯†æ–‡è¿›è¡Œè§£å¯†ï¼Œä¸éœ€è¦ä½¿ç”¨base64ï¼Œå› ä¸ºåŸæ–‡ä¸ä¼šä¹±ç 
        byte[] bytes1 = cipher.doFinal(decode);
        return new String(bytes1);

    }
    /**
     * ä½¿ç”¨å¯†é’¥åŠ å¯†æ•°æ®
     *
     * @param algorithm      : ç®—æ³•
     * @param input          : åŸæ–‡
     * @param key            : å¯†é’¥
     * @return : å¯†æ–‡
     * @throws Exception
     */
    public static String encryptRSA(String algorithm,Key key,String input) throws Exception{
        // åˆ›å»ºåŠ å¯†å¯¹è±¡
        // å‚æ•°è¡¨ç¤ºåŠ å¯†ç®—æ³•
        Cipher cipher = Cipher.getInstance(algorithm);
        // åˆå§‹åŒ–åŠ å¯†
        // ç¬¬ä¸€ä¸ªå‚æ•°:åŠ å¯†çš„æ¨¡å¼
        // ç¬¬äºŒä¸ªå‚æ•°ï¼šä½¿ç”¨ç§é’¥è¿›è¡ŒåŠ å¯†
        cipher.init(Cipher.ENCRYPT_MODE,key);
        // ç§é’¥åŠ å¯†
        byte[] bytes = cipher.doFinal(input.getBytes());
        // å¯¹å¯†æ–‡è¿›è¡ŒBase64ç¼–ç 
        return Base64.encode(bytes);
    }
}
```

è¿è¡Œç¨‹åº

![](./images/å¯†ç å­¦/2957590-20230131080030557-1759672458.jpg)

## 1.11 æ•°å­—ç­¾å

æ•°å­—ç­¾åï¼ˆåˆç§° [å…¬é’¥](https://baike.baidu.com/item/%E5%85%AC%E9%92%A5) æ•°å­—ç­¾åï¼‰æ˜¯åªæœ‰ä¿¡æ¯çš„å‘é€è€…æ‰èƒ½äº§ç”Ÿçš„åˆ«äººæ— æ³•ä¼ªé€ çš„ä¸€æ®µæ•°å­—ä¸²ï¼Œè¿™æ®µæ•°å­—ä¸²åŒæ—¶ä¹Ÿæ˜¯å¯¹ä¿¡æ¯çš„å‘é€è€…å‘é€ä¿¡æ¯çœŸå®æ€§çš„ä¸€ä¸ªæœ‰æ•ˆè¯æ˜ã€‚å®ƒæ˜¯ä¸€ç§ç±»ä¼¼å†™åœ¨çº¸ä¸Šçš„æ™®é€šçš„ç‰©ç†ç­¾åï¼Œä½†æ˜¯ä½¿ç”¨äº† [å…¬é’¥åŠ å¯†](https://baike.baidu.com/item/%E5%85%AC%E9%92%A5%E5%8A%A0%E5%AF%86/6245950) é¢†åŸŸçš„æŠ€æœ¯æ¥å®ç°çš„ï¼Œç”¨äºé‰´åˆ«æ•°å­—ä¿¡æ¯çš„æ–¹æ³•ã€‚ä¸€å¥—æ•°å­—ç­¾åé€šå¸¸å®šä¹‰ä¸¤ç§äº’è¡¥çš„è¿ç®—ï¼Œä¸€ä¸ªç”¨äºç­¾åï¼Œå¦ä¸€ä¸ªç”¨äºéªŒè¯ã€‚æ•°å­—ç­¾åæ˜¯éå¯¹ç§° [å¯†é’¥åŠ å¯†æŠ€æœ¯](https://baike.baidu.com/item/%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86%E6%8A%80%E6%9C%AF) ä¸ [æ•°å­—æ‘˜è¦](https://baike.baidu.com/item/%E6%95%B0%E5%AD%97%E6%91%98%E8%A6%81/4069118) æŠ€æœ¯çš„åº”ç”¨ã€‚

#### 1.11.1 ç®€å•è®¤è¯†

ç›¸ä¿¡æˆ‘ä»¬éƒ½å†™è¿‡ä¿¡ï¼Œåœ¨å†™ä¿¡çš„æ—¶å€™è½æ¬¾å¤„æ€»æ˜¯è¦ç•™ä¸‹è‡ªå·±çš„åå­—ï¼Œç”¨æ¥è¡¨ç¤ºå†™ä¿¡çš„äººæ˜¯è°ã€‚æˆ‘ä»¬ç­¾çš„è¿™ä¸ªå­—å°±æ˜¯ç”Ÿæ´»ä¸­çš„ç­¾åï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030844-196002122.jpg)

è€Œæ•°å­—ç­¾åå‘¢ï¼Ÿå…¶å®ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼Œä»–çš„å«ä¹‰æ˜¯ï¼šåœ¨ç½‘ç»œä¸­ä¼ è¾“æ•°æ®æ—¶å€™ï¼Œç»™æ•°æ®æ·»åŠ ä¸€ä¸ªæ•°å­—ç­¾åï¼Œè¡¨ç¤ºæ˜¯è°å‘çš„æ•°æ®ï¼Œè€Œä¸”è¿˜èƒ½è¯æ˜æ•°æ®æ²¡æœ‰è¢«ç¯¡æ”¹ã€‚

OK**ï¼Œæ•°å­—ç­¾åçš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¿è¯äº†æ•°æ®çš„æœ‰æ•ˆæ€§ï¼ˆéªŒè¯æ˜¯è°å‘çš„ï¼‰å’Œå®Œæ•´æ€§ï¼ˆè¯æ˜ä¿¡æ¯æ²¡æœ‰è¢«ç¯¡æ”¹ï¼‰**ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥å¥½å¥½åœ°çœ‹ä¸€ä¸‹ä»–çš„åº•å±‚å®ç°åŸç†æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚

#### 1.11.2 åŸºæœ¬åŸç†

ä¸ºäº†ç†è§£å¾—æ¸…æ¥šï¼Œæˆ‘ä»¬é€šè¿‡æ¡ˆä¾‹ä¸€æ­¥ä¸€æ­¥æ¥è®²è§£ã€‚è¯è¯´å¼ ä¸‰æœ‰ä¿©å¥½å“¥ä»¬ Aã€Bã€‚ç”±äºå·¥ä½œåŸå› ï¼Œå¼ ä¸‰å’Œ AB å†™é‚®ä»¶çš„æ—¶å€™ä¸ºäº†å®‰å…¨éƒ½éœ€è¦åŠ å¯†ã€‚äºæ˜¯å¼ ä¸‰æƒ³åˆ°äº†æ•°å­—ç­¾åï¼š

æ•´ä¸ªæ€è·¯æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š

ç¬¬ä¸€æ­¥ï¼šåŠ å¯†é‡‡ç”¨éå¯¹ç§°åŠ å¯†ï¼Œå¼ ä¸‰æœ‰ä¸‰æŠŠé’¥åŒ™ï¼Œä¸¤æŠŠå…¬é’¥ï¼Œé€ç»™æœ‹å‹ã€‚ä¸€æŠŠç§é’¥ç•™ç»™è‡ªå·±ã€‚

ç¬¬äºŒæ­¥ï¼šA æˆ–è€… B å†™é‚®ä»¶ç»™å¼ ä¸‰ï¼šA å…ˆç”¨å…¬é’¥å¯¹é‚®ä»¶åŠ å¯†ï¼Œç„¶åå¼ ä¸‰æ”¶åˆ°é‚®ä»¶ä¹‹åä½¿ç”¨ç§é’¥è§£å¯†ã€‚

ç¬¬ä¸‰æ­¥ï¼šå¼ ä¸‰å†™é‚®ä»¶ç»™ A æˆ–è€… Bï¼š

ï¼ˆ1ï¼‰å¼ ä¸‰å†™å®Œé‚®ä»¶ï¼Œå…ˆç”¨ hash å‡½æ•°ç”Ÿæˆé‚®ä»¶çš„æ‘˜è¦ï¼Œé™„ç€åœ¨æ–‡ç« ä¸Šé¢ï¼Œè¿™å°±å®Œæˆäº†æ•°å­—ç­¾åï¼Œç„¶åå¼ ä¸‰å†ä½¿ç”¨ç§é’¥åŠ å¯†ã€‚å°±å¯ä»¥æŠŠé‚®ä»¶å‘å‡ºå»äº†ã€‚

ï¼ˆ2ï¼‰A æˆ–è€…æ˜¯ B æ”¶åˆ°é‚®ä»¶ä¹‹åï¼Œå…ˆæŠŠæ•°å­—ç­¾åå–ä¸‹æ¥ï¼Œç„¶åä½¿ç”¨è‡ªå·±çš„å…¬é’¥è§£å¯†å³å¯ã€‚è¿™æ—¶å€™å–ä¸‹æ¥çš„æ•°å­—ç­¾åä¸­çš„æ‘˜è¦è‹¥å’Œå¼ ä¸‰çš„ä¸€è‡´ï¼Œé‚£å°±è®¤ä¸ºæ˜¯å¼ ä¸‰å‘æ¥çš„ï¼Œå†å¯¹ä¿¡ä»¶æœ¬èº«ä½¿ç”¨ Hash å‡½æ•°ï¼Œå°†å¾—åˆ°çš„ç»“æœï¼Œä¸ä¸Šä¸€æ­¥å¾—åˆ°çš„æ‘˜è¦è¿›è¡Œå¯¹æ¯”ã€‚å¦‚æœä¸¤è€…ä¸€è‡´ï¼Œå°±è¯æ˜è¿™å°ä¿¡æœªè¢«ä¿®æ”¹è¿‡ã€‚

ä¸Šé¢çš„æµç¨‹æˆ‘ä»¬ä½¿ç”¨ä¸€å¼ å›¾æ¥æ¼”ç¤ºä¸€ä¸‹ï¼š

é¦–å…ˆæŠŠå…¬é’¥é€ç»™æœ‹å‹ A å’Œ Bï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030856-2101586966.jpg)

è¿˜æœ‰å°±æ˜¯æœ€åä¸€ä¸ªæ¯”è¾ƒéº»çƒ¦çš„ï¼Œå¼ ä¸‰ç»™ A æˆ–è€… B å‘é‚®ä»¶ï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030881-437673031.jpg)

#### 1.11.3 æ•°å­—è¯ä¹¦

ä¸Šé¢æåˆ°æˆ‘ä»¬å¯¹ç­¾åè¿›è¡ŒéªŒè¯æ—¶ï¼Œéœ€è¦ç”¨åˆ°å…¬é’¥ã€‚å¦‚æœå…¬é’¥æ˜¯ä¼ªé€ çš„ï¼Œé‚£æˆ‘ä»¬æ— æ³•éªŒè¯æ•°å­—ç­¾åäº†ï¼Œä¹Ÿå°±æ ¹æœ¬ä¸å¯èƒ½ä»æ•°å­—ç­¾åç¡®å®šå¯¹æ–¹çš„åˆæ³•æ€§äº†ã€‚è¿™æ—¶å€™è¯ä¹¦å°±é—ªäº®ç™»åœºäº†ã€‚æˆ‘ä»¬å¯èƒ½éƒ½æœ‰è€ƒå„ç§è¯ä¹¦çš„ç»å†ï¼Œæ¯”å¦‚è¯´æ™®é€šè¯è¯ä¹¦ï¼Œå››å…­çº§è¯ä¹¦ç­‰ç­‰ï¼Œä½†æ˜¯å½’æ ¹ç»“åº•ï¼Œåˆ°ä»»ä½•åœºåˆæˆ‘ä»¬éƒ½èƒ½æ‹¿å‡ºæˆ‘ä»¬çš„è¯ä¹¦æ¥è¯æ˜è‡ªå·±ç¡®å®å·²ç»è€ƒè¿‡äº†æ™®é€šè¯ï¼Œè€ƒè¿‡äº†å››å…­çº§ã€‚è¿™é‡Œçš„è¯ä¹¦ä¹Ÿæ˜¯åŒæ ·çš„é“ç†ã€‚

å¦‚æœä¸ç†è§£è¯ä¹¦çš„ä½œç”¨ï¼Œæˆ‘ä»¬å¯ä»¥ä¸¾ä¸€ä¸ªä¾‹å­ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬çš„æ¯•ä¸šè¯ä¹¦ï¼Œä»»ä½•å…¬å¸éƒ½ä¼šæ‰¿è®¤ã€‚ä¸ºä»€ä¹ˆä¼šæ‰¿è®¤ï¼Ÿå› ä¸ºé‚£æ˜¯å›½å®¶å‘å¾—ï¼Œå¤§å®¶éƒ½ä¿¡ä»»å›½å®¶ã€‚ä¹Ÿå°±æ˜¯è¯´åªè¦æ˜¯å›½å®¶çš„è®¤è¯æœºæ„ï¼Œæˆ‘ä»¬éƒ½ä¿¡ä»»å®ƒæ˜¯åˆæ³•çš„ã€‚



é‚£ä¹ˆè¿™ä¸ªè¯ä¹¦æ˜¯å¦‚ä½•ç”Ÿæˆçš„å‘¢ï¼Ÿæˆ‘ä»¬å†æ¥çœ‹ä¸€å¼ å›¾ï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030851-913769888.jpg)

æ­¤æ—¶å³ä½¿å¼ ä¸‰çš„æœ‹å‹ A æŠŠå…¬é’¥å¼„é”™äº†ï¼Œå¼ ä¸‰ä¹Ÿå¯ä»¥é€šè¿‡è¿™ä¸ªè¯ä¹¦éªŒè¯ã€‚



#### 1.11.4 ç½‘é¡µåŠ å¯†

æˆ‘ä»¬çœ‹ä¸€ä¸ªåº”ç”¨ â€œæ•°å­—è¯ä¹¦â€ çš„å®ä¾‹ï¼šhttps åè®®ã€‚è¿™ä¸ªåè®®ä¸»è¦ç”¨äºç½‘é¡µåŠ å¯†

é¦–å…ˆï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘å‡ºåŠ å¯†è¯·æ±‚ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030829-1895593186.jpg)

æœåŠ¡å™¨ç”¨è‡ªå·±çš„ç§é’¥åŠ å¯†ç½‘é¡µä»¥åï¼Œè¿åŒæœ¬èº«çš„æ•°å­—è¯ä¹¦ï¼Œä¸€èµ·å‘é€ç»™å®¢æˆ·ç«¯ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030779-988510624.jpg)

å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰çš„ â€œè¯ä¹¦ç®¡ç†å™¨â€ï¼Œæœ‰â€œå—ä¿¡ä»»çš„æ ¹è¯ä¹¦é¢å‘æœºæ„â€ åˆ—è¡¨ã€‚å®¢æˆ·ç«¯ä¼šæ ¹æ®è¿™å¼ åˆ—è¡¨ï¼ŒæŸ¥çœ‹è§£å¼€æ•°å­—è¯ä¹¦çš„å…¬é’¥æ˜¯å¦åœ¨åˆ—è¡¨ä¹‹å†…ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030849-915897793.jpg)

å¦‚æœæ•°å­—è¯ä¹¦è®°è½½çš„ç½‘å€ï¼Œä¸ä½ æ­£åœ¨æµè§ˆçš„ç½‘å€ä¸ä¸€è‡´ï¼Œå°±è¯´æ˜è¿™å¼ è¯ä¹¦å¯èƒ½è¢«å†’ç”¨ï¼Œæµè§ˆå™¨ä¼šå‘å‡ºè­¦å‘Šã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030784-1046826639.jpg)

å¦‚æœè¿™å¼ æ•°å­—è¯ä¹¦ä¸æ˜¯ç”±å—ä¿¡ä»»çš„æœºæ„é¢å‘çš„ï¼Œæµè§ˆå™¨ä¼šå‘å‡ºå¦ä¸€ç§è­¦å‘Šã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030863-2095075031.jpg)

å¦‚æœæ•°å­—è¯ä¹¦æ˜¯å¯é çš„ï¼Œå®¢æˆ·ç«¯å°±å¯ä»¥ä½¿ç”¨è¯ä¹¦ä¸­çš„æœåŠ¡å™¨å…¬é’¥ï¼Œå¯¹ä¿¡æ¯è¿›è¡ŒåŠ å¯†ï¼Œç„¶åä¸æœåŠ¡å™¨äº¤æ¢åŠ å¯†ä¿¡æ¯ã€‚

![](./images/å¯†ç å­¦/2957590-20230131080030763-11102311.jpg)

#### 1.11.5 ä»£ç å®ç°

```java
import java.security.*;
import com.sun.org.apache.xml.internal.security.utils.Base64;
public class SignatureDemo {
    public static void main(String[] args) throws Exception {
        String a = "123";

        PublicKey publicKey = RsaDemo.loadPublicKeyFromFile("RSA", "a.pub");
        PrivateKey privateKey = RsaDemo.loadPrivateKeyFromFile("RSA", "a.pri");

        String signaturedData = getSignature(a, "sha256withrsa", privateKey);

        boolean b = verifySignature(a, "sha256withrsa", publicKey, signaturedData);

    }

    /**
     * ç”Ÿæˆç­¾å
     *
     * @param input      : åŸæ–‡
     * @param algorithm  : ç®—æ³•
     * @param privateKey : ç§é’¥
     * @return : ç­¾å
     * @throws Exception
     */
    private static String getSignature(String input, String algorithm, PrivateKey privateKey) throws Exception {
        // è·å–ç­¾åå¯¹è±¡
        Signature signature = Signature.getInstance(algorithm);
        // åˆå§‹åŒ–ç­¾å
        signature.initSign(privateKey);
        // ä¼ å…¥åŸæ–‡
        signature.update(input.getBytes());
        // å¼€å§‹ç­¾å
        byte[] sign = signature.sign();
        // å¯¹ç­¾åæ•°æ®è¿›è¡ŒBase64ç¼–ç 
        return Base64.encode(sign);
    }

    /**
     * æ ¡éªŒç­¾å
     *
     * @param input          : åŸæ–‡
     * @param algorithm      : ç®—æ³•
     * @param publicKey      : å…¬é’¥
     * @param signaturedData : ç­¾å
     * @return : æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹
     * @throws Exception
     */
    private static boolean verifySignature(String input, String algorithm, PublicKey publicKey, String signaturedData) throws Exception {
        // è·å–ç­¾åå¯¹è±¡
        Signature signature = Signature.getInstance(algorithm);
        // åˆå§‹åŒ–ç­¾å
        signature.initVerify(publicKey);
        // ä¼ å…¥åŸæ–‡
        signature.update(input.getBytes());
        // æ ¡éªŒæ•°æ®
        return signature.verify(Base64.decode(signaturedData));

    }

}
```





## **æ•°å­—è¯ä¹¦ä½“ç³»**ï¼ˆå³ PKIï¼šPublic Key Infrastructureï¼Œå…¬é’¥åŸºç¡€è®¾æ–½ï¼‰ã€‚

#### CA è®¤è¯ä¸­å¿ƒæ¦‚è¿°

###### ğŸ“Œ ä»€ä¹ˆæ˜¯ CAï¼Ÿ

- **CAï¼ˆCertificate Authorityï¼‰** æ˜¯ä¸€ä¸ª**å…¬æ­£ç¬¬ä¸‰æ–¹**ï¼Œå®ƒä½¿ç”¨ **PKIï¼ˆå…¬é’¥åŸºç¡€è®¾æ–½ï¼‰** æŠ€æœ¯ï¼Œè´Ÿè´£ï¼š
  - æ ¸å®å®ä½“èº«ä»½ï¼ˆå¦‚ç½‘ç«™ã€å…¬å¸ã€ç”¨æˆ·ï¼‰ï¼›
  - ç­¾å‘ã€åŠé”€ã€å½’æ¡£å’Œç®¡ç†æ•°å­—è¯ä¹¦ï¼›
  - æä¾›å¯éªŒè¯çš„æ•°å­—ç­¾åã€‚

###### ğŸ“Œ CA çš„æ€§è´¨

- å¯ä»¥æ˜¯**æ”¿åºœæœºæ„**ï¼ˆå¦‚ä¸­å›½å·¥ä¿¡éƒ¨ä¸‹å±æœºæ„ï¼‰ï¼›
- ä¹Ÿå¯ä»¥æ˜¯**æ°‘é—´å…¬å¸**ï¼ˆå¦‚ DigiCertã€Let's Encryptã€GlobalSignï¼‰ï¼›
- å›½å†…å­˜åœ¨**åŒºåŸŸæ€§ CA**ï¼ˆæœåŠ¡åœ°æ–¹æ”¿åºœ/ä¼ä¸šï¼‰å’Œ**è¡Œä¸šæ€§ CA**ï¼ˆæœåŠ¡é“¶è¡Œã€ç”µå•†ã€åŒ»ç–—ç­‰ç‰¹å®šè¡Œä¸šï¼‰ã€‚

------

##### ğŸ§¾ æ•°å­—è¯ä¹¦ç»“æ„

ä¸€ä¸ªæ•°å­—è¯ä¹¦ä¸»è¦åŒ…æ‹¬ä¸‰éƒ¨åˆ†ä¿¡æ¯ï¼š

| ç»„æˆéƒ¨åˆ† | å«ä¹‰                                                         |
| -------- | ------------------------------------------------------------ |
| ç”¨æˆ·ä¿¡æ¯ | å®ä½“çš„èº«ä»½ï¼Œå¦‚åŸŸåã€ç»„ç»‡åã€ç”µå­é‚®ä»¶åœ°å€ç­‰                   |
| å…¬é’¥     | è¯¥å®ä½“çš„ RSA å…¬é’¥                                            |
| CA ç­¾å  | CA å¯¹ä¸Šé¢ä¿¡æ¯çš„æ•°å­—ç­¾åï¼Œç”¨äºä¿è¯å†…å®¹æœªè¢«ç¯¡æ”¹ä¸”ç¡®å®ç”±è¯¥ CA ç­¾å‘ |



------

##### ğŸ§© è¯ä¹¦é“¾ä¸æ ¹è¯ä¹¦

###### ğŸ§· ä¸ºä»€ä¹ˆéœ€è¦â€œè¯ä¹¦é“¾â€ï¼Ÿ

- CA çš„å…¬é’¥**å¹¶ä¸åœ¨ç”¨æˆ·è¯ä¹¦é‡Œç›´æ¥å­˜å‚¨**ï¼›
- CA çš„å…¬é’¥å­˜åœ¨äºâ€œå®ƒè‡ªå·±çš„è¯ä¹¦â€ä¸­ï¼›
- éªŒè¯è¿™ä¸ªè¯ä¹¦çš„ç­¾åæ—¶ï¼Œåˆéœ€è¦æ›´ä¸Šä¸€çº§ CA çš„è¯ä¹¦â€¦â€¦å°±è¿™æ ·**é€’å½’å‘ä¸Šå½¢æˆâ€œè¯ä¹¦é“¾â€**ã€‚

###### ğŸ æ ¹è¯ä¹¦ï¼ˆRoot Certificateï¼‰

- **è‡ªç­¾åè¯ä¹¦**ï¼ˆç­¾åè€…å’ŒæŒæœ‰è€…éƒ½æ˜¯è‡ªå·±ï¼‰ï¼›
- æ˜¯æ•´ä¸ªä¿¡ä»»ä½“ç³»çš„**ä¿¡ä»»é”šï¼ˆTrust Anchorï¼‰**ï¼›
- è¢«æ“ä½œç³»ç»Ÿ/æµè§ˆå™¨ç­‰è½¯ä»¶**é¢„ç½®ä¸ºâ€œå—ä¿¡ä»»â€**ï¼›
- ä¸€æ—¦ä¿¡ä»»æ ¹è¯ä¹¦ï¼Œå°±**é—´æ¥ä¿¡ä»»æ•´ä¸ªç”±å…¶ç­¾å‘çš„é“¾æ¡**ï¼ˆåŒ…æ‹¬ä¸­é—´ CA å’Œç»ˆç«¯ç”¨æˆ·è¯ä¹¦ï¼‰ã€‚

> **æ€»ç»“ï¼šè¯ä¹¦çš„éªŒè¯è¿‡ç¨‹å°±æ˜¯ä»ç”¨æˆ·è¯ä¹¦é€çº§éªŒè¯ç­¾åï¼Œç›´åˆ°æ ¹è¯ä¹¦ã€‚æ ¹è¯ä¹¦æ˜¯éªŒè¯çš„â€œç»ˆç‚¹â€ã€‚**

------

##### ğŸ” CA çš„èŒè´£å’Œä½œç”¨

CA é™¤äº†ç­¾å‘è¯ä¹¦ä¹‹å¤–ï¼Œè¿˜æ‰¿æ‹…ï¼š

| åŠŸèƒ½ | æè¿°                                   |
| ---- | -------------------------------------- |
| æ‰¹å®¡ | éªŒè¯ç”¨æˆ·èº«ä»½ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰èµ„æ ¼å‘è¯ä¹¦     |
| ç­¾å‘ | ç”¨ CA ç§é’¥ç­¾å‘æ•°å­—è¯ä¹¦                 |
| åŠé”€ | è‹¥è¯ä¹¦å¤±æ•ˆæˆ–æ³„éœ²ï¼Œå¯é€šè¿‡ CRL/OCSP æ’¤é”€ |
| ç®¡ç† | è®°å½•è¯ä¹¦ç”Ÿå‘½å‘¨æœŸã€å½’æ¡£å†å²æ•°æ®ç­‰       |



> CA çš„ç­¾åæ— æ³•è¢«ä»–äººä¼ªé€ æˆ–ç¯¡æ”¹ï¼Œå› ä¸ºåªæœ‰å®ƒæŒæ¡ç§é’¥ï¼Œç¯¡æ”¹åç­¾åéªŒè¯ä¼šå¤±è´¥ã€‚

------

##### ğŸ§‘â€ğŸ¤â€ğŸ§‘ A å’Œ B çš„é€šä¿¡åœºæ™¯ï¼ˆä¾‹å¦‚ SSL/TLSï¼‰

1. **A å’Œ B è·å–å¯¹æ–¹è¯ä¹¦**ï¼›
2. **éªŒè¯è¯ä¹¦é“¾åˆæ³•æ€§**ï¼›
3. **æå–å…¬é’¥ç”¨äºåŠ å¯†/ç­¾å**ï¼›
4. è‹¥åŒæ–¹çš„è¯ä¹¦ç”±ä¸åŒ CA ç­¾å‘ï¼Œåªè¦**ä¸¤ä¸ª CA éƒ½èƒ½è¿½æº¯åˆ°å—ä¿¡ä»»çš„æ ¹ CA**ï¼Œé€šä¿¡ä¾ç„¶æ˜¯å®‰å…¨å¯ä¿¡çš„ã€‚

------

##### ğŸ“Œ è¡¥å……ï¼šä¸ºä½•å¿…é¡»â€œå…ˆä¸‹è½½æ ¹è¯ä¹¦â€ï¼Ÿ

- åœ¨æ“ä½œç³»ç»Ÿã€æµè§ˆå™¨æˆ–è½¯ä»¶ä¸­é¢„ç½®çš„æ ¹è¯ä¹¦å³ä¸ºâ€œä¿¡ä»»çš„èµ·ç‚¹â€ï¼›
- å¦‚æœæŸæ ¹è¯ä¹¦ä¸åœ¨ä½ çš„â€œå—ä¿¡ä»»æ ¹åˆ—è¡¨â€ä¸­ï¼Œå³ä½¿å®ƒç­¾å‘çš„ç”¨æˆ·è¯ä¹¦ç»“æ„åˆæ³•ï¼Œä¹Ÿä¼šæç¤ºâ€œä¸å—ä¿¡ä»»â€ï¼›
- æ‰€ä»¥åœ¨æŸäº›ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œéœ€è¦ç”¨æˆ·**æ‰‹åŠ¨å®‰è£…è¯¥ç³»ç»ŸæŒ‡å®šçš„æ ¹è¯ä¹¦**ï¼Œæ‰èƒ½é¡ºåˆ©é€šä¿¡ã€‚

------

##### âœ… æ€»ç»“é‡ç‚¹å›é¡¾

- CA æ˜¯é¢å‘æ•°å­—è¯ä¹¦çš„ç¬¬ä¸‰æ–¹æœºæ„ï¼Œè´Ÿè´£èº«ä»½è®¤è¯ä¸ç­¾åã€‚

- æ•°å­—è¯ä¹¦åŒ…å«èº«ä»½ã€å…¬é’¥ã€CA ç­¾åã€‚

- éªŒè¯è¯ä¹¦ä¾èµ–äºâ€œè¯ä¹¦é“¾â€ï¼Œæœ€ç»ˆè¿½æº¯åˆ°ç³»ç»Ÿä¿¡ä»»çš„æ ¹è¯ä¹¦ã€‚

- æ ¹è¯ä¹¦æ˜¯ä¿¡ä»»é“¾çš„èµ·ç‚¹ï¼Œæ˜¯è‡ªç­¾åçš„è¯ä¹¦ï¼Œå¿…é¡»æ˜ç¡®ä¿¡ä»»å®ƒã€‚

- CA æ‹¥æœ‰å…¬ä¿¡åŠ›ï¼Œç¯¡æ”¹è¯ä¹¦å†…å®¹å°†å¯¼è‡´ç­¾åéªŒè¯å¤±è´¥ã€‚

  

#### ä¸€ã€è¯ä¹¦çš„ç”Ÿæˆè¿‡ç¨‹ï¼ˆç”± CA å®Œæˆï¼‰

1. **CA ç”Ÿæˆå¯†é’¥å¯¹**ï¼š
   - CAï¼ˆCertificate Authorityï¼Œè¯ä¹¦ç­¾å‘æœºæ„ï¼‰ç”Ÿæˆä¸€å¯¹ RSA å…¬ç§é’¥ã€‚
   - å…¬é’¥å°†ç”¨äºéªŒè¯ç­¾åï¼Œç§é’¥ç”¨äºç­¾åè¯ä¹¦ã€‚
2. **ç”Ÿæˆå¾…ç­¾åçš„ä¿¡æ¯ P**ï¼ˆç§°ä¸ºè¯ä¹¦æ­£æ–‡ï¼‰ï¼š
   - åŒ…æ‹¬ï¼šç”¨æˆ·çš„å…¬é’¥ã€å…¬é’¥æŒæœ‰è€…çš„èº«ä»½ä¿¡æ¯ï¼ˆç­¾å‘è€…IDï¼‰ã€æœ‰æ•ˆæœŸã€ç”¨é€”ï¼ˆå¦‚ SSLã€ä»£ç ç­¾åç­‰ï¼‰ã€åºåˆ—å·ã€ç®—æ³•æ ‡è¯†ç­‰ã€‚
3. **è®¡ç®—å“ˆå¸Œ**ï¼š
   - å¯¹ P è®¡ç®—å“ˆå¸Œå€¼ï¼Œå¾—åˆ° `H = hash(P)`ã€‚
4. **ç­¾å**ï¼š
   - ç”¨ CA çš„ç§é’¥å¯¹ H åŠ å¯†ï¼š`S = Encrypt(H, CAç§é’¥)`ï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšç­¾åã€‚
5. **ç”Ÿæˆæ•°å­—è¯ä¹¦**ï¼š
   - æ•°å­—è¯ä¹¦ = `(P, S)`ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸º `Cert = (P, Signature)`ã€‚

------

#### äºŒã€éªŒè¯è¯ä¹¦çš„è¿‡ç¨‹ï¼ˆç”±ç”¨æˆ·/å®¢æˆ·ç«¯å®Œæˆï¼‰

1. **æå–å…¬é’¥**ï¼š
   - ä»è¯ä¹¦ä¸­çš„ P ä¸­æå–å‡º CA çš„å…¬é’¥æˆ–å·²çŸ¥å…¶ä¸Šçº§ CA çš„å…¬é’¥ã€‚
2. **éªŒè¯ç­¾å**ï¼š
   - ç”¨ CA çš„å…¬é’¥å¯¹ç­¾å S è§£å¯†ï¼š`H1 = Decrypt(S, CAå…¬é’¥)`ã€‚
   - é‡æ–°è®¡ç®— P çš„å“ˆå¸Œå€¼ï¼š`H2 = hash(P)`ã€‚
   - è‹¥ `H1 == H2`ï¼Œè¯´æ˜ï¼š
     - è¯ä¹¦ä¸­çš„ P æ²¡è¢«ç¯¡æ”¹ï¼›
     - è¯¥è¯ä¹¦ç¡®å®æ˜¯ç”±æŒæœ‰è¯¥ç§é’¥çš„ CA ç­¾å‘çš„ã€‚
3. **æ£€æŸ¥æœ‰æ•ˆæœŸã€åŠé”€åˆ—è¡¨**ï¼š
   - æ£€æŸ¥è¯ä¹¦æ˜¯å¦è¿‡æœŸï¼›
   - æŸ¥è¯¢æ˜¯å¦åœ¨ CRLï¼ˆè¯ä¹¦åŠé”€åˆ—è¡¨ï¼‰æˆ–é€šè¿‡ OCSPï¼ˆåœ¨çº¿è¯ä¹¦çŠ¶æ€åè®®ï¼‰æ£€æŸ¥æ˜¯å¦è¢«åŠé”€ã€‚

------

#### ä¸‰ã€å¦‚ä½•åˆ¤æ–­ä¸€ä¸ª CA æ˜¯â€œå¯ä¿¡â€çš„ï¼Ÿ

ä½ æåˆ°äº†ä¸€ä¸ªå…³é”®é—®é¢˜ï¼šâ€œé»‘å®¢ä¹Ÿå¯ä»¥ä¼ªé€  CA ç»™è‡ªå·±å‘è¯ä¹¦ï¼Œæˆ‘ä»¬æ€ä¹ˆçŸ¥é“æŸä¸ªè¯ä¹¦æ˜¯å¦çœŸçš„æ¥è‡ªæƒå¨ CAï¼Ÿâ€

ç­”æ¡ˆæ˜¯ï¼š**é€šè¿‡è¯ä¹¦é“¾ + æ ¹è¯ä¹¦ä¿¡ä»»æœºåˆ¶**

1. **è¯ä¹¦é“¾ï¼ˆCertificate Chainï¼‰**ï¼š
   - ä¸€ä¸ªæ™®é€šç”¨æˆ·çš„è¯ä¹¦é€šå¸¸ç”±ä¸­çº§ CA ç­¾å‘ï¼›
   - ä¸­çº§ CA åˆç”±æ›´ä¸Šä¸€çº§ CA ç­¾å‘ï¼›
   - ä¸€ç›´å‘ä¸Šç›´åˆ°**æ ¹ CAï¼ˆRoot CAï¼‰**ï¼›
   - æ¯ä¸€çº§çš„è¯ä¹¦éƒ½é™„å¸¦ä¸Šä¸€çº§çš„ç­¾åï¼Œå½¢æˆâ€œé“¾æ¡â€ã€‚
2. **æ ¹è¯ä¹¦ï¼ˆRoot Certificateï¼‰æ˜¯é¢„è®¾å¯ä¿¡çš„**ï¼š
   - æ ¹ CA çš„å…¬é’¥ï¼ˆå³æ ¹è¯ä¹¦ï¼‰äº‹å…ˆåµŒå…¥åœ¨æ“ä½œç³»ç»Ÿã€æµè§ˆå™¨ã€æ‰‹æœºç³»ç»Ÿä¸­ï¼ˆä¾‹å¦‚ Windowsã€macOSã€Androidã€Chromeã€Firefoxï¼‰ï¼›
   - è¿™äº›æ ¹è¯ä¹¦ç”±è®¾å¤‡å‚å•†æˆ–è½¯ä»¶å‚å•†æ§åˆ¶ï¼Œå®ƒä»¬å†³å®šå“ªäº› CA æ˜¯â€œå¯ä¿¡çš„â€ã€‚
3. **å®¢æˆ·ç«¯éªŒè¯è·¯å¾„å¦‚ä¸‹**ï¼š
   - æ‹¿åˆ°æŸä¸ªç½‘ç«™æˆ–æœåŠ¡çš„è¯ä¹¦åï¼Œé€çº§éªŒè¯æ¯ä¸€å±‚çš„ç­¾åï¼Œç›´åˆ°æŸä¸ªè¯ä¹¦çš„ç­¾å‘è€…æ˜¯ä½ ç³»ç»Ÿä¿¡ä»»çš„æ ¹ CAï¼›
   - å¦‚æœæ•´æ¡é“¾éƒ½éªŒè¯é€šè¿‡ï¼Œè¯´æ˜è¿™ä¸ªè¯ä¹¦æ˜¯â€œå¯ä¿¡çš„â€ã€‚



## 1.12 keytool å·¥å…·ä½¿ç”¨

keytool å·¥å…·è·¯å¾„ï¼š`C:\Program Files\Java\jre1.8.0_91\bin`

![](./images/å¯†ç å­¦/2957590-20230131080030767-2053565816.jpg)

å¸¸ç”¨å‘½ä»¤ï¼š  
ç”Ÿæˆ keypair  
keytool -genkeypair  
keytool -genkeypair -alias lisiï¼ˆåé¢éƒ¨åˆ†æ˜¯ä¸ºè¯ä¹¦æŒ‡å®šåˆ«åï¼Œå¦åˆ™é‡‡ç”¨é»˜è®¤çš„åç§°ä¸º mykeyï¼‰

çœ‹çœ‹ keystore ä¸­æœ‰å“ªäº›é¡¹ç›®ï¼š  
keytool -list æˆ– keytool -list -v  
keytool -exportcert -alias lisi -file lisi.cer

ç”Ÿæˆå¯æ‰“å°çš„è¯ä¹¦ï¼š  
keytool -exportcert -alias lisi -file lisi.cer â€“rfc

æ˜¾ç¤ºæ•°å­—è¯ä¹¦æ–‡ä»¶ä¸­çš„è¯ä¹¦ä¿¡æ¯ï¼š  
keytool -printcert -file lisi.cer  
ç›´æ¥åŒå‡» lisi.cerï¼Œç”¨ window ç³»ç»Ÿçš„å†…ç½®ç¨‹åºæ‰“å¼€ lisi.cer

#### 1.12.1 ç”Ÿæˆç§é’¥å…¬é’¥

(1) ç”Ÿæˆå¯†é’¥è¯ä¹¦ ä¸‹è¾¹å‘½ä»¤ç”Ÿæˆå¯†é’¥è¯ä¹¦ï¼Œé‡‡ç”¨ RSA ç®—æ³•æ¯ä¸ªè¯ä¹¦åŒ…å«å…¬é’¥å’Œç§é’¥

åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåœ¨è¯¥æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¡Œï¼š

```
keytool -genkeypair -alias guigu -keyalg RSA -keypass guigu -keystore guigu.jks -storepass guigu
```

Keytool æ˜¯ä¸€ä¸ª java æä¾›çš„è¯ä¹¦ç®¡ç†å·¥å…·

```
-aliasï¼šå¯†é’¥çš„åˆ«å 
-keyalgï¼šä½¿ç”¨çš„hashç®—æ³• 
-keypassï¼šå¯†é’¥çš„è®¿é—®å¯†ç  
-keystoreï¼šå¯†é’¥åº“æ–‡ä»¶åï¼Œxc.keystoreä¿å­˜äº†ç”Ÿæˆçš„è¯ä¹¦ 
-storepassï¼šå¯†é’¥åº“çš„è®¿é—®å¯†ç 
```

(2) æŸ¥è¯¢è¯ä¹¦ä¿¡æ¯

```
keytool -list -keystore guigu.jks
```

(3) åˆ é™¤åˆ«å

```
keytool -delete -alias guigu -keystore guigu.jsk
```

#### 1.12.2 å¯¼å‡ºå…¬é’¥

openssl æ˜¯ä¸€ä¸ªåŠ è§£å¯†å·¥å…·åŒ…ï¼Œè¿™é‡Œä½¿ç”¨ openssl æ¥å¯¼å‡ºå…¬é’¥ä¿¡æ¯ã€‚

å®‰è£… opensslï¼š`http://slproweb.com/products/Win32OpenSSL.html`

å®‰è£…èµ„æ–™ç›®å½•ä¸‹çš„ Win64OpenSSL-1_1_0g.exe

é…ç½® openssl çš„ path ç¯å¢ƒå˜é‡ï¼Œå¦‚ä¸‹å›¾ï¼š

![](./images/å¯†ç å­¦/2957590-20230131080030765-1910411941.jpg)

æœ¬æ•™ç¨‹é…ç½®åœ¨ C:\OpenSSL-Win64\bin

cmd è¿›å…¥ guigu.jks æ–‡ä»¶æ‰€åœ¨ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ (å¦‚ä¸‹å‘½ä»¤åœ¨ windows ä¸‹æ‰§è¡Œï¼Œä¼šæŠŠ - å˜æˆä¸­æ–‡æ–¹å¼ï¼Œè¯·å°†å®ƒæ”¹æˆè‹±æ–‡çš„ -)ï¼š

```
keytool -list -rfc --keystore guigu.jks | openssl x509 -inform pem -pubkey
```

ä¸‹é¢æ®µå†…å®¹æ˜¯å…¬é’¥

```
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAvFsEiaLvij9C1Mz+oyAm
t47whAaRkRu/8kePM+X8760UGU0RMwGti6Z9y3LQ0RvK6I0brXmbGB/RsN38PVnh
cP8ZfxGUH26kX0RK+tlrxcrG+HkPYOH4XPAL8Q1lu1n9x3tLcIPxq8ZZtuIyKYEm
oLKyMsvTviG5flTpDprT25unWgE4md1kthRWXOnfWHATVY7Y/r4obiOL1mS5bEa/
iNKotQNnvIAKtjBM4RlIDWMa6dmz+lHtLtqDD2LF1qwoiSIHI75LQZ/CNYaHCfZS
xtOydpNKq8eb1/PGiLNolD4La2zf0/1dlcr5mkesV570NxRmU1tFm8Zd3MZlZmyv
9QIDAQAB
-----END PUBLIC KEY-----
```

å°†ä¸Šè¾¹çš„å…¬é’¥æ‹·è´åˆ°æ–‡æœ¬ public.key æ–‡ä»¶ä¸­ï¼Œåˆå¹¶ä¸ºä¸€è¡Œ, å¯ä»¥å°†å®ƒæ”¾åˆ°éœ€è¦å®ç°æˆæƒè®¤è¯çš„å·¥ç¨‹ä¸­ã€‚

# ç¬¬äºŒç«  SpringBoot é›†æˆ Swagger2



### 2.1 åˆ›å»ºé¡¹ç›®Â `encryptcase`

![](./images/å¯†ç å­¦/2957590-20230131080030724-743482684.jpg)

å¯¼å…¥ pom æ–‡ä»¶

```xml
<parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>2.1.6.RELEASE</version>
    </parent>

    <properties>
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <maven.compiler.source>1.8</maven.compiler.source>
        <maven.compiler.target>1.8</maven.compiler.target>
    </properties>

    <dependencies>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>
        <dependency>
            <groupId>mysql</groupId>
            <artifactId>mysql-connector-java</artifactId>
        </dependency>
        <!--swagger2-->
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger2</artifactId>
            <version>2.8.0</version>
        </dependency>
        <dependency>
            <groupId>io.springfox</groupId>
            <artifactId>springfox-swagger-ui</artifactId>
            <version>2.8.0</version>
        </dependency>
         <dependency>
            <groupId>commons-io</groupId>
            <artifactId>commons-io</artifactId>
            <version>2.6</version>
        </dependency>
    </dependencies>
```

åˆ›å»ºæ•°æ®åº“

```sql
CREATE DATABASE USER;
USE USER;
CREATE TABLE USER(
  id INT PRIMARY KEY AUTO_INCREMENT,
  username VARCHAR(20),
  password VARCHAR(50),

)
```

#### 2.2 åˆ›å»ºå¯åŠ¨ç±»

```java
package com.atguigu.encryptcase;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class EncryptcaseApplication {

    public static void main(String[] args) {
        SpringApplication.run(EncryptcaseApplication.class, args);
    }
}
```

#### 2.3 åˆ›å»º javabean

```java
package com.atguigu.encryptcase.bean;

import javax.persistence.*;
import java.io.Serializable;

@Entity
@Table()
public class User implements Serializable {
    @Id
    @GeneratedValue(strategy= GenerationType.IDENTITY)
    @Column()
    private Integer id;
    private String username;
    private String password;
 
    public User() {
    }

    public User(Integer id, String username, String password) {
        this.id = id;
        this.username = username;
        this.password = password;
    }

    public Integer getId() {
        return id;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public String getUsername() {
        return username;
    }

    public void setUsername(String username) {
        this.username = username;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }
}
```

#### 2.4 åˆ›å»º dao

```java
package com.atguigu.encryptcase.dao;

import com.atguigu.encryptcase.bean.User;
import org.springframework.data.jpa.repository.JpaRepository;

public interface UserDao extends JpaRepository<User, Integer> {


}
```

#### 2.5 åˆ›å»º servcie

```java
package com.atguigu.encryptcase.service;

import com.atguigu.encryptcase.bean.User;

import java.util.List;

public interface UserService {
    void addUser(User user);

    void delUser(Integer id);

    void updateUser(User user);

    List<User> findAll();

}



package com.atguigu.encryptcase.service.impl;

import com.atguigu.encryptcase.bean.User;
import com.atguigu.encryptcase.dao.UserDao;
import com.atguigu.encryptcase.service.UserService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Service
@Transactional
public class UserServiceImpl implements UserService {

    @Autowired
    private UserDao userDao;

    @Override
    public void addUser(User user) {
        userDao.save(user);
    }

    @Override
    public void delUser(Integer id) {
        userDao.delete(id);
    }

    @Override
    public void updateUser(User user) {
        userDao.save(user);
    }

    @Override
    public List<User> findAll() {
        return userDao.findAll();
    }

}
```

#### 2.6 åˆ›å»º controller

```java
package com.atguigu.encryptcase.controller;

import com.atguigu.encryptcase.bean.User;
import com.atguigu.encryptcase.service.UserService;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RestController
public class UserController {
    @Autowired
    private UserService userService;

    @RequestMapping(value = "/addUser", method = RequestMethod.POST)
    public String addUser(User user) {
        try {
            userService.addUser(user);
            return "æ·»åŠ ç”¨æˆ·æˆåŠŸ";
        } catch (Exception e) {
            return "æ·»åŠ ç”¨æˆ·å¤±è´¥:" + e.getMessage();
        }
    }

    @RequestMapping(value = "/addUser", method = RequestMethod.DELETE)
    public String delUser(int id) {
        try {
            userService.delUser(id);
            return "åˆ é™¤ç”¨æˆ·æˆåŠŸ";
        } catch (Exception e) {
            return "åˆ é™¤ç”¨æˆ·å¤±è´¥:" + e.getMessage();
        }
    }

    @RequestMapping(value = "/updateUser", method = RequestMethod.PUT)
    public String updateUser(User user) {
        try {
            userService.updateUser(user);
            return "æ›´æ–°ç”¨æˆ·æˆåŠŸ";
        } catch (Exception e) {
            return "æ›´æ–°ç”¨æˆ·å¤±è´¥:" + e.getMessage();
        }
    }

    @RequestMapping(value = "/findAll", method = RequestMethod.GET)
    public List<User> findAll() {

        return userService.findAll();

    }
}
```

åœ¨Â `resources` æ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»ºæ•°æ®åº“é…ç½®æ–‡ä»¶

```yaml
spring:
  datasource:
    username: root
    password: root
    url: jdbc:mysql://127.0.0.1:3306/test?useUnicode=true&characterEncoding=utf8
    driver-class-name: com.mysql.jdbc.Driver
```

è¿è¡Œé¡¹ç›®

### 2.2 é›†æˆ Swagger2

ç°å¦‚ä»Šï¼Œå‰åç«¯åˆ†ç¦»å·²ç»é€æ¸æˆä¸ºäº’è”ç½‘é¡¹ç›®ä¸€ç§æ ‡å‡†çš„å¼€å‘æ–¹å¼ï¼Œå‰ç«¯ä¸åç«¯äº¤ç»™ä¸åŒçš„äººå‘˜å¼€å‘ï¼Œ

ä½†æ˜¯é¡¹ç›®å¼€å‘ä¸­çš„æ²Ÿé€šæˆæœ¬ä¹Ÿéšä¹‹å‡é«˜ï¼Œè¿™éƒ¨åˆ†æ²Ÿé€šæˆæœ¬ä¸»è¦åœ¨äºå‰ç«¯å¼€å‘äººå‘˜ä¸åç«¯å¼€å‘äººå‘˜å¯¹ WebAPI æ¥å£çš„æ²Ÿé€šï¼ŒSwagger2 å°±å¯ä»¥å¾ˆå¥½åœ°è§£å†³ï¼Œå®ƒå¯ä»¥åŠ¨æ€ç”Ÿæˆ Api æ¥å£æ–‡æ¡£ï¼Œé™ä½æ²Ÿé€šæˆæœ¬ï¼Œä¿ƒè¿›é¡¹ç›®é«˜æ•ˆå¼€å‘ã€‚

æœ‰æ—¶å€™å®šä¹‰äº†æ–‡æ¡£ï¼Œä»£ç ä¸­ä¿®æ”¹äº†ä¸€ç‚¹å°çš„ä¸œè¥¿ï¼Œæ€»ä¼šå¿˜è®°åŒæ­¥ä¿®æ”¹æ–‡æ¡£ï¼Œæ—¶é—´é•¿äº†ï¼Œè‡ªå·±éƒ½æ¯”è¾ƒè’™ï¼Œè¿˜éœ€è¦çœ‹ä¸€ä¸‹ä»£ç æ‰èƒ½å‘ç°é—®é¢˜ã€‚

#### 2.2.0 swagger ä»‹ç»

OpenAPI è§„èŒƒï¼ˆOpenAPI Specification ç®€ç§° OASï¼‰æ˜¯ Linux åŸºé‡‘ä¼šçš„ä¸€ä¸ªé¡¹ç›®ï¼Œè¯•å›¾é€šè¿‡å®šä¹‰ä¸€ç§ç”¨æ¥æè¿° API æ ¼  
å¼æˆ– API å®šä¹‰çš„è¯­è¨€ï¼Œæ¥è§„èŒƒ RESTful æœåŠ¡å¼€å‘è¿‡ç¨‹ï¼Œç›®å‰ç‰ˆæœ¬æ˜¯ V3.0ï¼Œå¹¶ä¸”å·²ç»å‘å¸ƒå¹¶å¼€æºåœ¨ github ä¸Šã€‚  
`ï¼ˆhttps://github.com/OAI/OpenAPI-Specificationï¼‰`  
Swagger æ˜¯å…¨çƒæœ€å¤§çš„ OpenAPI è§„èŒƒï¼ˆOASï¼‰API å¼€å‘å·¥å…·æ¡†æ¶ï¼Œæ”¯æŒä»è®¾è®¡å’Œæ–‡æ¡£åˆ°æµ‹è¯•å’Œéƒ¨ç½²çš„æ•´ä¸ª API ç”Ÿå‘½å‘¨  
æœŸçš„å¼€å‘ã€‚`(https://swagger.io/)`  
Spring Boot å¯ä»¥é›†æˆ Swaggerï¼Œç”Ÿæˆ Swagger æ¥å£ï¼ŒSpring Boot æ˜¯ Java é¢†åŸŸçš„ç¥å™¨ï¼Œå®ƒæ˜¯ Spring é¡¹ç›®ä¸‹å¿«é€Ÿæ„å»º  
é¡¹ç›®çš„æ¡†æ¶

#### 2.2.1 swagger çš„åŸºç¡€æ³¨è§£ä»‹ç»

swagger é€šè¿‡æ³¨è§£ç”Ÿæˆæ¥å£æ–‡æ¡£ï¼ŒåŒ…æ‹¬æ¥å£åã€è¯·æ±‚æ–¹æ³•ã€å‚æ•°ã€è¿”å›ä¿¡æ¯çš„ç­‰ç­‰ã€‚

```java
@Apiï¼šä¿®é¥°æ•´ä¸ªç±»ï¼Œæè¿°Controllerçš„ä½œç”¨
@ApiOperationï¼šæè¿°ä¸€ä¸ªç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ–è€…è¯´ä¸€ä¸ªæ¥å£
@ApiParamï¼šå•ä¸ªå‚æ•°æè¿°
@ApiModelï¼šç”¨å¯¹è±¡å®ä½“æ¥ä½œä¸ºå…¥å‚
@ApiPropertyï¼šç”¨å¯¹è±¡æ¥å®ä½“æ”¶å‚æ•°æ—¶ï¼Œæè¿°å¯¹è±¡çš„ä¸€ä¸ªå­—æ®µ
@ApiResponseï¼šHTTPå“åº”å…¶ä¸­1ä¸ªæè¿°
@ApiResponsesï¼šHTTPå“åº”æ•´ä½“æè¿°
@ApiIgnoreï¼šä½¿ç”¨è¯¥æ³¨è§£å¿½ç•¥è¿™ä¸ªAPI
@ApiError ï¼šå‘ç”Ÿé”™è¯¯è¿”å›çš„ä¿¡æ¯
@ApiImplicitParamï¼šä¸€ä¸ªè¯·æ±‚å‚æ•°
@ApiImplicitParamsï¼š å¤šä¸ªè¯·æ±‚å‚æ•°
```

2.1ã€@Api ä¿®é¥°æ•´ä¸ªç±»ï¼Œæè¿° Controller çš„ä½œç”¨

```java
@RestController
@RequestMapping("/swagger")
@Api(value = "swagger2çš„demoä¾‹å­")
public class SwaggerController {
    
}
```

2.2ã€@ApiOperation

ç”¨äºæè¿°ä¸€ä¸ªæ–¹æ³•æˆ–è€…æ¥å£

å¯ä»¥æ·»åŠ çš„å‚æ•°å½¢å¼ï¼š@ApiOperation(value = â€œæ¥å£è¯´æ˜â€, httpMethod = â€œæ¥å£è¯·æ±‚æ–¹å¼â€, response = â€œæ¥å£è¿”å›å‚æ•°ç±»å‹â€, notes = â€œæ¥å£å‘å¸ƒè¯´æ˜â€ï¼‰

```java
@RequestMapping("/swagger")
@ResponseBody
@ApiOperation(value = "æ ¹æ®ç”¨æˆ·åè·å–ç”¨æˆ·çš„ä¿¡æ¯",notes = "æŸ¥è¯¢æ•°æ®åº“ä¸­çš„è®°å½•",httpMethod = "POST",response = String.class)
    public String getUserInfo(String userName) {
        return "1234";
    }
}
```

2.3ã€@ApiImplicitParam ä¸€ä¸ªè¯·æ±‚å‚æ•°

@ApiImplicitParam(required = â€œæ˜¯å¦å¿…é¡»å‚æ•°â€, name = â€œå‚æ•°åç§°â€, value = â€œå‚æ•°å…·ä½“æè¿°â€, dateType =â€œå˜é‡ç±»å‹â€, paramType =â€ è¯·æ±‚æ–¹å¼â€ï¼‰

```java
@ApiImplicitParam(name = "userName",value = "ç”¨æˆ·å",required = true,dataType = "String",paramType = "query")
    public String getUserInfo(String userName) {
        return "1234";
    }
}
```

2.5ã€@ApiImplicitParams å¤šä¸ªè¯·æ±‚å‚æ•°

å‚æ•°å’Œ @ApiImplicitParam ä¸€è‡´ï¼Œåªæ˜¯è¿™ä¸ªæ³¨è§£å¯ä»¥æ·»åŠ å¤šä¸ªå‚æ•°è€Œå·²

```java
@ApiImplicitParams({
    @ApiImplicitParam(name = "nickName",value = "ç”¨æˆ·çš„æ˜µç§°",paramType = "query",dataType = "String",required = true),
    @ApiImplicitParam(name = "id",value = "ç”¨æˆ·çš„ID",paramType = "query",dataType = "Integer",required = true)
})
public String getUserInfoByNickName(String nickName, Integer id) {
    return "1234";
}
```

#### 2.2.2 ä»£ç ä¸­æ·»åŠ  swagger æ³¨è§£

![](./images/å¯†ç å­¦/2957590-20230131080030778-1738763946.jpg)

```java
package com.atguigu.encryptcase.controller;

import com.atguigu.encryptcase.bean.User;
import com.atguigu.encryptcase.service.UserService;
import io.swagger.annotations.Api;
import io.swagger.annotations.ApiOperation;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;
/**
 * RestController
 *
 * @Author: å°šç¡…è°·
 * @CreateTime: 2020-03-26
 * @Description:
 */
@Api(tags = "æä¾›ç”¨æˆ·çš„å¢åˆ æ”¹æŸ¥çš„åŠŸèƒ½")
@RestController
public class UserController {
    @Autowired
    private UserService userService;

    @ApiOperation(value = "æ·»åŠ ç”¨æˆ·")
    @RequestMapping(value = "/addUser", method = RequestMethod.POST)
    public String addUser(User user) {
        try {
            userService.addUser(user);
            return "æ·»åŠ ç”¨æˆ·æˆåŠŸ";
        } catch (Exception e) {
            return "æ·»åŠ ç”¨æˆ·å¤±è´¥:" + e.getMessage();
        }
    }

    @ApiOperation(value = "åˆ é™¤ç”¨æˆ·")
    @RequestMapping(value = "/addUser", method = RequestMethod.DELETE)
    public String delUser(int id) {
        try {
            userService.delUser(id);
            return "åˆ é™¤ç”¨æˆ·æˆåŠŸ";
        } catch (Exception e) {
            return "åˆ é™¤ç”¨æˆ·å¤±è´¥:" + e.getMessage();
        }
    }

    @ApiOperation(value = "æ›´æ–°ç”¨æˆ·")
    @RequestMapping(value = "/updateUser", method = RequestMethod.PUT)
    public String updateUser(User user) {
        try {
            userService.updateUser(user);
            return "æ›´æ–°ç”¨æˆ·æˆåŠŸ";
        } catch (Exception e) {
            return "æ›´æ–°ç”¨æˆ·å¤±è´¥:" + e.getMessage();
        }
    }

    @ApiOperation(value = "æŸ¥è¯¢ç”¨æˆ·")
    @RequestMapping(value = "/findAll", method = RequestMethod.GET)
    public List<User> findAll() {

        return userService.findAll();

    }
}
```

è¿è¡Œç¨‹åº ï¼š`http://localhost:8080/swagger-ui.html`

![](./images/å¯†ç å­¦/2957590-20230131080030785-792789455.jpg)

å±•å¼€æ¥å£å†…éƒ¨

![](./images/å¯†ç å­¦/2957590-20230131080030768-100630901.jpg)

ç‚¹å‡» try it out è¾“å…¥å§“åï¼Œ Execute æ‰§è¡Œï¼Œè¿”å›å¦‚ä¸‹å›¾æ•ˆæœ

![](./images/å¯†ç å­¦/2957590-20230131080030767-1614026152.jpg)

æŸ¥çœ‹æ•°æ®åº“è¡¨ï¼Œæ•°æ®å·²ç»æ·»åŠ åˆ°æ•°æ®åº“

![](./images/å¯†ç å­¦/2957590-20230131080030737-159658.jpg)

### 2.4 è´­ç‰©åŠŸèƒ½

æ¨¡æ‹Ÿè´­ç‰©åœºæ™¯ï¼Œç”¨æˆ·ç‚¹å‡»è´­ç‰©çš„æ—¶å€™ï¼Œåœ¨å‰ç«¯ç”Ÿæˆç­¾åä¿¡æ¯ï¼Œä¼ é€’ç»™åå°æœåŠ¡å™¨è¿›è¡Œæ ¡éªŒï¼Œå¦‚æœä»·æ ¼ï¼Œæ•°é‡ï¼Œç­¾åéƒ½æ­£ç¡®ï¼Œè´­ç‰©æˆåŠŸï¼Œå¦‚æœè¢«äººä¿®æ”¹ï¼Œè´­ç‰©å¤±è´¥

![](./images/å¯†ç å­¦/2957590-20230131080030861-300498633.jpg)

æ‹·è´ä»Šå¤©å’±ä»¬å†™çš„ ä¸¤ä¸ªä»£ç Â `RsaDemo.java`Â å’ŒÂ `SignatureDemo.java`

```java
package com.atguigu.encryptcase.utils;

import com.sun.org.apache.xml.internal.security.utils.Base64;
import org.apache.commons.io.FileUtils;

import javax.crypto.Cipher;
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.nio.charset.Charset;
import java.security.*;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;

public class RsaDemo {

    public static void main(String[] args) throws Exception {

        generateKeyToFile("RSA", "a.pub", "a.pri");
    }

    /**
     * ç”Ÿæˆå¯†é’¥å¯¹å¹¶ä¿å­˜åœ¨æœ¬åœ°æ–‡ä»¶ä¸­
     *
     * @param algorithm : ç®—æ³•
     * @param pubPath   : å…¬é’¥ä¿å­˜è·¯å¾„
     * @param priPath   : ç§é’¥ä¿å­˜è·¯å¾„
     * @throws Exception
     */
    public static void generateKeyToFile(String algorithm, String pubPath, String priPath) throws Exception {
        // è·å–å¯†é’¥å¯¹ç”Ÿæˆå™¨
        KeyPairGenerator keyPairGenerator = KeyPairGenerator.getInstance(algorithm);
        // è·å–å¯†é’¥å¯¹
        KeyPair keyPair = keyPairGenerator.generateKeyPair();
        // è·å–å…¬é’¥
        PublicKey publicKey = keyPair.getPublic();
        // è·å–ç§é’¥
        PrivateKey privateKey = keyPair.getPrivate();
        // è·å–byteæ•°ç»„
        byte[] publicKeyEncoded = publicKey.getEncoded();
        byte[] privateKeyEncoded = privateKey.getEncoded();
        // è¿›è¡ŒBase64ç¼–ç 
        String publicKeyString = Base64.encode(publicKeyEncoded);
        String privateKeyString = Base64.encode(privateKeyEncoded);
        // ä¿å­˜æ–‡ä»¶
        FileUtils.writeStringToFile(new File(pubPath), publicKeyString, Charset.forName("UTF-8"));
        FileUtils.writeStringToFile(new File(priPath), privateKeyString, Charset.forName("UTF-8"));

    }

    /**
     * ä»æ–‡ä»¶ä¸­åŠ è½½å…¬é’¥
     *
     * @param algorithm : ç®—æ³•
     * @param filePath  : æ–‡ä»¶è·¯å¾„
     * @return : å…¬é’¥
     * @throws Exception
     */
    public static PublicKey loadPublicKeyFromFile(String algorithm, String filePath) throws Exception {
        // å°†æ–‡ä»¶å†…å®¹è½¬ä¸ºå­—ç¬¦ä¸²
        String keyString = FileUtils.readFileToString(new File(filePath), Charset.forName("UTF-8"));

        return loadPublicKeyFromString(algorithm, keyString);

    }

    /**
     * ä»å­—ç¬¦ä¸²ä¸­åŠ è½½å…¬é’¥
     *
     * @param algorithm : ç®—æ³•
     * @param keyString : å…¬é’¥å­—ç¬¦ä¸²
     * @return : å…¬é’¥
     * @throws Exception
     */
    public static PublicKey loadPublicKeyFromString(String algorithm, String keyString) throws Exception {
        // è¿›è¡ŒBase64è§£ç 
        byte[] decode = Base64.decode(keyString);
        // è·å–å¯†é’¥å·¥å‚
        KeyFactory keyFactory = KeyFactory.getInstance(algorithm);
        // æ„å»ºå¯†é’¥è§„èŒƒ
        X509EncodedKeySpec keyspec = new X509EncodedKeySpec(decode);
        // è·å–å…¬é’¥
        return keyFactory.generatePublic(keyspec);

    }

    /**
     * ä»æ–‡ä»¶ä¸­åŠ è½½ç§é’¥
     *
     * @param algorithm : ç®—æ³•
     * @param filePath  : æ–‡ä»¶è·¯å¾„
     * @return : ç§é’¥
     * @throws Exception
     */
    public static PrivateKey loadPrivateKeyFromFile(String algorithm, String filePath) throws Exception {
        // å°†æ–‡ä»¶å†…å®¹è½¬ä¸ºå­—ç¬¦ä¸²
        String keyString = FileUtils.readFileToString(new File(filePath), Charset.forName("UTF-8"));
        return loadPrivateKeyFromString(algorithm, keyString);

    }

    /**
     * ä»å­—ç¬¦ä¸²ä¸­åŠ è½½ç§é’¥
     *
     * @param algorithm : ç®—æ³•
     * @param keyString : ç§é’¥å­—ç¬¦ä¸²
     * @return : ç§é’¥
     * @throws Exception
     */
    public static PrivateKey loadPrivateKeyFromString(String algorithm, String keyString) throws Exception {
        // è¿›è¡ŒBase64è§£ç 
        byte[] decode = Base64.decode(keyString);
        // è·å–å¯†é’¥å·¥å‚
        KeyFactory keyFactory = KeyFactory.getInstance(algorithm);
        // æ„å»ºå¯†é’¥è§„èŒƒ
        PKCS8EncodedKeySpec keyspec = new PKCS8EncodedKeySpec(decode);
        // ç”Ÿæˆç§é’¥
        return keyFactory.generatePrivate(keyspec);

    }

    /**
     * ä½¿ç”¨å¯†é’¥åŠ å¯†æ•°æ®
     *
     * @param algorithm      : ç®—æ³•
     * @param input          : åŸæ–‡
     * @param key            : å¯†é’¥
     * @param maxEncryptSize : æœ€å¤§åŠ å¯†é•¿åº¦(éœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´)
     * @return : å¯†æ–‡
     * @throws Exception
     */
    public static String encrypt(String algorithm, String input, Key key, int maxEncryptSize) throws Exception {
        // è·å–Cipherå¯¹è±¡
        Cipher cipher = Cipher.getInstance(algorithm);
        // åˆå§‹åŒ–æ¨¡å¼(åŠ å¯†)å’Œå¯†é’¥
        cipher.init(Cipher.ENCRYPT_MODE, key);
        // å°†åŸæ–‡è½¬ä¸ºbyteæ•°ç»„
        byte[] data = input.getBytes();
        // æ€»æ•°æ®é•¿åº¦
        int total = data.length;
        // è¾“å‡ºæµ
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        decodeByte(maxEncryptSize, cipher, data, total, baos);
        // å¯¹å¯†æ–‡è¿›è¡ŒBase64ç¼–ç 
        return Base64.encode(baos.toByteArray());

    }

    /**
     * è§£å¯†æ•°æ®
     *
     * @param algorithm      : ç®—æ³•
     * @param encrypted      : å¯†æ–‡
     * @param key            : å¯†é’¥
     * @param maxDecryptSize : æœ€å¤§è§£å¯†é•¿åº¦(éœ€è¦æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œè°ƒæ•´)
     * @return : åŸæ–‡
     * @throws Exception
     */
    public static String decrypt(String algorithm, String encrypted, Key key, int maxDecryptSize) throws Exception {
        // è·å–Cipherå¯¹è±¡
        Cipher cipher = Cipher.getInstance(algorithm);
        // åˆå§‹åŒ–æ¨¡å¼(è§£å¯†)å’Œå¯†é’¥
        cipher.init(Cipher.DECRYPT_MODE, key);
        // ç”±äºå¯†æ–‡è¿›è¡Œäº†Base64ç¼–ç , åœ¨è¿™é‡Œéœ€è¦è¿›è¡Œè§£ç 
        byte[] data = Base64.decode(encrypted);
        // æ€»æ•°æ®é•¿åº¦
        int total = data.length;
        // è¾“å‡ºæµ
        ByteArrayOutputStream baos = new ByteArrayOutputStream();

        decodeByte(maxDecryptSize, cipher, data, total, baos);
        // è¾“å‡ºåŸæ–‡
        return baos.toString();

    }

    /**
     * åˆ†æ®µå¤„ç†æ•°æ®
     *
     * @param maxSize : æœ€å¤§å¤„ç†èƒ½åŠ›
     * @param cipher  : Cipherå¯¹è±¡
     * @param data    : è¦å¤„ç†çš„byteæ•°ç»„
     * @param total   : æ€»æ•°æ®é•¿åº¦
     * @param baos    : è¾“å‡ºæµ
     * @throws Exception
     */
    public static void decodeByte(int maxSize, Cipher cipher, byte[] data, int total, ByteArrayOutputStream baos) throws Exception {
        // åç§»é‡
        int offset = 0;
        // ç¼“å†²åŒº
        byte[] buffer;
        // å¦‚æœæ•°æ®æ²¡æœ‰å¤„ç†å®Œ, å°±ä¸€ç›´ç»§ç»­
        while (total - offset > 0) {
            // å¦‚æœå‰©ä½™çš„æ•°æ® >= æœ€å¤§å¤„ç†èƒ½åŠ›, å°±æŒ‰ç…§æœ€å¤§å¤„ç†èƒ½åŠ›æ¥åŠ å¯†æ•°æ®
            if (total - offset >= maxSize) {
                // åŠ å¯†æ•°æ®
                buffer = cipher.doFinal(data, offset, maxSize);
                // åç§»é‡å‘å³ä¾§åç§»æœ€å¤§æ•°æ®èƒ½åŠ›ä¸ª
                offset += maxSize;
            } else {
                // å¦‚æœå‰©ä½™çš„æ•°æ® < æœ€å¤§å¤„ç†èƒ½åŠ›, å°±æŒ‰ç…§å‰©ä½™çš„ä¸ªæ•°æ¥åŠ å¯†æ•°æ®
                buffer = cipher.doFinal(data, offset, total - offset);
                // åç§»é‡è®¾ç½®ä¸ºæ€»æ•°æ®é•¿åº¦, è¿™æ ·å¯ä»¥è·³å‡ºå¾ªç¯
                offset = total;
            }
            // å‘è¾“å‡ºæµå†™å…¥æ•°æ®
            baos.write(buffer);
        }
    }

}
```

```java
package com.atguigu.encryptcase.utils;

import com.sun.org.apache.xml.internal.security.utils.Base64;

import java.security.PrivateKey;
import java.security.PublicKey;
import java.security.Signature;

public class SignatureDemo {
    public static void main(String[] args) throws Exception {
         // 6999:è¡¨ç¤ºè´­ç‰©çš„ä»·æ ¼
        // 10:è¡¨ç¤ºè´­ç‰©çš„æ•°é‡
        String a = "6999" + "10";

        PublicKey publicKey = RsaDemo.loadPublicKeyFromFile("RSA", "a.pub");
        PrivateKey privateKey = RsaDemo.loadPrivateKeyFromFile("RSA", "a.pri");

        String signaturedData = getSignature(a, "sha256withrsa", privateKey);

        System.out.println(signaturedData);

    }

    /**
     * ç”Ÿæˆç­¾å
     *
     * @param input      : åŸæ–‡
     * @param algorithm  : ç®—æ³•
     * @param privateKey : ç§é’¥
     * @return : ç­¾å
     * @throws Exception
     */
    public static String getSignature(String input, String algorithm, PrivateKey privateKey) throws Exception {
        // è·å–ç­¾åå¯¹è±¡
        Signature signature = Signature.getInstance(algorithm);
        // åˆå§‹åŒ–ç­¾å
        signature.initSign(privateKey);
        // ä¼ å…¥åŸæ–‡
        signature.update(input.getBytes());
        // å¼€å§‹ç­¾å
        byte[] sign = signature.sign();
        // å¯¹ç­¾åæ•°æ®è¿›è¡ŒBase64ç¼–ç 
        return Base64.encode(sign);
    }

    /**
     * æ ¡éªŒç­¾å
     *
     * @param input          : åŸæ–‡
     * @param algorithm      : ç®—æ³•
     * @param publicKey      : å…¬é’¥
     * @param signaturedData : ç­¾å
     * @return : æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹
     * @throws Exception
     */
    public static boolean verifySignature(String input, String algorithm, PublicKey publicKey, String signaturedData) throws Exception {
        // è·å–ç­¾åå¯¹è±¡
        Signature signature = Signature.getInstance(algorithm);
        // åˆå§‹åŒ–ç­¾å
        signature.initVerify(publicKey);
        // ä¼ å…¥åŸæ–‡
        signature.update(input.getBytes());
        // æ ¡éªŒæ•°æ®
        return signature.verify(Base64.decode(signaturedData));

    }

}
```

è¿è¡ŒÂ `RsaDemo.java`Â ç”Ÿæˆ å…¬é’¥å’Œç§é’¥

![](./images/å¯†ç å­¦/2957590-20230131080030525-1856531351.jpg)

è¿è¡ŒÂ `SignatureDemo.java`Â ç”Ÿæˆ ç­¾åä¿¡æ¯

```
VYC512IQvgb+2jkIkb/tAkRpcG6XOELYx0q/KB7VCupOCUo4qn12VfJhJPqXIV24PT8Y2/WWUUxu
rMDx8xZXtUwSlV4uxPwuKuf/PZk3KyGB91qzoSi2icEIXUiZe2rFd2ZCNbcSvSlZnLuvWvc9/VGE
iMkYmRtwA8wgK2Geg+M=
```

åœ¨Â `UserController.java`Â æ·»åŠ å¦‚ä¸‹æ–¹æ³•

```java
@ApiOperation(value = "è´­ç‰©")
    @RequestMapping(value = "/buy", method = RequestMethod.GET)
    public String buy(String price, String num, String signature) {
        try {
            // è·å–å…¬é’¥
            PublicKey publicKey = RsaDemo.loadPublicKeyFromFile("RSA", "a.pub");
            // ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåŸæ–‡
            // ç¬¬äºŒä¸ªå‚æ•°ï¼šç®—æ³•
            // ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šå…¬é’¥
            // ç¬¬å››ä¸ªå‚æ•°ï¼šç­¾å
            boolean result = SignatureDemo.verifySignature(price + num, "SHA256withRSA", publicKey, signature);

            if (result) {
                return "è´­ç‰©æˆåŠŸ";
            }
        } catch (Exception e) {
            e.printStackTrace();
        }

        return "è´­ç‰©å¤±è´¥";
    }
```

è¿è¡Œç¨‹åºÂ `http://localhost:8080/swagger-ui.html`

![](./images/å¯†ç å­¦/2957590-20230131080030764-877864683.jpg)

![](./images/å¯†ç å­¦/2957590-20230131080030724-299171135.jpg)

å¦‚æœåœ¨è¯·æ±‚æœåŠ¡å™¨çš„æ—¶å€™ï¼Œç¨‹åºè¢«äººç¯¡æ”¹ï¼ŒæŠŠä»·æ ¼æ”¹æˆ 6 å…ƒï¼Œè¿è¡Œå°±ä¼šè´­ç‰©å¤±è´¥

![](./images/å¯†ç å­¦/2957590-20230131080030640-594437550.jpg)

![](./images/å¯†ç å­¦/2957590-20230131080030672-1436421976.jpg)